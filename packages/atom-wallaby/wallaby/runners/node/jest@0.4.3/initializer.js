/*
 * Wallaby.js - v1.0.279
 * http://wallabyjs.com
 * Copyright (c) 2014-2016 Wallaby.js - All Rights Reserved.
 *
 * This source code file is a part of Wallaby.js and is a proprietary (closed source) software.

 * IMPORTANT:
 * Wallaby.js is a tool made by software developers for software developers with passion and love for what we do.
 * Pirating the tool is not only illegal and just morally wrong,
 * it is also unfair to other fellow programmers who are using it legally,
 * and very harmful for the tool and its future.
 */
var path=require("path"),fs=require("graceful-fs"),TestRunner,utils,transform,installCommonGlobals,tracer=global.$_$tracer,testRunner,testFiles,mergeSetupScript=!1,jestInstalled=!1,EVAL_RESULT_VARIABLE="Object.<anonymous>",transformPath="jest-cli/src/lib/transform",installCommonGlobalsPath="jest-cli/src/environments/installCommonGlobals",frozenConfig=!1,compactScriptPreprocessor=!1,jasmineFrameworkVersion;try{!global.wallaby._localNodeModules||process.env.NODE_PATH&&~process.env.NODE_PATH.indexOf(global.wallaby._localNodeModules)||(process.env.NODE_PATH=(process.env.NODE_PATH?process.env.NODE_PATH+path.delimiter:"")+global.wallaby._localNodeModules);try{TestRunner=require("jest-cli/src/TestRunner")}catch(et){TestRunner=require("jest-cli/build/TestRunner")}try{utils=require("jest-cli/src/lib/utils")}catch(e){try{utils={normalizeConfig:require("jest-cli/src/config/normalize")}}catch(en){utils={normalizeConfig:require("jest-config/build/normalize")}}}var initCommonGlobalsInstall=function(e){try{return installCommonGlobalsPath=e,installCommonGlobals=require(installCommonGlobalsPath),!0}catch(t){return!1}};compactScriptPreprocessor=frozenConfig=!TestRunner.prototype._loadConfigDependencies,initCommonGlobalsInstall(installCommonGlobalsPath)||initCommonGlobalsInstall("jest-util/lib/installCommonGlobals")||initCommonGlobalsInstall("jest-cli/node_modules/jest-util/lib/installCommonGlobals")||initCommonGlobalsInstall("jest-util/src/installCommonGlobals")||initCommonGlobalsInstall("jest-cli/node_modules/jest-util/src/installCommonGlobals")||initCommonGlobalsInstall("jest-util/build/installCommonGlobals")||initCommonGlobalsInstall("jest-cli/node_modules/jest-util/build/installCommonGlobals");try{transform=require(transformPath)}catch(e){}jestInstalled=!0}catch(e){tracer.start(function(){tracer.reportGlobalError("jest-cli node module is not found or the version is not supported, missing `npm install jest-cli --save-dev`?")}),module.exports={init:function(){return{configure:function(){}}}}}var jasmineVersion=function(e){return e&&~e.testRunner.indexOf("jasmine2")?2:1},sameSession=function(e){return frozenConfig?e.globals._wallabySession===global.$_$session:e._session===global.$_$session},setSession=function(e){frozenConfig?e.globals._wallabySession=global.$_$session:e._session=global.$_$session},JasmineReporter=function(e){var t=e.initialSpecId();this.reportRunnerStarting=function(){},this.reportRunnerResults=function(){global.$_$initialSpecId=t+1},this.reportSpecStarting=function(i){i.id=++t,e.specStart(i.id,i.description),i.results_.time=(new e._Date).getTime()},this.reportSpecResults=function(t){for(var i=e.specEnd(),n={id:t.id,timeRange:i,name:t.description,suite:[],success:0===t.results_.failedCount,skipped:t.results_.skipped,time:t.results_.skipped?0:(new e._Date).getTime()-t.results_.time,log:[]},s=t.suite;s;)n.suite.unshift(s.description),s=s.parentSuite;if(!n.success&&!n.skipped)for(var r=t.results_.items_,a=0;a<r.length;a++){var o=r[a];o.passed_||(o.showDiff=o.showDiff||"toEqual"===o.matcherName,n.log.push(e.setAssertionData(o,{message:o.message,stack:o.trace&&o.trace.stack?o.trace.stack:e._undefined})))}n.log.length||delete n.log,e.result(n)},this.specFilter=function(t){if(!e.hasSpecFilter())return!0;for(var i=[t.description],n=t.suite;n;)i.unshift(n.description),n=n.parentSuite;return e.specFilter(i)}},Jasmine2Reporter=function(e){var t=e.initialSpecId(),i=[];this.jasmineDone=function(){global.$_$initialSpecId=t+1},this.suiteStarted=function(e){i.push(e.description)},this.suiteDone=function(){i.pop()},this.specStarted=function(i){i.id=++t,e.specStart(i.id),i._time=(new e._Date).getTime()},this.specDone=function(t){var n=e.specEnd(),s="disabled"===t.status||"pending"===t.status,r={id:t.id,timeRange:n,name:t.description,suite:i.slice(),success:"passed"===t.status,skipped:s,time:s?0:(new e._Date).getTime()-t._time,log:[]};if(!r.success&&!r.skipped)for(var a=t.failedExpectations,o=0;o<a.length;o++){var l=a[o];l.showDiff=l.showDiff||"toEqual"===l.matcherName,r.log.push(e.setAssertionData(l,{message:l.message,stack:l.stack}))}r.log.length||delete r.log,e.result(r)}};if(jestInstalled){var jasmineInitializerPath={1:path.join(__dirname,"jasmineInitializer.js"),2:path.join(__dirname,"jasmine2Initializer.js")},jasmineInitializerCode={1:"\n"+fs.readFileSync(jasmineInitializerPath[1]),2:"\n"+fs.readFileSync(jasmineInitializerPath[2])};if(utils.runContentWithLocalBindings=function(e,t,i,n){var s=+new Date;if(global.$_$tracer&&global.$_$tracer.isInitialized()){var r=Object.keys(n);e.global&&e.runSourceText('this["'+EVAL_RESULT_VARIABLE+'"] = function ('+r.join(",")+") {"+t+"\n};",i);var a=e.global?e.global[EVAL_RESULT_VARIABLE]:e("(function("+r.join(",")+"){"+t+"\n})",i);e.global&&delete e.global[EVAL_RESULT_VARIABLE];var o=r.map(function(e){return n[e]});a.apply(null,o);var l=+new Date;tracer.debugLog("Loaded "+(global.wallaby?i.replace(global.wallaby.localProjectDir,"").replace(global.wallaby.projectCacheDir,""):i)+" in "+(l-s)+" milliseconds")}},utils.readAndPreprocessFileContent=function(e,t){if(!sameSession(t))return"";var i=fs.readFileSync(e,"utf8");if("#!"===i.substr(0,2)&&(i=i.replace(/^#!.*/,"")),t.scriptPreprocessor&&!t.preprocessorIgnorePatterns.some(function(t){return t?(t.test||(t=new RegExp(t)),t.test(e)):void 0}))try{i=compactScriptPreprocessor?require(t.scriptPreprocessor).process(i,e,t):require(t.scriptPreprocessor).process(i,e,{},[],t)}catch(n){throw n.message=t.scriptPreprocessor+": "+n.message,n}return mergeSetupScript&&t.setupTestFrameworkScriptFile===e&&(i+=mergeSetupScript),i},transform&&(require.cache[require.resolve(transformPath)].exports=utils.readAndPreprocessFileContent),installCommonGlobals){var originalInstallCommonGlobals=require.cache[require.resolve(installCommonGlobalsPath)].exports,newInstallCommonGlobals=require.cache[require.resolve(installCommonGlobalsPath)].exports=function(e,t){e.$_$wp=global.$_$wp,e.$_$wpe=global.$_$wpe,e.$_$w=global.$_$w,e.$_$wf=global.$_$wf,e.$_$tracer=global.$_$tracer,e.$_$tracer._jasmineAdapter=1===jasmineFrameworkVersion?new JasmineReporter(global.$_$tracer):new Jasmine2Reporter(global.$_$tracer),originalInstallCommonGlobals(e,t)};try{require("jest-util").installCommonGlobals=newInstallCommonGlobals}catch(e){}}TestRunner.prototype._loadConfigDependencies=function(){var e=this._config;if(null===this._configDeps){this._configDeps={ModuleLoader:require(e.moduleLoader),testRunner:require(e.testRunner).bind(null)};var t=require(e.testEnvironment);this._configDeps.testEnvironment=function(e){var i=new t(e);return i.global.$_$wp=global.$_$wp,i.global.$_$wpe=global.$_$wpe,i.global.$_$w=global.$_$w,i.global.$_$wf=global.$_$wf,i.global.$_$tracer=global.$_$tracer,i.global.$_$tracer._jasmineAdapter=1===jasmineFrameworkVersion?new JasmineReporter(global.$_$tracer):new Jasmine2Reporter(global.$_$tracer),i}}return this._configDeps},tracer.start(function(){testRunner||configure();var e=!1,t=testRunner._config,i=function(){!e&&sameSession(t)&&(e=!0,tracer.complete())},n={onRunStart:function(){tracer.started({total:"unknown number of"})},onTestResult:function(e,t){t.testExecError&&sameSession(e)&&(tracer.reportGlobalError(t.testExecError.stack||t.testExecError.message||""),i())},onRunComplete:function(){i()}};setSession(t),testRunner.runTests(testFiles,n).then(function(){i()},function(){i()})});var configure=function(e){e=e||{},delete e.scriptPreprocessor,delete e.testPathDirs,delete e.testFileExtensions,delete e.testDirectoryName,delete e.testPathIgnorePatterns,e.collectCoverage=!1,e.rootDir=process.cwd(),e.name=e.rootDir.replace(/[\/\\]|\s/g,"-"),e=utils.normalizeConfig(e),jasmineFrameworkVersion=jasmineVersion(e),e.setupTestFrameworkScriptFile?mergeSetupScript=jasmineInitializerCode[jasmineFrameworkVersion]:e.setupTestFrameworkScriptFile=jasmineInitializerPath[jasmineFrameworkVersion];var t;try{t=require("jest-runtime").buildHasteMap||require("jest-runtime").createHasteContext}catch(i){}testRunner=3===TestRunner.length?new TestRunner(t(e,{maxWorkers:1}),e,{runInBand:!0,maxWorkers:1}):new TestRunner(e,{runInBand:!0,maxWorkers:1})};module.exports={init:function(e){return testFiles=e,{configure:function(e){configure(e)}}}}}