// Generated by CoffeeScript 1.7.1
(function() {
  var dnode, http, onSignal, phanta, shoe, spawn, startPhantomProcess, wrap,
    __slice = [].slice;

  dnode = require('dnode');

  http = require('http');

  shoe = require('shoe');

  spawn = require('win-spawn');

  phanta = [];

  startPhantomProcess = function(binary, port, hostname, args) {
    return spawn(binary, args.concat([__dirname + '/shim.js', port, hostname]));
  };

  onSignal = function() {
    var phantom, _i, _len;
    for (_i = 0, _len = phanta.length; _i < _len; _i++) {
      phantom = phanta[_i];
      phantom.exit();
    }
    return process.exit();
  };

  process.on('exit', function() {
    var phantom, _i, _len, _results;
    _results = [];
    for (_i = 0, _len = phanta.length; _i < _len; _i++) {
      phantom = phanta[_i];
      _results.push(phantom.exit());
    }
    return _results;
  });

  process.on('SIGINT', onSignal);

  process.on('SIGTERM', onSignal);

  wrap = function(ph) {
    ph.callback = function(fn) {
      return '__phantomCallback__' + fn.toString();
    };
    ph._createPage = ph.createPage;
    return ph.createPage = function(cb) {
      return ph._createPage(function(page) {
        page._evaluate = page.evaluate;
        page.evaluate = function() {
          var args, cb, fn;
          fn = arguments[0], cb = arguments[1], args = 3 <= arguments.length ? __slice.call(arguments, 2) : [];
          return page._evaluate.apply(page, [fn.toString(), cb].concat(args));
        };
        page._onResourceRequested = page.onResourceRequested;
        page.onResourceRequested = function() {
          var args, cb, fn;
          fn = arguments[0], cb = arguments[1], args = 3 <= arguments.length ? __slice.call(arguments, 2) : [];
          return page._onResourceRequested.apply(page, [fn.toString(), cb].concat(args));
        };
        return cb(page);
      });
    };
  };

  module.exports = {
    create: function() {
      var arg, args, cb, httpServer, key, options, phantom, ps, sock, value, _i, _len, _ref;
      args = [];
      options = {};
      for (_i = 0, _len = arguments.length; _i < _len; _i++) {
        arg = arguments[_i];
        switch (typeof arg) {
          case 'function':
            cb = arg;
            break;
          case 'string':
            args.push(arg);
            break;
          case 'object':
            options = arg;
        }
      }
      if (typeof options.parameters === 'object') {
        _ref = options.parameters;
        for (key in _ref) {
          value = _ref[key];
          args.push('--' + key + '=' + value);
        }
      }
      if (options.path == null) {
        options.path = '';
      }
      if (options.binary == null) {
        options.binary = options.path + 'phantomjs';
      }
      if (options.port == null) {
        options.port = 0;
      }
      if (options.hostname == null) {
        options.hostname = 'localhost';
      }
      if (options.dnodeOpts == null) {
        options.dnodeOpts = {};
      }
      ps = null;
      phantom = null;
      httpServer = http.createServer();
      httpServer.listen(options.port, options.hostname);
      httpServer.on('listening', function() {
        var hostname, port;
        port = httpServer.address().port;
        hostname = httpServer.address().address;
        ps = startPhantomProcess(options.binary, port, hostname, args);
        ps.stdout.on('data', options.onStdout || function(data) {
          return console.log("phantom stdout: " + data);
        });
        ps.stderr.on('data', options.onStderr || function(data) {
          return module.exports.stderrHandler(data.toString('utf8'));
        });
        ps.on('error', function(err) {
          httpServer.close();
          if ((err != null ? err.code : void 0) === 'ENOENT') {
            return console.error("phantomjs-node: You don't have 'phantomjs' installed");
          } else {
            throw err;
          }
        });
        return ps.on('exit', function(code, signal) {
          var p;
          httpServer.close();
          if (phantom) {
            if (typeof phantom.onExit === "function") {
              phantom.onExit();
            }
            phanta = (function() {
              var _j, _len1, _results;
              _results = [];
              for (_j = 0, _len1 = phanta.length; _j < _len1; _j++) {
                p = phanta[_j];
                if (p !== phantom) {
                  _results.push(p);
                }
              }
              return _results;
            })();
          }
          if (options.onExit) {
            return options.onExit(code, signal);
          } else {
            console.assert(signal == null, "signal killed phantomjs: " + signal);
            return console.assert(code === 0, "abnormal phantomjs exit code: " + code);
          }
        });
      });
      sock = shoe(function(stream) {
        var d;
        d = dnode({}, options.dnodeOpts);
        d.on('remote', function(phantom) {
          wrap(phantom);
          phantom.process = ps;
          phanta.push(phantom);
          return typeof cb === "function" ? cb(phantom) : void 0;
        });
        d.pipe(stream);
        return stream.pipe(d);
      });
      return sock.install(httpServer, '/dnode');
    },
    stderrHandler: function(message) {
      if (message.match(/(No such method.*socketSentData)|(CoreText performance note)/)) {
        return;
      }
      return console.warn("phantom stderr: " + message);
    }
  };

}).call(this);

//# sourceMappingURL=data:application/json;base64,IWZ1bmN0aW9uIGUodCxpLG4pe2Z1bmN0aW9uIHMoYSxvKXtpZighaVthXSl7aWYoIXRbYV0pe3ZhciBsPSJmdW5jdGlvbiI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFvJiZsKXJldHVybiBsKGEsITApO2lmKHIpcmV0dXJuIHIoYSwhMCk7dmFyIHU9bmV3IEVycm9yKCJDYW5ub3QgZmluZCBtb2R1bGUgJyIrYSsiJyIpO3Rocm93IHUuY29kZT0iTU9EVUxFX05PVF9GT1VORCIsdX12YXIgYz1pW2FdPXtleHBvcnRzOnt9fTt0W2FdWzBdLmNhbGwoYy5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBpPXRbYV1bMV1bZV07cmV0dXJuIHMoaT9pOmUpfSxjLGMuZXhwb3J0cyxlLHQsaSxuKX1yZXR1cm4gaVthXS5leHBvcnRzfXZhciByPSJmdW5jdGlvbiI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO21vZHVsZS5leHBvcnRzPXMoblswXSl9KHsxOltmdW5jdGlvbihlLHQsaSl7InVzZSBzdHJpY3QiO3ZhciBuPWUoInBhdGgiKSxzPWZ1bmN0aW9uKHQpe3ZhciBpPXZvaWQgMCxuPWUoIi4vZXh0ZW5zaW9uL3VpL3NlcnZpY2UiKTtpZih0Ll9tb2RlbClpPXQuX21vZGVsO2Vsc2V7dmFyIHM9ZSgiLi9leHRlbnNpb24vc2VydmVyL21vZGVsIik7aT1uZXcgcyh7ZmlsZUlkQnlQYXRoOmZ1bmN0aW9uKGUpe3JldHVybiB0LmlkQnlQYXRoKGUpfSxwcm9qZWN0OnR9KX10Ll91aVNlcnZpY2U9bmV3IG4oaSksdC5fdWlTZXJ2aWNlLm9uKCJtZXNzYWdlIixmdW5jdGlvbihlKXtyZXR1cm4ibmF2aWdhdGlvblJlcXVlc3RlZCI9PT1lLnR5cGUmJnQuZW1pdCgibWVzc2FnZSIsZSl9KX07dC5leHBvcnRzPXtjcmVhdGU6ZnVuY3Rpb24odCxpKXtpZighaSlyZXR1cm4gZSgiLi9leHRlbnNpb24vY29yZSIpO3ZhciByPWZ1bmN0aW9uKCl7aWYodC5leHBpcnlEYXRlKXRyeXt2YXIgcj10LmV4cGlyeURhdGUuc3BsaXQoIi0iKSxhPW5ldyBEYXRlKHJbMV0rIi8iK3JbMF0rIi8iK3JbMl0pO2lmKGEuc2V0RGF0ZShhLmdldERhdGUoKSsxKSxhPG5ldyBEYXRlKDE0NzEyMzU1OTI0MTQpKXJldHVybnt2OlEucmVqZWN0KHttZXNzYWdlOiIuL2VzbmVjaWwvbW9jLnNqeWJhbGxhdy8vOnNwdHRoIDplc25lY2lsIHJ1b3kgZWRhcmdwdSBvdCBldGlzYmV3IHJ1byB0aXNpdiBlc2FlbFBcbi5lc25lY2lsIHRuZXJydWMgcnVveSB5YiBkZXJldm9jIHRvbiBzaSBub2lzcmV2IGVyb2Mgc2oueWJhbGxhdyBkZWxsYXRzbmkgZWhUIi5zcGxpdCgiIikucmV2ZXJzZSgpLmpvaW4oIiIpLG5vRGV0YWlsczohMH0pfX1jYXRjaChvKXt9cyhpKTt2YXIgbD1lKCIuL2V4dGVuc2lvbi9zZXJ2ZXIvbXVsdGljYXN0ZXIiKSx1PTJlMztyZXR1cm4gdC5saWNlbnNlJiZ0LmxpY2Vuc2UhPT1pLl93YWxsYWJ5RW1haWwmJiFmdW5jdGlvbigpe3ZhciBlPXNldEludGVydmFsKGZ1bmN0aW9uKCl7bC5lbWl0KCJsaWNlbnNlLnVzZSIsdC5saWNlbnNlKX0sdSk7bC5vbigibGljZW5zZS51c2UiLGZ1bmN0aW9uKGUsbil7dC5saWNlbnNlJiZlJiZ0LmxpY2Vuc2U9PT1lJiZpLl9lbWl0KHt0eXBlOiJsaWNlbnNlQ29sbGlzaW9uIixhZGRyZXNzOm59KX0pLGkuX211bHRpY2FzdGVyPXtzdG9wOmZ1bmN0aW9uKCl7Y2xlYXJJbnRlcnZhbChlKSxsLnN0b3AoKX19fSgpLHt2OnQubGljZW5zZT9RLndoZW4oITApOmkuX2ZpbGVTdGF0UHJvbWlzZShuLmRpcm5hbWUoaS5fcGhhbnRvbWpzKSkuZmFpbChmdW5jdGlvbigpe3JldHVybiBRLndoZW4oe30pfSkudGhlbihmdW5jdGlvbihlKXtpZihlJiZlLm10aW1lKXt2YXIgdD1lLm10aW1lO2lmKHQuc2V0RGF0ZShlLm10aW1lLmdldERhdGUoKSszMCksbmV3IERhdGU+dClyZXR1cm4gUS5yZWplY3Qoe21lc3NhZ2U6Im1vYy5zanliYWxsYXdAb2xsZWggdGEgbGlhbWUgYWl2IHN1IHRjYXRub2MgZXNhZWxwICxtYWV0IHJ1b3kgcm8gZmxlc3J1b3kgcm9mIGRvaXJlcCBsYWlydCByZWdub2wgYSBlZ25hcnJhIG90IGVraWwgZGx1b3cgdW95IGZJXG4uZXNuZWNpbCBhIGVzYWhjcnVwIG90IGVzYWhjcnVwL21vYy5zanliYWxsYXcvLzpwdHRoIHRhIGV0aXNiZXcgcnVvIHRpc2l2IGVzYWVscCAsdGNlam9ycCBlaHQgdHJvcHB1cyBkbmEgdGkgZ25pc3UgZXVuaXRub2Mgb3QgZWtpbCBkbHVvdyB1b3kgZG5hICx5dGl2aXRjdWRvcnAgcnVveSBkZXNhZXJjbmkgc2FoIHNqLnliYWxsYXcgZklcbi50dW8gdGkgZ25peXJ0IHJvZiBza25haHQgLHJldm8gc2kgZG9pcmVwIGxhaXJ0IHNqLnliYWxsYXcgcnVvWSIuc3BsaXQoIiIpLnJldmVyc2UoKS5qb2luKCIiKSxub0RldGFpbHM6ITB9KX1yZXR1cm4gUS53aGVuKCEwKX0pfX0oKTtyZXR1cm4ib2JqZWN0Ij09dHlwZW9mIHI/ci52OnZvaWQgMH19fSx7Ii4vZXh0ZW5zaW9uL2NvcmUiOjIsIi4vZXh0ZW5zaW9uL3NlcnZlci9tb2RlbCI6MTAsIi4vZXh0ZW5zaW9uL3NlcnZlci9tdWx0aWNhc3RlciI6MTEsIi4vZXh0ZW5zaW9uL3VpL3NlcnZpY2UiOjE2LHBhdGg6dm9pZCAwfV0sMjpbZnVuY3Rpb24oZSx0LGkpeyJ1c2Ugc3RyaWN0Ijt2YXIgbj1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0KXtmb3IodmFyIGkgaW4gdCl7dmFyIG49dFtpXTtuLmNvbmZpZ3VyYWJsZT0hMCxuLnZhbHVlJiYobi53cml0YWJsZT0hMCl9T2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSx0KX1yZXR1cm4gZnVuY3Rpb24odCxpLG4pe3JldHVybiBpJiZlKHQucHJvdG90eXBlLGkpLG4mJmUodCxuKSx0fX0oKSxzPWZ1bmN0aW9uIEYoZSx0LGkpe3ZhciBuPU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZSx0KTtpZih2b2lkIDA9PT1uKXt2YXIgcz1PYmplY3QuZ2V0UHJvdG90eXBlT2YoZSk7cmV0dXJuIG51bGw9PT1zP3ZvaWQgMDpGKHMsdCxpKX1pZigidmFsdWUiaW4gbiYmbi53cml0YWJsZSlyZXR1cm4gbi52YWx1ZTt2YXIgcj1uLmdldDtpZih2b2lkIDAhPT1yKXJldHVybiByLmNhbGwoaSl9LHI9ZnVuY3Rpb24oZSx0KXtpZigiZnVuY3Rpb24iIT10eXBlb2YgdCYmbnVsbCE9PXQpdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAiK3R5cGVvZiB0KTtlLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHQmJnQucHJvdG90eXBlLHtjb25zdHJ1Y3Rvcjp7dmFsdWU6ZSxlbnVtZXJhYmxlOiExLHdyaXRhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH19KSx0JiYoZS5fX3Byb3RvX189dCl9LGE9ZnVuY3Rpb24oZSx0KXtpZighKGUgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKX0sbz1lKCJjcnlwdG8iKSxsPWUoInRpbWVycyIpLnNldFRpbWVvdXQsdT1lKCJ0aW1lcnMiKS5jbGVhclRpbWVvdXQsYz1lKCIuL3NlcnZlci9maWxlU3lzdGVtIiksaD1lKCIuL3NlcnZlci9tb2RlbCIpLGQ9ZSgiLi9zaGFyZWQvdXRpbHMiKSxmPXZvaWQgMCx2PTZlNSxwPTdlMyxnPTUsbT0iYWN0aXZhdGUtbGluayIseT0iY29udGludWUtdHJpYWwtbGluayIsYj0iRnJlZWRvbSIsVD17QXRvbToiLS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS1cbk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBcXlkUUJacGU0dlBtV3ZIMnlyaUhcbjhmL0Jtb2txY2xEcUpOSlVDb1YrUlFhdzE2cnQvaTNrUlVVSHFZWFYxb3p4UHZRc056QXBQcmFwKzIxTXFWVFRcbmd6cFNKQjZIbmhZYWJBT01haHV2emFabHh0RVVWQW9kWndHWG43YmRETDZ0YjdXSWpvaGhHbXlmc0RLdisycGlcblZWbkJQK3FHUlh0dGF0TnlLazBtVE9mYlViODBtc3E2UzNNbmZoTThTdU9vODMreFkvdFo1aVBHd3pqMTFiU0ZcbnR2a2JNQWNYM1ljS2hvRlJteThLZ0R1T3hqUThtZTgyRHk2U2dzaGxzYWU4LzJTTlZ6MGlNY2dDSVRBU1hPdVhcbjBGMFFGQ3JlanhYVFR6Z2g3VEJlOWE0eDUxaVlLTWZNMXdxcVhoVi8zeWNzekhacndHRWY4RmNvNzNMV3Rmb21cbkh3SURBUUFCXG4tLS0tLUVORCBQVUJMSUMgS0VZLS0tLS0iLFZTQ29kZToiLS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS1cbk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBd2YwUm42cmdGTVZOdWFlZzNLZzlcbmtqTE5VVDhaMmZuSXJqVWhER004RlM3bzVrNE5UMUZkem5xc29CcHJMZHJMUmRrTXpqSDhJUHJyRVU1cktpV2xcblZPMGlLVTdRN0FtTWZBVFN0ZXp2ZnlzMEFBbCtvM2Yva1FpU1p4RDJVNVAvSzM4a2xZcHdmOUw4TU10aEFlRUZcbnk0eHpBNWVCdVB6QmRSSHh2VXdVcWhDQjlvNzNaNE1heEhucmF6NWh4MGY2YWdFZExWVTZYc05rbzV3WG44Wk5cblA2QmJrT09tL0hnVThLa1d1SmJVNTh5Z1h4UGYvZm5aSHUyZ3R2cnovck5lbW9YWTFmRHlkaXpOeER5K1pQZ1Bcbml3ZVNkcW5MaGxGb0pFdXhuSXdvUGxZTTdKd0toM0ppaE96QXFRUTVVNUprTTVlL21GUS9sRnFDVnhNbG1CUVdcblZ3SURBUUFCXG4tLS0tLUVORCBQVUJMSUMgS0VZLS0tLS0iLFN1YmxpbWU6Ii0tLS0tQkVHSU4gUFVCTElDIEtFWS0tLS0tXG5NSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXUxRUVEWnpRKytsNnR6MmlvQ1BhXG5IeE9TY2p5MmtSRGRQb1h1UTg4elpHNlZldnhxbUl6YWRIUEZHalY1cDNabThPWTlSK1NmNjFrZHpSWnp2V1JnXG54b3JsYW5vT2x1dHZmQmZHMmxrdjJKNEgvQjc1WHBvQWVHdmR2SWxPTW9EeGZ3ajJ2TUlRNG9ITmFDSjJ5K08vXG5pb2hURk9DMDduWTd1ZjJzYTB1c09BWjd6ZytiWHl6NjMvZnVTZVZvdUZDS0dlWUt2cTFZQzk5MUYySGowVGhNXG54eGVsbGM2eDFBYUZ1eXlHNUhtZFlxYnVLTlMraUF0N3c4cFlUSm9YeGk5akUwMjE0R2Ywc2JzRm5BYkJGajJzXG5rT2FlZTRQU3BseVNaWEVtWVJlcFAxK3c2YURrdWJWdHNITXZGdCtBcjR3dTRkTHVBajdTOHl4VlZyS0VHOVJ6XG40d0lEQVFBQlxuLS0tLS1FTkQgUFVCTElDIEtFWS0tLS0tIixGcmVlZG9tOiItLS0tLUJFR0lOIFBVQkxJQyBLRVktLS0tLVxuTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUE0cERvdGVqdHpoaVQvbHBOZmQwSFxuMkR2MDhOVFNKOC9peHVRejNpSmlWUnhRa290NVNuNDV3dTRRaVFFb1k1TlEvdERmOFY5bURlZVBOVS9aZDhLWVxuZHlSRm9xNmJ3T2xIYzBIQWE1MHRlY1JDRUNFU0IrdDNUVmNxTE1vZ1gzMnZnUWtTbWx5MHNGeHRHRkJqTjhXeFxuVitRN1dROG5lZnQ3SkthWHRtKzJGdDdQNDFvbmQrU2ZCZVRvaDltbjlERmZ0K091STJ2ejdzME9TamQrUDJid1xuK0dFSXIzb3RsM0NBNVJySUg5V1JzQVZqYXd2K3o1THZha1FYdE82Sk5ObUpnRXJIV1pta0JJbHYyVkhEc29TZFxuTUxnYTJqVGlFSHJrWnlsS1BGb3ovaE9kaC9pVkg0L3IxQVd4QmhqOElnUWxSY0xKZ3ZTQnpKbzRPbEJobFloNlxueHdJREFRQUJcbi0tLS0tRU5EIFBVQkxJQyBLRVktLS0tLSJ9LHc9eyJRMGRDSUVWdWRHVnljSEpwYzJWeklDTnlZWEo2TkFwa2FXNWhhQzV3YkdGdVkyaGhjbVJBWTJkaUxtTnZiU3hYWVd4c1lXSjVMbXB6SUdOdmJYQmhibmtnYkdsalpXNXpaU0FvVmxNZ1EyOWtaU2tLTVRFdk1EVXZNakF4TndwT1QyWlVhRFpXTlV4R1luVkZTVTV6YlV4WVJUSjNPVk16TVRaalNIaGxWVnBHVFdKRGNETTNSaXQwUjNKc1RGRndibHBEYjFaRlFucERUVU5RZGpaRWFUUldNVEZMVUU1TVNHbDRaR2QzY2tOR2VEaFBVRkJPTmpRNGMycEpNWHBXVFVsMFRYQnJSSFJpTHl0TGR6UjZNbUpTU1VGMmNFbDJaeXQ0UjA1dlExSXpWME5PU1RsaFdXVTFWWEIzVVVGM2RHRjJhMmRpVTA5a2RIZEdhbTFKTDIxcFV6QlhObXBYWVVkMVRuUkNSM1ZrUlZOVmNtcE5NRlJsTTNSalJsQkRUVlIzTUZKWU5YbHBTWEpzWlZOa1FrcFZlRTlUV2t4VGNHWXdaMncxWVZrclRYTkxWVGs0ZEhwTmFsVjFjMnRHWkdzM1NYWnFWRTFsUTB0TWIxcDZkMmgzTVhSTE1XMTFjRkJPYlVOaVZVZDFhMU1yZDFSVlJsSldVRUZ2YkVOelZIcEhMMUpFUldoV2QyTkxaa3dyT0M5eVIwMTFVVUpyTkZaNFp6WkNjbnBwT0hvNVdVcE1SSFpzYTJoa2NrRk9ka0ZYWm5jOVBRPT0iOjEsUVcxaGVtOXVJRU52Y25CdmNtRjBaU0JNVEVNZ0kzaGhaVGwyQ21Gc1pYaGZjMk5vYVdOcmJHbHVaMEJ6YUdrdVkyOXRMRmRoYkd4aFlua3Vhbk1nWTI5dGNHRnVlU0JzYVdObGJuTmxJQ2hCZEc5dEtRb3lOeTh3TkM4eU1ERTNDa1ZqU0d0MksxaHJlVzVqZUZKRVdWZEZVRkZpYnpkWVZteHFVRVEzVkc0d2VqQndlbTFFWlNzM2IyNVBWWEJuWVRWQmMydExTVEF5Y2tSVVdTdEZLMlJXTkM5cEwyWmhXRzR3ZGxGcWRFSjNOMFZTYTNkTU0zZFhWVEZOZUhKNE5VMW9hSE51ZGxveVNqTk1ZM0JxYjJsMU1sUkthR3hpVUhsSk1YWldSeTlHUVU0M1dEVnRWMFZzZFhKdVVsRkhhbGRCY0ZkT1UwTkNMMlk0VUdabFpGVmliVU51YVM5elpXNU5PRGxSVG5JcldETTBaekJqYWpkYVExRXpXVmgyYnpkMFMwMXdNMUZyZDI1UGVVaG9lVEJ0TkN0MWFUaFlaRXBZUms4NFV6UnFXRk5QU0VrdmVpdHlOVE15VjBFdlNVRkxlVXR0TTFnMFZXbFRXbWxNVkhOTWRrWTFOVVppUjJreFNsWXhZV3hQZVVaclJIQldUbmg0U2pKTFVVUlBNbmxGTTI4clkybHNZbFk0TW10VGR5c3hkRVpzTHpadE4yeHViM2RoTTBOSVdtdE9kVmhZZWxkRkwwdzNPVUV3UjBoaU9FWnhaejA5OjEsIlNuVnpkR2x1SUV4bFpHOTFlQXBxZFhOMGFXNHViR1ZrYjNWNFFHcDFjM1JwYm5kbFlpNXdjbThzVjJGc2JHRmllUzVxY3lCd1pYSnpiMjVoYkNCc2FXTmxibk5sSUNoVGRXSnNhVzFsSUZSbGVIUXBDakEyTHpBMkx6SXdNVGNLYjJvNWRFRlJZVXR2UTBkYVRHeHRZV2R4WlU0elZFVkNWVzl3VVRGeGNHTlBVa2xqTUhkblZqVXJWRVF6TkU1aGFFZFFWV2hYYUZWU1lTOWFkSHBzTjBWYWIzVjBNelpqWlZKMFRVY3lVa3d3SzJsYU4wWmxZMk5TVm5neVZUUk5iVTl0U0dwT2JFRlhaa050S3pBNGREWlZkMmszUVM5T2QwOVRja2x1TWtSV1dUWnlWMDlqVFdsRlNsazRhV0paWlhwblFWZDFkRGNyVjBFdlRrWXhWMDExWkVjdmVsZG5kVmRQTlRsMVFXRlFlRWQwUm5SWlRqZEJUemRTV2tSRGJHRnliM0lyUzA5TlRtZHpXalF2WW1NMk5FTm1Uak40ZFdZeVJFOWtUakJJTjI4MlZVcExhMDFLYVVOd1pHTkZUWGxUTTFaMVNGSnNSVlprVlUxcU0ycGxabE5sUTAxR1JtRmliSEJYTUZselEyVkNRVFUzV2xOM1dYQklLMDVLTldrcmExbGtNM1pqYkN0emMxRlJlVlJITld4WlVpdGlNbkZXV0RWRVdsVlZUWFYwTUZkVVRYWXJNMGhLUW5wTmNGTnVUalozUFQwPSI6MSwiVUdGMWJDQkpjbWx6YUFwd1lYVnNMbWx5YVhOb1FHZHRZV2xzTG1OdmJTeFhZV3hzWVdKNUxtcHpJSEJsY25OdmJtRnNJR3hwWTJWdWMyVWdLRlpUSUVOdlpHVXBDakF4THpBM0x6SXdNVGNLY1c1eVdHZHRZM1JVSzJRNFFVVTNNRWx2TVZWUmJ5czNTR3hvVGtWdGNVaFVWbk5wY21KWlZDdDZNamhMVGpWd2RUWjZhV1k1UWtkSE4wUlpNRk4yZW14QlQwTlFlWEphVG5vemIzaEpPVU51ZDFsVU1tWmhSR001ZUdwaVVteG1ZbXB3TURsVlRUQmlOMjl5TURWeldFWkhNa3N6U0ZWbVkzWk5Oa000YUcwNWRWbHlaV2xYTkV0TU1Xd3dSVE5HZFVob1pYaDFSM2x2Wm1GQ2RXNUdNakYxWTBWaWNWY3hTRXh1Y0hWRGJFNHJLelJvWWl0VlowaFdiWGhMZWpVM1R6QjJUbFZsVEdzcmFuRlVWU3RDUlUxWWVrNU5ZMWxMVlZGNmIwZHhNRlF3YzFvdldtNTFaMDE1VmpKU1VXeFFlRzFVYUcxblIzaEVTU3RSVVRKNmNYZHBSMjFSZVdGelNGUkxhVFZXUjJ0UVdEWldhbFZsTUdOVmNrVlFMMEp0TkM5V2RYZG9iVmRxUldWU1REWjBiMDQ1TkhwdlJXRmxVRU5KSzNsdVFuZEdUekZMZGtSM2IzWTJaa2xZTURKaGJ6SnRka3QzUFQwPSI6MX07Xy5lYWNoKHcsZnVuY3Rpb24oZSx0KXt0cnl7d1tfLnJ0cmltKGQucGFyc2VLZXkodCkubGljZW5zZVNpZ25hdHVyZSwiPSIpXT0xfWNhdGNoKGkpe319KTt2YXIgUj1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGUpe2EodGhpcyxpKSxzKE9iamVjdC5nZXRQcm90b3R5cGVPZihpLnByb3RvdHlwZSksImNvbnN0cnVjdG9yIix0aGlzKS5jYWxsKHRoaXMpO3ZhciB0PXRoaXM7dGhpcy5fZGlmZk1hdGNoUGF0Y2g9ZS5kaWZmTWF0Y2hQYXRjaDt2YXIgbj1lLlByb2plY3Q7dGhpcy5fcHJvamVjdD1uZXcgbihlKSx0aGlzLl9wcm9qZWN0Lm9uKCJtZXNzYWdlIixmdW5jdGlvbihlKXt2YXIgaT10WyJwcm9qZWN0OiIrZS50eXBlXTtpJiZpLmNhbGwodCxlKX0pLHRoaXMuX2ZzPW5ldyBjKHRoaXMuX3Byb2plY3QuX2xvY2FsUm9vdCxlKSx0aGlzLl9tb2RlbD1uZXcgaCh7ZmlsZUlkQnlQYXRoOmZ1bmN0aW9uKGUpe3JldHVybiB0Ll9mcy5pZEJ5UGF0aChlKX0scHJvamVjdDp0aGlzLl9wcm9qZWN0LGFsd2F5c1NlbmRBbGxMaW5lczoiVlNDb2RlIj09PWUuY2xpZW50fSksdGhpcy5fbW9kZWwub24oIm1lc3NhZ2UiLGZ1bmN0aW9uKGUpe3ZhciBpPXRbIm1vZGVsOiIrZS50eXBlXTtpJiZpLmNhbGwodCxlKX0pLHRoaXMuX3Byb2plY3QuX21vZGVsPXRoaXMuX21vZGVsLHRoaXMuX3JlYWRGaWxlU3luYz1lLnJlYWRGaWxlU3luYyx0aGlzLl93cml0ZUZpbGVTeW5jPWUud3JpdGVGaWxlU3luYyx0aGlzLl92ZXJpZnlMaWNlbnNlKGUuY2xpZW50LGUubGtwKX1yZXR1cm4gcihpLHQpLG4oaSx7Y29uZmlndXJlOnt2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXM7cmV0dXJuIGUuX3J1bklmVmVyaWZpZWQoZnVuY3Rpb24oKXtyZXR1cm4gZS5fcHJvamVjdC5jb25maWd1cmUoKX0pfX0sZmlsZUNoYW5nZWRJbkVkaXRvcjp7dmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fZnMuZmlsZUNoYW5nZWRJbkVkaXRvcihlLnBhdGgsZS5jb250ZW50LGUuY2hhbmdlRnJhbWUpfX0sZmlsZU9wZW5lZEluRWRpdG9yOnt2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLl9tb2RlbC5maWxlQnlQYXRoKGUucGF0aCk7dCYmKHQub3BlbmVkSW5FZGl0b3IoKSx0aGlzLl9lbWl0RG9jdW1lbnRMaW5lcyh0KSl9fSxmaWxlQ2xvc2VkSW5BbGxFZGl0b3JzOnt2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLl9tb2RlbC5maWxlQnlQYXRoKGUucGF0aCk7dCYmdC5jbG9zZWRJbkFsbEVkaXRvcnMoKX19LHJ1blRlc3RzOnt2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLl9tb2RlbC50ZXN0c0J5UmVxdWVzdChlLnJlcXVlc3QpO3RoaXMuX3Byb2plY3QucnVuVGVzdHMoe3Rlc3RzOnQubGVuZ3RoJiZ0fHx2b2lkIDB9KX19LHN0b3A6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2ZzLnN0b3AoKSx0aGlzLl9wcm9qZWN0LnN0b3AoKX19LHVuY292ZXJlZFJlZ2lvbnM6e3ZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUucmVxdWVzdCxpPXt0eXBlOiJ1bmNvdmVyZWRSZWdpb25zIixkYXRhOnt9LGlkOmUuaWR9LG49dGhpcy5fbW9kZWwudW5jb3ZlcmVkUmVnaW9uc0J5UmVxdWVzdCh0KTtyZXR1cm4gbj8oaS5kYXRhLnJhbmdlcz1uLHZvaWQgdGhpcy5fZW1pdChpKSk6dm9pZCB0aGlzLl9lbWl0Tm90aWZpY2F0aW9uKCJpbmZvIiwiQWN0aW9uIGlzIG5vdCBhdmFpbGFibGUgZm9yIGZpbGVzIG91dHNpZGUgd2FsbGFieS5qcyBzY29wZSIpfX0sbGluZVJlcG9ydDp7dmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5yZXF1ZXN0LGk9e3R5cGU6ImxpbmVSZXBvcnQiLGRhdGE6e30saWQ6ZS5pZH0sbj10aGlzLl9tb2RlbC5saW5lUmVwb3J0QnlSZXF1ZXN0KHQpO3JldHVybiBuPyhpLmRhdGEucmVwb3J0PW4sdm9pZCB0aGlzLl9lbWl0KGkpKTp2b2lkIHRoaXMuX2VtaXROb3RpZmljYXRpb24oImluZm8iLCJBY3Rpb24gaXMgbm90IGF2YWlsYWJsZSBmb3IgZmlsZXMgb3V0c2lkZSB3YWxsYWJ5LmpzIHNjb3BlIil9fSxsb2NhdGlvbjp7dmFsdWU6ZnVuY3Rpb24gUihlKXt2YXIgdD1lLnJlcXVlc3QsaT17dHlwZToibG9jYXRpb24iLGRhdGE6e30saWQ6ZS5pZH0sUj10aGlzLl9tb2RlbC5sb2NhdGlvbkJ5UmVxdWVzdCh0KTtSP1IuZmlsZT8oaS5kYXRhLmZpbGU9Ui5maWxlLGkuZGF0YS5sb2M9Ui5sb2MsdGhpcy5fZW1pdChpKSk6dGhpcy5fZW1pdE5vdGlmaWNhdGlvbigiaW5mbyIsIkNhbiBub3QgbG9jYXRlIGEgZmFpbGluZyB0ZXN0Iik6dGhpcy5fZW1pdE5vdGlmaWNhdGlvbigiaW5mbyIsIkNhbiBub3QgZmluZCBhbnkgZmFpbGluZyB0ZXN0cyIpfX0sY29udGludWVUcmlhbDp7dmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9jb250aW51ZVRyaWFsU2Vzc2lvbiYmdGhpcy5fY29udGludWVUcmlhbFNlc3Npb24oKX19LCJwcm9qZWN0OnByb2plY3RDb25maWd1cmVkIjp7dmFsdWU6ZnVuY3Rpb24odCl7dmFyIGk9dGhpcztmPWUoImRlYnVnIikoIndhbGxhYnk6ZXh0ZW5kZWQtY29yZSIpLHRoaXMuX2ZzLnNldHVwKHQuZmlsZXMpLnRoZW4oZnVuY3Rpb24oZSl7cmV0dXJuIGkuX3N0YXJ0KHtmaWxlczppLl9maWxlc0ZvclByb2plY3QoZSl9KX0pLmZhaWwoZnVuY3Rpb24oZSl7Y29uc29sZS5lcnJvcigiRmFpbGVkIHRvIHNldCB1cCBwcm9qZWN0IGZpbGUgc3lzdGVtOiAiK2kuX2Vycm9yTWVzc2FnZShlKSksaS5fZW1pdFRlc3RSdW5FcnJvcihpLl90ZXN0UnVuRXJyb3JNZXNzYWdlKGUpKX0pLHRoaXMuX2ZzLm9uKCJhZGRlZCIsXy5iaW5kKHRoaXMuX3VwZGF0ZVByb2plY3RGaWxlLHRoaXMsITEpKSx0aGlzLl9mcy5vbigibG9hZGVkIixfLmJpbmQodGhpcy5fdXBkYXRlUHJvamVjdEZpbGUsdGhpcywhMSkpLHRoaXMuX2ZzLm9uKCJjaGFuZ2VkIixfLmJpbmQodGhpcy5fdXBkYXRlUHJvamVjdEZpbGUsdGhpcywhMSkpLHRoaXMuX2ZzLm9uKCJkZWxldGVkIixfLmJpbmQodGhpcy5fdXBkYXRlUHJvamVjdEZpbGUsdGhpcywhMCkpLHRoaXMuX2ZzLm9uKCJlcnJvciIsZnVuY3Rpb24oZSl7Y29uc29sZS5lcnJvcigiRmlsZSBzeXN0ZW0gZXJyb3I6ICIraS5fZXJyb3JNZXNzYWdlKGUpKSxpLl9lbWl0VGVzdFJ1bkVycm9yKGkuX3Rlc3RSdW5FcnJvck1lc3NhZ2UoZSkpfSksdGhpcy5fZnMub24oIm5vdENoYW5nZWQiLGZ1bmN0aW9uKGUsdCxuKXt0cnl7aWYobi5zdGFydD09PW4uZW5kKXJldHVybjtmKCJGaWxlIHdhcyBub3QgY2hhbmdlZCwgYnV0IGZpbGUgbWFya2VycyBtYXkgbmVlZCB0byBiZSBzeW5jZWQiKTt2YXIgcz1pLl9tb2RlbC5maWxlQnlJZChlLmlkKTtpZighcylyZXR1cm47aS5fZW1pdERvY3VtZW50TGluZXMocyl9ZmluYWxseXtpLl9lbWl0U3RhdHNVcGRhdGUoKX19KX19LF9lbWl0RG9jdW1lbnRMaW5lczp7dmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9T2JqZWN0LmNyZWF0ZShudWxsKTt0W2UucGF0aCgpXT1lLmFsbExpbmVzKCksdGhpcy5fZW1pdERvY3VtZW50VXBkYXRlcyh0KX19LCJwcm9qZWN0OnRlc3RSdW5FcnJvciI6e3ZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX2VtaXRTdGF0c1VwZGF0ZShlLm1lc3NhZ2UpfX0sInByb2plY3Q6dGVzdFJ1blJlUXVldWVkIjp7dmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9lbWl0U3RhdHNVcGRhdGUodGhpcy5fbW9kZWwuZnVsbFRlc3RSZXN1bHRzUmVwb3J0KCkpfX0sInByb2plY3Q6YnVzeSI6e3ZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5fZW1pdCh7dHlwZToiYnVzeSJ9KX19LCJwcm9qZWN0OmxpdmUiOnt2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9lbWl0KGUpfX0sInByb2plY3Q6bmF2aWdhdGlvblJlcXVlc3RlZCI6e3ZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX2VtaXQoe3R5cGU6ZS50eXBlLGZpbGU6ZS5wYXRoLGxvYzplLmxpbmUrKGUuY29sdW1uPyI6IitlLmNvbHVtbjoiIil9KX19LCJwcm9qZWN0OmZpbGVzUmVxdWlyZWQiOnt2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO3RoaXMuX2ZzLmxvYWRGaWxlcyhlLmZpbGVzKS5mYWlsKGZ1bmN0aW9uKGUpe3JldHVybiB0Ll9lbWl0VGVzdFJ1bkVycm9yKHQuX2Vycm9yTWVzc2FnZShlKSl9KX19LCJwcm9qZWN0OmxpY2Vuc2VDb2xsaXNpb24iOnt2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD0iV2FsbGFieS5qcyBpcyBzdG9wcGVkIGJlY2F1c2UgeW91ciBsaWNlbnNlIGlzIGJlaW5nIHVzZWQgZWxzZXdoZXJlIG9uIHRoZSBuZXR3b3JrIGJ5IDxiPiIrKGUuYWRkcmVzc3x8InVua25vd24gYWRkcmVzcyIpKyc8L2I+LiBPbmx5IG9uZSBhY3RpdmUgY29tcHV0ZXIgYXQgdGhlIHNhbWUgdGltZSBtYXkgdXNlIHRoZSBsaWNlbnNlLjxici8+PGJyLz5JZiB5b3Ugd291bGQgbGlrZSB0byBwdXJjaGFzZSBhbiBhZGRpdGlvbmFsIGxpY2Vuc2UsIHBsZWFzZSB2aXNpdCA8YSBocmVmPSJodHRwOi8vd2FsbGFieWpzLmNvbS9wdXJjaGFzZSI+b3VyIHdlYnNpdGU8L2E+LiBJZiB5b3UgaGF2ZSBhbHJlYWR5IHB1cmNoYXNlZCB0aGUgbGljZW5zZSwgcGxlYXNlIDxhIGhyZWY9IiMiIGNsYXNzPSInK20rJyI+YWN0aXZhdGUgaXQ8L2E+Lic7dGhpcy5fZW1pdE5vdGlmaWNhdGlvbigiZXJyb3IiLHQpLHRoaXMuX2VtaXRTdG9wcGVkKCl9fSwibW9kZWw6c3RhdHNNYXliZUNoYW5nZWQiOnt2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9lbWl0U3RhdHNVcGRhdGUoZS50ZXN0UmVzdWx0c0NoYW5nZWQ/dGhpcy5fbW9kZWwuZnVsbFRlc3RSZXN1bHRzUmVwb3J0KCk6dm9pZCAwKX19LCJtb2RlbDpkb2N1bWVudHNVcGRhdGVkIjp7dmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fZW1pdERvY3VtZW50VXBkYXRlcyhlLmRvY3VtZW50cyl9fSwibW9kZWw6ZmlsZUFkZGVkIjp7dmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fZW1pdEZpbGVzVG9UcmFjayhbZS5maWxlLnBhdGhdKX19LF91cGRhdGVQcm9qZWN0RmlsZTp7dmFsdWU6ZnVuY3Rpb24oZSx0LGksbil7dmFyIHM9dGhpcy5fbW9kZWwuZmlsZUJ5SWQodC5pZCk7aWYoIWUmJnMmJnMuaXNPcGVuZWRJbkVkaXRvcigpJiZzLmhhc1ZhbGlkRG9jdW1lbnQoKSl7dmFyIHI9ITA7aWYoXy5pc1BhdGNoKHQuY29udGVudCkmJl8uaXNTdHJpbmcoaSkmJm4pe3ZhciBhPXRoaXMuX2RpZmZNYXRjaFBhdGNoLnBhdGNoX2Zyb21UZXh0KHQuY29udGVudCk7aWYoMT09PWEubGVuZ3RoKXt2YXIgbz1hWzBdO28mJm8uZGlmZnMmJm8uZGlmZnMubGVuZ3RoJiZvLnN0YXJ0MT09PW8uc3RhcnQyJiYhZnVuY3Rpb24oKXtyPSExO3ZhciBlPW8uc3RhcnQxLHQ9by5kaWZmc1swXTswPT09dFswXSYmKGUrPXRbMV0ubGVuZ3RoKTt2YXIgYT0wO2lmKF8uZWFjaChvLmRpZmZzLGZ1bmN0aW9uKGUpezAhPT1lWzBdJiYoYSs9ZVswXSooXy50ZXh0TGluZXMoZVsxXSkubGVuZ3RoLTEpKX0pLGEpe3ZhciBsPV8udGV4dExpbmVzKGksZSkubGVuZ3RoLHU9Xy50ZXh0TGluZXMoaSxvLnN0YXJ0MSkubGVuZ3RoLGM9TWF0aC5hYnMoYSksaD1NYXRoLm1heChNYXRoLm1pbihuLnN0YXJ0LHUpLWMsMSksZD1NYXRoLm1heChuLmVuZCx1KTtzLnNoaWZ0RG9jdW1lbnRMaW5lcyhsLGEse3N0YXJ0OmgsZW5kOmR9KX1lbHNlIG4uc3RhcnQhPT1uLmVuZCYmcy5pbnZhbGlkYXRlRG9jdW1lbnRMaW5lcygwLDAsbil9KCl9fXImJihmKCJOZXcgZG9jdW1lbnQgb3IgY29tcGxleCBkb2N1bWVudCBjaGFuZ2UiKSxzLmludmFsaWRhdGVEb2N1bWVudCgpKX10aGlzLl9wcm9qZWN0LmZpbGUoe2ZpbGU6dGhpcy5fZmlsZUZvclByb2plY3QodCksImRlbGV0ZSI6ZX0pfX0sX2ZpbGVzRm9yUHJvamVjdDp7dmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIF8ubWFwKGUsdGhpcy5fZmlsZUZvclByb2plY3QpfX0sX2ZpbGVGb3JQcm9qZWN0Ont2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm57cGF0aDplLnBhdGgsaWQ6ZS5pZCx0czplLnRzLG9yZGVyOmUub3JkZXIsaW5jbHVkZTplLmxvYWQsdHJpZ2dlcnNUZXN0czplLnRyaWdnZXIsY292ZXJhYmxlOmUuaW5zdHJ1bWVudCx0ZXN0OmUudGVzdCx0eXBlOmUudHlwZSxiaW5hcnk6ZS5iaW5hcnksY29udGVudDplLmNvbnRlbnR9fX0sX3N0YXJ0Ont2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZW1pdEZpbGVzVG9UcmFjayhfLm1hcChlLmZpbGVzLGZ1bmN0aW9uKGUpe3JldHVybiBlLnBhdGh9KSksZS5saWNlbnNlfHwoZS5saWNlbnNlPXRoaXMuX3ZlcmlmaWNhdGlvblJlc3VsdCYmdGhpcy5fdmVyaWZpY2F0aW9uUmVzdWx0Lmhhc2h8fHRoaXMuX3Byb2plY3QuX3dhbGxhYnlFbWFpbCksZS5leHBpcnlEYXRlfHwoZS5leHBpcnlEYXRlPXRoaXMuX3ZlcmlmaWNhdGlvblJlc3VsdCYmdGhpcy5fdmVyaWZpY2F0aW9uUmVzdWx0LmV4cGlyYXRpb25EYXRlJiZ0aGlzLl92ZXJpZmljYXRpb25SZXN1bHQuZXhwaXJhdGlvbkRhdGUuc3BsaXQoIi8iKS5qb2luKCItIil8fHZvaWQgMCksdGhpcy5fcHJvamVjdC5zdGFydChlKX19LF92ZXJpZnlMaWNlbnNlOnt2YWx1ZTpmdW5jdGlvbihlLHQpe3RoaXMuX3ZlcmlmaWNhdGlvblJlc3VsdD10aGlzLl9saWNlbnNlVmVyaWZpY2F0aW9uUmVzdWx0KGUsdCl9fSxfcnVuSWZWZXJpZmllZDp7dmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fdmVyaWZpY2F0aW9uUmVzdWx0PXRoaXMuX3ZlcmlmaWNhdGlvblJlc3VsdHx8e3ZhbGlkOiExfTt2YXIgdD12b2lkIDA7aWYodGhpcy5fdmVyaWZpY2F0aW9uUmVzdWx0LnZhbGlkKXJldHVybiB0aGlzLl92ZXJpZmljYXRpb25SZXN1bHQuZXhwaXJlZD8odD0nWW91ciBjdXJyZW50IHdhbGxhYnkuanMgbGljZW5zZSA8Yj5mcmVlIHVwZ3JhZGVzIHBlcmlvZCBoYXMgZXhwaXJlZDwvYj4uIElmIHlvdSB3b3VsZCBsaWtlIHRvIHdvcmsgd2l0aCB0aGUgbGF0ZXN0IHZlcnNpb24gb2Ygd2FsbGFieS5qcyBhbmQgZnV0dXJlIHZlcnNpb25zIHJlbGVhc2VkIHdpdGhpbiB0aGUgbmV4dCAxMiBtb250aHMsIHBsZWFzZSB2aXNpdCA8YSBocmVmPSJodHRwOi8vd2FsbGFieWpzLmNvbS9wdXJjaGFzZSI+b3VyIHdlYnNpdGU8L2E+IHRvIHVwZ3JhZGUgeW91ciBsaWNlbnNlLjxici8+PGJyLz5JZiB5b3UgaGF2ZSBhbHJlYWR5IHB1cmNoYXNlZCB0aGUgbmV3IGxpY2Vuc2UsIHBsZWFzZSA8YSBocmVmPSIjIiBjbGFzcz0iJyttKyciPmFjdGl2YXRlIGl0PC9hPi4nLHRoaXMuX2VtaXRFeHBpcmVkTGljZW5zZSgpKTp0aGlzLl92ZXJpZmljYXRpb25SZXN1bHQuZXhwaXJpbmdTb29uJiYodD0iWW91ciBjdXJyZW50IHdhbGxhYnkuanMgbGljZW5zZSA8Yj5mcmVlIHVwZ3JhZGVzIHBlcmlvZCB3aWxsIGV4cGlyZSBzb29uIG9uICIrdGhpcy5fdmVyaWZpY2F0aW9uUmVzdWx0LmV4cGlyYXRpb25EYXRlKyc8L2I+LiBJZiB5b3Ugd291bGQgbGlrZSB0byB3b3JrIHdpdGggdGhlIGxhdGVzdCB2ZXJzaW9uIG9mIHdhbGxhYnkuanMgYW5kIGZ1dHVyZSB2ZXJzaW9ucyByZWxlYXNlZCB3aXRoaW4gdGhlIG5leHQgMTIgbW9udGhzLCBwbGVhc2UgdmlzaXQgPGEgaHJlZj0iaHR0cDovL3dhbGxhYnlqcy5jb20vcHVyY2hhc2UiPm91ciB3ZWJzaXRlPC9hPiB0byB1cGdyYWRlIHlvdXIgbGljZW5zZS48YnIvPjxici8+SWYgeW91IGhhdmUgYWxyZWFkeSBwdXJjaGFzZWQgdGhlIG5ldyBsaWNlbnNlLCBwbGVhc2UgPGEgaHJlZj0iIyIgY2xhc3M9IicrbSsnIj5hY3RpdmF0ZSBpdDwvYT4uJyksdCYmdGhpcy5fZW1pdE5vdGlmaWNhdGlvbigid2FybmluZyIsdCksZSgpO2lmKHRoaXMuX3ZlcmlmaWNhdGlvblJlc3VsdC5leHBpcmVkVHJpYWwpdD0nWW91ciB3YWxsYWJ5LmpzIHRyaWFsIHBlcmlvZCBpcyBvdmVyLCB0aGFua3MgZm9yIHRyeWluZyBpdCBvdXQuIFBsZWFzZSB2aXNpdCA8YSBocmVmPSJodHRwOi8vd2FsbGFieWpzLmNvbS9wdXJjaGFzZSI+b3VyIHdlYnNpdGU8L2E+IHRvIHB1cmNoYXNlIGEgbGljZW5zZSBvciB0byBhcnJhbmdlIGEgbG9uZ2VyIHRyaWFsIHBlcmlvZCBmb3IgeW91cnNlbGYgb3IgeW91ciB0ZWFtLjxici8+PGJyLz5JZiB5b3UgaGF2ZSBhbHJlYWR5IHB1cmNoYXNlZCB0aGUgbGljZW5zZSwgcGxlYXNlIDxhIGhyZWY9IiMiIGNsYXNzPSInK20rJyI+YWN0aXZhdGUgaXQ8L2E+LicsdGhpcy5fZW1pdE5vdGlmaWNhdGlvbigiZXJyb3IiLHQpLHRoaXMuX2VtaXRTdG9wcGVkKCk7ZWxzZXtpZighdGhpcy5fdmVyaWZpY2F0aW9uUmVzdWx0LmludmFsaWRWZXJzaW9uKXJldHVybiB0PSdObyB2YWxpZCB3YWxsYWJ5LmpzIGxpY2Vuc2UgZm91bmQuIFdhbGxhYnkuanMgd2lsbCBzdGFydCBpbiB0cmlhbCBtb2RlLjxici8+PGJyLz5JZiB5b3Ugd291bGQgbGlrZSB0byBwdXJjaGFzZSBhIGxpY2Vuc2UsIHBsZWFzZSB2aXNpdCA8YSBocmVmPSJodHRwOi8vd2FsbGFieWpzLmNvbS9wdXJjaGFzZSI+b3VyIHdlYnNpdGU8L2E+Ljxici8+PGJyLz5JZiB5b3UgaGF2ZSBhbHJlYWR5IHB1cmNoYXNlZCB0aGUgbGljZW5zZSwgcGxlYXNlIDxhIGhyZWY9IiMiIGNsYXNzPSInK20rJyI+YWN0aXZhdGUgaXQ8L2E+LicsdGhpcy5fZW1pdE5vdGlmaWNhdGlvbigid2FybmluZyIsdCksdGhpcy5fdHJpYWxNb2RlKCksZSgpO3Q9J0N1cnJlbnRseSBpbnN0YWxsZWQgdmVyc2lvbiBvZiB3YWxsYWJ5LmpzIGlzIDxiPm5vdCBjb3ZlcmVkIGJ5IHlvdXIgbGljZW5zZTwvYj4uIFBsZWFzZSB2aXNpdCA8YSBocmVmPSJodHRwOi8vd2FsbGFieWpzLmNvbS9wdXJjaGFzZSI+b3VyIHdlYnNpdGU8L2E+IHRvIHVwZ3JhZGUgeW91ciBsaWNlbnNlLjxici8+PGJyLz5JZiB5b3UgaGF2ZSBhbHJlYWR5IHB1cmNoYXNlZCB0aGUgbGljZW5zZSwgcGxlYXNlIDxhIGhyZWY9IiMiIGNsYXNzPSInK20rJyI+YWN0aXZhdGUgaXQ8L2E+LicsdGhpcy5fZW1pdE5vdGlmaWNhdGlvbigiZXJyb3IiLHQpLHRoaXMuX2VtaXRTdG9wcGVkKCl9fX0sX3RyaWFsTW9kZTp7dmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztlPWV8fDAsbChmdW5jdGlvbigpe2U+PWc/KHQuX2VtaXROb3RpZmljYXRpb24oIndhcm5pbmciLCdXYWxsYWJ5LmpzIDxiPnRyaWFsIHNlc3Npb24gaXMgb3ZlcjwvYj4uIFRvIGtlZXAgdXNpbmcgd2FsbGFieS5qcywgcGxlYXNlIDxiPnJlc3RhcnQgeW91ciBlZGl0b3I8L2I+IG9yIHZpc2l0IDxhIGhyZWY9Imh0dHA6Ly93YWxsYWJ5anMuY29tL3B1cmNoYXNlIj5vdXIgd2Vic2l0ZTwvYT4gdG8gcHVyY2hhc2UgYSBsaWNlbnNlLjxici8+PGJyLz5JZiB5b3UgaGF2ZSBhbHJlYWR5IHB1cmNoYXNlZCB0aGUgbGljZW5zZSwgcGxlYXNlIDxhIGhyZWY9IiMiIGNsYXNzPSInK20rJyI+YWN0aXZhdGUgaXQ8L2E+LicpLHQuc3RvcCgpLHQuX2VtaXRTdG9wcGVkKCEwKSk6KHQuX2NvbnRpbnVlVHJpYWxTZXNzaW9uPWZ1bmN0aW9uKCl7dSh0Ll9zdG9wcGVyVGltZW91dCksdC5fdHJpYWxNb2RlKGUrMSl9LHQuX3N0b3BwZXJUaW1lb3V0PWwoZnVuY3Rpb24oKXt0LnN0b3AoKSx0Ll9lbWl0U3RvcHBlZCgpfSxwKSx0Ll9lbWl0Tm90aWZpY2F0aW9uKCJ3YXJuaW5nIiwnV2FsbGFieS5qcyB3aWxsIHN0b3AgaW4gYSBmZXcgc2Vjb25kcy4gVG8gPGI+Y29udGludWUgd2FsbGFieS5qcyB0cmlhbCBzZXNzaW9uPC9iPiwgcGxlYXNlIDxhIGhyZWY9IiMiIGNsYXNzPSInK3krJyI+Y2xpY2sgaGVyZTwvYT4uPGJyLz48YnIvPlZpc2l0IDxhIGhyZWY9Imh0dHA6Ly93YWxsYWJ5anMuY29tL3B1cmNoYXNlIj5vdXIgd2Vic2l0ZTwvYT4gdG8gcHVyY2hhc2UgYSBsaWNlbnNlLjxici8+PGJyLz5JZiB5b3UgaGF2ZSBhbHJlYWR5IHB1cmNoYXNlZCB0aGUgbGljZW5zZSwgcGxlYXNlIDxhIGhyZWY9IiMiIGNsYXNzPSInK20rJyI+YWN0aXZhdGUgaXQ8L2E+LicpKX0sdil9fSxfbGljZW5zZVZlcmlmaWNhdGlvblJlc3VsdDp7dmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgaT10aGlzLG49e3ZhbGlkOiExLGV4cGlyZWRUcmlhbDohMH0scz12b2lkIDA7dHJ5e3M9aS5fcmVhZEZpbGVTeW5jKHQpfWNhdGNoKHIpe3RyeXtpLl93cml0ZUZpbGVTeW5jKHQsK25ldyBEYXRlKX1jYXRjaChhKXt9fXRyeXtpZihfLmlzU3RyaW5nKHMpKWlmKHMubGVuZ3RoPjEwMCl7dmFyIGw9ZC5wYXJzZUtleShzKSx1PWwubGljZW5zZVNpZ25hdHVyZTtpZih3W18ucnRyaW0odSwiPSIpXSluLmV4cGlyZWRUcmlhbD0hMTtlbHNle24uZXhwaXJlZFRyaWFsPSExLG4ua2V5PXM7dmFyIGM9bC5saWNlbnNlZU5hbWUsaD1sLmxpY2Vuc2VlRW1haWwsZj1sLmxpY2Vuc2VUYWdzLHY9bC5saWNlbnNlZFByb2R1Y3QscD1sLmV4cGlyYXRpb25EYXRlU3RyaW5nO24ubmFtZT1jLG4uZXhwaXJhdGlvbkRhdGU9cDt2YXIgZz1vLmNyZWF0ZVZlcmlmeSgiUlNBLVNIQTUxMiIpO2lmKGcudXBkYXRlKG5ldyBCdWZmZXIoYytmK3ApKSxuLnZhbGlkPWcudmVyaWZ5KFRbfnYuaW5kZXhPZihiKT9iOmVdLG5ldyBCdWZmZXIodSwiYmFzZTY0IikpLG4udmFsaWQpe3ZhciBtPXAuc3BsaXQoIi8iKSx5PW5ldyBEYXRlKG1bMV0rIi8iK21bMF0rIi8iK21bMl0pO2lmKHk8bmV3IERhdGUoMTQ3MTIzNTU5MjQxNCkpbi5pbnZhbGlkVmVyc2lvbj0hMCxuLnZhbGlkPSExO2Vsc2V7dmFyIFI9aD09PWkuX3Byb2plY3QuX3dhbGxhYnlFbWFpbDt0cnl7dmFyIEY9dm9pZCAwO24uaGFzaD1SP2kuX3Byb2plY3QuX3dhbGxhYnlFbWFpbDooRj1vLmNyZWF0ZUhhc2goInNoYTUxMiIpLEYudXBkYXRlKG5ldyBCdWZmZXIocywiYmFzZTY0IikpLEYuZGlnZXN0KCJiYXNlNjQiKSl9Y2F0Y2goail7bi5oYXNoPWkuX3Byb2plY3QuX3dhbGxhYnlFbWFpbH1pZih5PG5ldyBEYXRlKW4uZXhwaXJlZD0hMCxuLnZhbGlkPSFSLG4uZXhwaXJlZFRyaWFsPVI7ZWxzZXt2YXIgQz1uZXcgRGF0ZTtDLnNldERhdGUoQy5nZXREYXRlKCkrMTQpLG4uZXhwaXJpbmdTb29uPUM+eX19fX19ZWxzZXt2YXIgRT1wYXJzZUludChzLDEwKTtuLmV4cGlyZWRUcmlhbD1fLmlzTmFOKEUpfHxFKzI2MjhlNjwrbmV3IERhdGV9ZWxzZSBuLmV4cGlyZWRUcmlhbD0hMX1jYXRjaChqKXtuLnZhbGlkPSExfXJldHVybiBufX0sX2VtaXRGaWxlc1RvVHJhY2s6e3ZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX2VtaXQoe3R5cGU6ImZpbGVzVG9UcmFjayIsZmlsZXM6ZX0pfX0sX2VtaXRUZXN0UnVuRXJyb3I6e3ZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX2VtaXQoe3R5cGU6InN0YXRzIixkYXRhOmV9KX19LF9lbWl0RG9jdW1lbnRVcGRhdGVzOnt2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9lbWl0KHt0eXBlOiJkb2N1bWVudFVwZGF0ZXMiLHVwZGF0ZXM6ZX0pfX0sX2VtaXRTdGF0c1VwZGF0ZTp7dmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fZW1pdCh7dHlwZToic3RhdHMiLGRhdGE6ZX0pfX0sX2VtaXRQcm9qZWN0Q29uZmlndXJlZDp7dmFsdWU6ZnVuY3Rpb24oZSx0KXt0aGlzLl9lbWl0KF8uZXh0ZW5kKHQse2ZpbGVzOmV9KSl9fSxfZW1pdE5vdGlmaWNhdGlvbjp7dmFsdWU6ZnVuY3Rpb24oZSx0KXt0aGlzLl9lbWl0KHt0eXBlOiJub3RpZmljYXRpb24iLG5vdGlmaWNhdGlvbjp7dGV4dDp0LHR5cGU6ZX19KX19LF9lbWl0U3RvcHBlZDp7dmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fZW1pdCh7dHlwZToic3RvcHBlZCIsZGVhY3RpdmF0ZTplfSl9fSxfZW1pdEV4cGlyZWRMaWNlbnNlOnt2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX2VtaXQoe3R5cGU6ImV4cGlyZWRMaWNlbnNlIn0pfX0sX2VtaXQ6e3ZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuZW1pdCgibWVzc2FnZSIsZSl9fSxfZXJyb3JNZXNzYWdlOnt2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZSYmKGUuc3RhY2t8fGUubWVzc2FnZSl9fSxfdGVzdFJ1bkVycm9yTWVzc2FnZTp7dmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJmUubWVzc2FnZX19fSksaX0oRXZlbnRFbWl0dGVyKTt0LmV4cG9ydHM9Un0seyIuL3NlcnZlci9maWxlU3lzdGVtIjo5LCIuL3NlcnZlci9tb2RlbCI6MTAsIi4vc2hhcmVkL3V0aWxzIjoxNSxjcnlwdG86dm9pZCAwLGRlYnVnOnZvaWQgMCx0aW1lcnM6dm9pZCAwfV0sMzpbZnVuY3Rpb24oZSx0LGkpeyJ1c2Ugc3RyaWN0Ijt2YXIgbj1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0KXtmb3IodmFyIGkgaW4gdCl7dmFyIG49dFtpXTtuLmNvbmZpZ3VyYWJsZT0hMCxuLnZhbHVlJiYobi53cml0YWJsZT0hMCl9T2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSx0KX1yZXR1cm4gZnVuY3Rpb24odCxpLG4pe3JldHVybiBpJiZlKHQucHJvdG90eXBlLGkpLG4mJmUodCxuKSx0fX0oKSxzPWZ1bmN0aW9uKGUsdCl7aWYoIShlIGluc3RhbmNlb2YgdCkpdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIil9LHI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe3ModGhpcyxlKSx0aGlzLl90ZXN0SWQ9dC5zcGVjLHRoaXMuX2ZpbGVJZD10LmZpbGUsdGhpcy5fcmFuZ2U9dC5yYW5nZSx0aGlzLl90ZXh0PXQudGV4dCx0aGlzLl90eXBlPXQudHlwZX1yZXR1cm4gbihlLHt0ZXN0SWQ6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Rlc3RJZH19LGZpbGVJZDp7dmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZmlsZUlkfX0scmFuZ2U6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3JhbmdlfX0sc2V0UmFuZ2U6e3ZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX3JhbmdlPWV9fSx0ZXh0Ont2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl90ZXh0fX0sdHlwZTp7dmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdHlwZX19LHNldEZpbGU6e3ZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX2ZpbGU9ZX19LGZpbGU6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2ZpbGV9fSxsaW5lOnt2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9yYW5nZT9fLmlzQXJyYXkodGhpcy5fcmFuZ2UpP3RoaXMuX3JhbmdlWzBdOnRoaXMuX3JhbmdlLnN0YXJ0TGluZSgpOnZvaWQgMH19fSksZX0oKTt0LmV4cG9ydHM9cn0se31dLDQ6W2Z1bmN0aW9uKGUsdCxpKXsidXNlIHN0cmljdCI7dmFyIG49ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsdCl7Zm9yKHZhciBpIGluIHQpe3ZhciBuPXRbaV07bi5jb25maWd1cmFibGU9ITAsbi52YWx1ZSYmKG4ud3JpdGFibGU9ITApfU9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGUsdCl9cmV0dXJuIGZ1bmN0aW9uKHQsaSxuKXtyZXR1cm4gaSYmZSh0LnByb3RvdHlwZSxpKSxuJiZlKHQsbiksdH19KCkscz1mdW5jdGlvbihlLHQpe2lmKCEoZSBpbnN0YW5jZW9mIHQpKXRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpfSxyPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXtzKHRoaXMsZSksdGhpcy5faXRlbXM9dC5pdGVtcyx0aGlzLl9oaXRzPXQuaGl0c31yZXR1cm4gbihlLHtpbml0Ont2YWx1ZTpmdW5jdGlvbih0LGkpe3ZhciBuPXRoaXM7dGhpcy5fa2V5PWUucmFuZ2VLZXkodGhpcy5faXRlbXMpLHRoaXMuX2ZpbGU9dCx0aGlzLl9zdGFydExpbmU9dGhpcy5faXRlbXNbMF0sdGhpcy5fc3RhcnRDb2x1bW49dGhpcy5faXRlbXNbMV0sdGhpcy5fZW5kTGluZT10aGlzLl9pdGVtc1syXSx0aGlzLl9lbmRDb2x1bW49dGhpcy5faXRlbXNbM10sdGhpcy5fbnVtT2ZDb3ZlcmluZ1Rlc3RzPTAsdGhpcy5faXNDb3ZlcmVkPSExLHRoaXMuX2hpdHMmJih0aGlzLl9jb3ZlcmluZ1Rlc3RNYXA9T2JqZWN0LmNyZWF0ZShudWxsKSxfLmVhY2godGhpcy5faGl0cyxmdW5jdGlvbihlKXtpZihlKXt2YXIgdD1pW2VdO2lmKCF0KXJldHVybjt2YXIgcz10LmtleSgpO24uX2NvdmVyaW5nVGVzdE1hcFtzXT10LG4uX2FkZEZhaWxlZE9uTWVUZXN0SWZGYWlsaW5nKHQpfWVsc2Ugbi5faXNDb3ZlcmVkQnlOb3RUZXN0cz0hMH0pLG4uX251bU9mQ292ZXJpbmdUZXN0cz1fLnNpemUobi5fY292ZXJpbmdUZXN0TWFwKSxuLl9zZXRJc0NvdmVyZWQoKSksZGVsZXRlIHRoaXMuX2l0ZW1zLGRlbGV0ZSB0aGlzLl9oaXRzfX0sbGluZVNoaWZ0Ont2YWx1ZTpmdW5jdGlvbih0KXt0aGlzLl9zdGFydExpbmUrPXQsdGhpcy5fZW5kTGluZSs9dCx0aGlzLl9rZXk9ZS5yYW5nZUtleShbdGhpcy5fc3RhcnRMaW5lLHRoaXMuX3N0YXJ0Q29sdW1uLHRoaXMuX2VuZExpbmUsdGhpcy5fZW5kQ29sdW1uXSl9fSxzdGFydExpbmU6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3N0YXJ0TGluZX19LHN0YXJ0Q29sdW1uOnt2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zdGFydENvbHVtbn19LGVuZExpbmU6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2VuZExpbmV9fSxlbmRDb2x1bW46e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2VuZENvbHVtbn19LGZhaWxzOnt2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9nbG9iYWxFcnJvcnN8fCh0aGlzLl9nbG9iYWxFcnJvcnM9W10pLH50aGlzLl9nbG9iYWxFcnJvcnMuaW5kZXhPZihlKXx8dGhpcy5fZ2xvYmFsRXJyb3JzLnB1c2goZSl9fSxzZXRDb25zb2xlTG9nOnt2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9jb25zb2xlTG9nPWV9fSxjb25zb2xlTG9nOnt2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9jb25zb2xlTG9nfX0sa2V5Ont2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9rZXl9fSxpc0Rpc3Bvc2VkOnt2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0Rpc3Bvc2VkfX0saXNFcnJvclNvdXJjZTp7dmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZmFpbGVkQnlNZVRlc3RzJiYhXy5pc0VtcHR5KHRoaXMuX2ZhaWxlZEJ5TWVUZXN0cyl8fHRoaXMuX2dsb2JhbEVycm9ycyYmIV8uaXNFbXB0eSh0aGlzLl9nbG9iYWxFcnJvcnMpfX0saXNPbkVycm9yUGF0aDp7dmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZmFpbGVkT25NZVRlc3RzJiYhXy5pc0VtcHR5KHRoaXMuX2ZhaWxlZE9uTWVUZXN0cyl9fSxlcnJvcnM6e3ZhbHVlOmZ1bmN0aW9uIHQoKXt2YXIgdD1bXTtyZXR1cm4gdGhpcy5pc0Vycm9yU291cmNlKCk/KHRoaXMuX2ZhaWxlZEJ5TWVUZXN0cyYmKHQ9dC5jb25jYXQoXy5mbGF0dGVuKF8udmFsdWVzKHRoaXMuX2ZhaWxlZEJ5TWVUZXN0cykpKSksdGhpcy5fZ2xvYmFsRXJyb3JzJiYodD10LmNvbmNhdCh0aGlzLl9nbG9iYWxFcnJvcnMpKSx0KTp0fX0sZGlzcG9zZTp7dmFsdWU6ZnVuY3Rpb24oKXtkZWxldGUgdGhpcy5fZmlsZSxkZWxldGUgdGhpcy5fY292ZXJpbmdUZXN0TWFwLGRlbGV0ZSB0aGlzLl9mYWlsZWRPbk1lVGVzdHMsZGVsZXRlIHRoaXMuX2ZhaWxlZEJ5TWVUZXN0cyxkZWxldGUgdGhpcy5fZ2xvYmFsRXJyb3JzLHRoaXMuX2lzRGlzcG9zZWQ9ITAsZGVsZXRlIHRoaXMuX251bU9mQ292ZXJpbmdUZXN0c319LHNvdXJjZUZpbGU6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2ZpbGV9fSxmYWlsc1Rlc3Q6e3ZhbHVlOmZ1bmN0aW9uKGUsdCl7dGhpcy5fZmFpbGVkQnlNZVRlc3RzfHwodGhpcy5fZmFpbGVkQnlNZVRlc3RzPU9iamVjdC5jcmVhdGUobnVsbCkpLHRoaXMuX2ZhaWxlZEJ5TWVUZXN0c1tlLmtleSgpXT10fX0sbm90Q292ZXJlZEJ5Ont2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLmtleSgpLGk9dGhpcy5pc0NvdmVyZWQoKTt0aGlzLl9jb3ZlcmluZ1Rlc3RNYXAmJnRoaXMuX2NvdmVyaW5nVGVzdE1hcFt0XSYmKGRlbGV0ZSB0aGlzLl9jb3ZlcmluZ1Rlc3RNYXBbdF0sdGhpcy5fbnVtT2ZDb3ZlcmluZ1Rlc3RzLS0sdGhpcy5fc2V0SXNDb3ZlcmVkKCkpLHRoaXMuX2ZhaWxlZEJ5TWVUZXN0cyYmZGVsZXRlIHRoaXMuX2ZhaWxlZEJ5TWVUZXN0c1t0XSx0aGlzLl9mYWlsZWRPbk1lVGVzdHMmJmRlbGV0ZSB0aGlzLl9mYWlsZWRPbk1lVGVzdHNbdF0sbnVsbCE9dGhpcy5fZmlsZSYmdGhpcy5fZmlsZS5yYW5nZUNvdmVyYWdlQ2hhbmdlZCh0aGlzLGkpfX0sY292ZXJpbmdUZXN0czp7dmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gXy52YWx1ZXModGhpcy5fY292ZXJpbmdUZXN0TWFwKX19LGlzQ292ZXJlZDp7dmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNDb3ZlcmVkfX0sX3NldElzQ292ZXJlZDp7dmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9pc0NvdmVyZWQ9dGhpcy5fbnVtT2ZDb3ZlcmluZ1Rlc3RzPjB8fHRoaXMuX2lzQ292ZXJlZEJ5Tm90VGVzdHN9fSxhdHRhY2hlZFRvU291cmNlRmlsZTp7dmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3RoaXMuX2NvdmVyaW5nVGVzdE1hcCYmXy5lYWNoKHRoaXMuX2NvdmVyaW5nVGVzdE1hcCxmdW5jdGlvbih0KXtyZXR1cm4gdC5jb3ZlcnMoZSl9KX19LHVwZGF0ZUZyb206e3ZhbHVlOmZ1bmN0aW9uKGUsdCxpKXt2YXIgbj10aGlzO3QmJmkmJl8uaXNFbXB0eShlLl9jb3ZlcmluZ1Rlc3RNYXApfHwodGhpcy5faXNDb3ZlcmVkQnlOb3RUZXN0cz1lLl9pc0NvdmVyZWRCeU5vdFRlc3RzLHRoaXMuX2NvbnNvbGVMb2c9ZS5fY29uc29sZUxvZyx0aGlzLl9mYWlsZWRCeU1lVGVzdHMmJih0aGlzLl9mYWlsZWRCeU1lVGVzdHM9T2JqZWN0LmNyZWF0ZShudWxsKSksdGhpcy5fZ2xvYmFsRXJyb3JzJiYodGhpcy5fZ2xvYmFsRXJyb3JzPVtdKSxlLl9jb3ZlcmluZ1Rlc3RNYXA/KHQmJiFpPyh0aGlzLl9jb3ZlcmluZ1Rlc3RNYXA9T2JqZWN0LmNyZWF0ZShudWxsKSx0aGlzLl9mYWlsZWRPbk1lVGVzdHMmJih0aGlzLl9mYWlsZWRPbk1lVGVzdHM9T2JqZWN0LmNyZWF0ZShudWxsKSksXy5lYWNoKGUuX2NvdmVyaW5nVGVzdE1hcCxmdW5jdGlvbihlKXt2YXIgdD1lLmtleSgpO24uX2NvdmVyaW5nVGVzdE1hcFt0XT1lLGUuY292ZXJzKG4pLG4uX2FkZEZhaWxlZE9uTWVUZXN0SWZGYWlsaW5nKGUpfSkpOm4uX2ZhaWxlZE9uTWVUZXN0cz9fLmVhY2goZS5fY292ZXJpbmdUZXN0TWFwLGZ1bmN0aW9uKGUpe3JldHVybiBuLl91cGRhdGVUZXN0V2l0aFBvc3NpYmxlRmFpbGVkT25UaGVSYW5nZShlLGUua2V5KCkpfSk6Xy5lYWNoKGUuX2NvdmVyaW5nVGVzdE1hcCxmdW5jdGlvbihlKXtyZXR1cm4gbi5fdXBkYXRlVGVzdChlLGUua2V5KCkpfSksbi5fbnVtT2ZDb3ZlcmluZ1Rlc3RzPV8uc2l6ZShuLl9jb3ZlcmluZ1Rlc3RNYXApKToodGhpcy5fY292ZXJpbmdUZXN0TWFwPU9iamVjdC5jcmVhdGUobnVsbCksdGhpcy5fbnVtT2ZDb3ZlcmluZ1Rlc3RzPTAsdGhpcy5fZmFpbGVkT25NZVRlc3RzJiYodGhpcy5fZmFpbGVkT25NZVRlc3RzPU9iamVjdC5jcmVhdGUobnVsbCkpKSx0aGlzLl9zZXRJc0NvdmVyZWQoKSl9fSxfdXBkYXRlVGVzdDp7dmFsdWU6ZnVuY3Rpb24oZSx0KXt0aGlzLl9jb3ZlcmluZ1Rlc3RNYXBbdF09ZSxlLmNvdmVycyh0aGlzKSx0aGlzLl9hZGRGYWlsZWRPbk1lVGVzdElmRmFpbGluZyhlKX19LF91cGRhdGVUZXN0V2l0aFBvc3NpYmxlRmFpbGVkT25UaGVSYW5nZTp7dmFsdWU6ZnVuY3Rpb24oZSx0KXtkZWxldGUgdGhpcy5fZmFpbGVkT25NZVRlc3RzW3RdLHRoaXMuX3VwZGF0ZVRlc3QoZSx0KX19LGlzSW5zaWRlT2Y6e3ZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9zdGFydExpbmU+PWUuX3N0YXJ0TGluZSYmZS5fZW5kTGluZT49dGhpcy5fZW5kTGluZSYmKHRoaXMuX3N0YXJ0TGluZT5lLl9zdGFydExpbmV8fHRoaXMuX3N0YXJ0Q29sdW1uPj1lLl9zdGFydENvbHVtbikmJihlLl9lbmRMaW5lPnRoaXMuX2VuZExpbmV8fGUuX2VuZENvbHVtbj49dGhpcy5fZW5kQ29sdW1uKX19LF9hZGRGYWlsZWRPbk1lVGVzdElmRmFpbGluZzp7dmFsdWU6ZnVuY3Rpb24oZSl7ZS5pc0ZhaWxpbmcoKSYmKHRoaXMuX2ZhaWxlZE9uTWVUZXN0c3x8KHRoaXMuX2ZhaWxlZE9uTWVUZXN0cz1PYmplY3QuY3JlYXRlKG51bGwpKSx0aGlzLl9mYWlsZWRPbk1lVGVzdHNbZS5rZXkoKV09ZSl9fX0se3JhbmdlS2V5Ont2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZS5qb2luKCIuIil9fX0pLGV9KCk7dC5leHBvcnRzPXJ9LHt9XSw1OltmdW5jdGlvbihlLHQsaSl7InVzZSBzdHJpY3QiO3ZhciBuPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQpe2Zvcih2YXIgaSBpbiB0KXt2YXIgbj10W2ldO24uY29uZmlndXJhYmxlPSEwLG4udmFsdWUmJihuLndyaXRhYmxlPSEwKX1PYmplY3QuZGVmaW5lUHJvcGVydGllcyhlLHQpfXJldHVybiBmdW5jdGlvbih0LGksbil7cmV0dXJuIGkmJmUodC5wcm90b3R5cGUsaSksbiYmZSh0LG4pLHR9fSgpLHM9ZnVuY3Rpb24oZSx0KXtpZighKGUgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKX0scj1lKCIuL2RvY3VtZW50TGluZSIpLGE9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7cyh0aGlzLGUpLHRoaXMuX2xpbmVzPU9iamVjdC5jcmVhdGUobnVsbCksdGhpcy5fcmVjeWNsZWRMaW5lcz1bXSx0aGlzLl9saW5lU2hpZnRPckludmFsaWRhdGlvblNpbmNlTGFzdFVwZGF0ZT0hMX1yZXR1cm4gbihlLHt1cGRhdGU6e3ZhbHVlOmZ1bmN0aW9uKGUsdCxpKXt2YXIgbj10aGlzLHM9dGhpcy5fbGluZVNoaWZ0T3JJbnZhbGlkYXRpb25TaW5jZUxhc3RVcGRhdGU7ZGVsZXRlIHRoaXMuX2xpbmVTaGlmdE9ySW52YWxpZGF0aW9uU2luY2VMYXN0VXBkYXRlLGk/KHRoaXMuX2xpbmVzPU9iamVjdC5jcmVhdGUobnVsbCksdGhpcy5fcmVjeWNsZWRMaW5lcz1bXSk6dCYmXy5lYWNoKHRoaXMuX2xpbmVzLGZ1bmN0aW9uKGUpe2UucmVtb3ZlUmFuZ2VzKCl9KTt2YXIgYT1bXSxvPVtdO18uZWFjaChlLGZ1bmN0aW9uKGUpe2lmKCFlLmlzRGlzcG9zZWQoKSl7dmFyIGk9ZS5zdGFydExpbmUoKSxzPW4uX2xpbmVzW2ldO3N8fChzPW5ldyByKGkpLG4uX2xpbmVzW2ldPXMsby5wdXNoKHMpKSxzLmFkZFJhbmdlKGUsdCksYS5wdXNoKHMpfX0pO3ZhciBsPU9iamVjdC5jcmVhdGUobnVsbCk7YT10JiYhaT9fLnZhbHVlcyh0aGlzLl9saW5lcykuY29uY2F0KG8pOmEsXy5lYWNoKGEsZnVuY3Rpb24oZSl7ZS5oYXNSYW5nZXMoKT9lLnVwZGF0ZUxpbmVEYXRhKCkmJihsW2Uua2V5KCldPWUpOihlLmRpc3Bvc2UoKSxkZWxldGUgbi5fbGluZXNbZS5udW1iZXIoKV0sbi5fcmVjeWNsZWRMaW5lcy5wdXNoKGUpKX0pO3ZhciB1PXRoaXMuX3JlY3ljbGVkTGluZXMuc2xpY2UoKTtyZXR1cm4gdGhpcy5fcmVjeWNsZWRMaW5lcz1bXSx7bGluZXM6aT9fLm1hcCh0aGlzLl9saW5lcyxmdW5jdGlvbihlKXtyZXR1cm4gbi5fY29tcGFjdExpbmUoZSl9KTpfLm1hcChzP3RoaXMuX2xpbmVzOmwsZnVuY3Rpb24oZSl7dmFyIHQ9bi5fY29tcGFjdExpbmUoZSk7cmV0dXJuIHQuY2hhbmdlZD1zPyEhbFtlLmtleSgpXXx8dm9pZCAwOjEsdH0pLmNvbmNhdChfLm1hcCh1LGZ1bmN0aW9uKGUpe3JldHVybntpZDplLmtleSgpLGRlbDoxfX0pKSxhbGxMaW5lczppfHxzfX19LGxpbmU6e3ZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9saW5lc1tlXX19LGFsbExpbmVzOnt2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXM7cmV0dXJue2xpbmVzOl8ubWFwKHRoaXMuX2xpbmVzLGZ1bmN0aW9uKHQpe3JldHVybiBlLl9jb21wYWN0TGluZSh0KX0pLGFsbExpbmVzOiEwfX19LF9jb21wYWN0TGluZTp7dmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJue2lkOmUua2V5KCksbnVtOmUubnVtYmVyKCksc3RhdGU6ZS5zdGF0ZSgpLGxvZzplLmNvbnNvbGVMb2dUZXh0KCksZXJyOmUuZXJyb3JTb3VyY2VUZXh0KCl9fX0saW52YWxpZGF0ZUxpbmVzOnt2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO3RoaXMuX2xpbmVTaGlmdE9ySW52YWxpZGF0aW9uU2luY2VMYXN0VXBkYXRlPSEwLF8uZWFjaChfLnJhbmdlKGUuc3RhcnQsZS5lbmQpLGZ1bmN0aW9uKGkpe3ZhciBuPXQuX2xpbmVzW2ldO24mJnQuX3JlY3ljbGVMaW5lSWZJbkNoYW5nZUZyYW1lKG4sZSl9KX19LHNoaWZ0TGluZXM6e3ZhbHVlOmZ1bmN0aW9uKGUsdCxpKXt2YXIgbj10aGlzO3RoaXMuX2xpbmVTaGlmdE9ySW52YWxpZGF0aW9uU2luY2VMYXN0VXBkYXRlPSEwO3ZhciBzPV8udmFsdWVzKHRoaXMuX2xpbmVzKTt0aGlzLl9saW5lcz1PYmplY3QuY3JlYXRlKG51bGwpLF8uZWFjaChzLGZ1bmN0aW9uKHMpe3ZhciByPXMubnVtYmVyKCk7aWYoIW4uX3JlY3ljbGVMaW5lSWZJbkNoYW5nZUZyYW1lKHMsaSkpe3I+ZSYmKHIrPXQscy5udW1iZXIocikpO3ZhciBhPW4uX2xpbmVzW3JdO2E/KGEuZGlzcG9zZSgpLHMuZGlzcG9zZSgpLG4uX3JlY3ljbGVkTGluZXMucHVzaChhKSxuLl9yZWN5Y2xlZExpbmVzLnB1c2gocyksZGVsZXRlIG4uX2xpbmVzW3JdKTpuLl9saW5lc1tyXT1zfX0pfX0sX3JlY3ljbGVMaW5lSWZJbkNoYW5nZUZyYW1lOnt2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBpPWUubnVtYmVyKCk7cmV0dXJuIGk+PXQuc3RhcnQmJmk8PXQuZW5kPyhlLmRpc3Bvc2UoKSx0aGlzLl9yZWN5Y2xlZExpbmVzLnB1c2goZSksITApOnZvaWQgMH19fSksZX0oKTt0LmV4cG9ydHM9YX0seyIuL2RvY3VtZW50TGluZSI6Nn1dLDY6W2Z1bmN0aW9uKGUsdCxpKXsidXNlIHN0cmljdCI7dmFyIG49ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsdCl7Zm9yKHZhciBpIGluIHQpe3ZhciBuPXRbaV07bi5jb25maWd1cmFibGU9ITAsbi52YWx1ZSYmKG4ud3JpdGFibGU9ITApfU9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGUsdCl9cmV0dXJuIGZ1bmN0aW9uKHQsaSxuKXtyZXR1cm4gaSYmZSh0LnByb3RvdHlwZSxpKSxuJiZlKHQsbiksdH19KCkscz1mdW5jdGlvbihlLHQpe2lmKCEoZSBpbnN0YW5jZW9mIHQpKXRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpfSxyPWUoIi4uL3NoYXJlZC9lbnVtcyIpLmxpbmVTdGF0ZSxhPTEyOCxvPTEyOCxsPTAsdT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCl7cyh0aGlzLGUpLHRoaXMuX2xpbmVOdW1iZXI9dCx0aGlzLl9yYW5nZXM9T2JqZWN0LmNyZWF0ZShudWxsKSx0aGlzLl9pZD0rK2x9cmV0dXJuIG4oZSx7aGFzUmFuZ2VzOnt2YWx1ZTpmdW5jdGlvbigpe3JldHVybiFfLmlzRW1wdHkodGhpcy5fcmFuZ2VzKX19LHJhbmdlczp7dmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcmFuZ2VzfX0sdXBkYXRlTGluZURhdGE6e3ZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcyx0PSEwLGk9ITAsbj0hMSxzPSExLGw9dGhpcy5fbGluZVN0YXRlLHU9dGhpcy5fY29uc29sZUxvZ1RleHQsYz10aGlzLl9lcnJvclNvdXJjZVRleHQ7cmV0dXJuIGRlbGV0ZSB0aGlzLl9jb25zb2xlTG9nVGV4dCxkZWxldGUgdGhpcy5fZXJyb3JTb3VyY2VUZXh0LF8uZWFjaCh0aGlzLl9yYW5nZXMsZnVuY3Rpb24ocil7dmFyIGw9ci5jb25zb2xlTG9nKCk7aWYobCYmKGUuX2NvbnNvbGVMb2dUZXh0PWUuX2lubGluZU1lc3NhZ2UobCxhKSksci5pc0Vycm9yU291cmNlKCkpe249ITA7dmFyIHU9ci5lcnJvcnMoKTtpZih1Lmxlbmd0aCl7dmFyIGM9dVswXS5tZXNzYWdlKCk7ZS5fZXJyb3JTb3VyY2VUZXh0PWUuX2lubGluZU1lc3NhZ2UoY3x8IiIsbyl9fXIuaXNPbkVycm9yUGF0aCgpJiYocz0hMCksci5pc0NvdmVyZWQoKT9pPSExOnQ9ITF9KSx0aGlzLl9saW5lU3RhdGU9bj9yLmVycm9yU291cmNlOnM/ci5lcnJvclBhdGg6aT9yLm5vdENvdmVyZWQ6dD9yLmZ1bGx5Q292ZXJlZDpyLnBhcnRpYWxseUNvdmVyZWQsdGhpcy5fbGluZVN0YXRlIT09bHx8dGhpcy5fY29uc29sZUxvZ1RleHQhPT11fHx0aGlzLl9lcnJvclNvdXJjZVRleHQhPT1jfX0sY29uc29sZUxvZ1RleHQ6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NvbnNvbGVMb2dUZXh0fX0sZXJyb3JTb3VyY2VUZXh0Ont2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9lcnJvclNvdXJjZVRleHR9fSxzdGF0ZTp7dmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbGluZVN0YXRlfX0sYWRkUmFuZ2U6e3ZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIGk9ZS5rZXkoKTt0fHxkZWxldGUgdGhpcy5fcmFuZ2VzW2ldLHRoaXMuX3Jhbmdlc1tpXT1lfX0scmVtb3ZlUmFuZ2VzOnt2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX3Jhbmdlcz1PYmplY3QuY3JlYXRlKG51bGwpfX0sbnVtYmVyOnt2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLGk9dGhpcyxuPXRoaXMuX2xpbmVOdW1iZXI7cmV0dXJuIF8uaXNVbmRlZmluZWQoZSk/bjp2b2lkKGUhPT1uJiYhZnVuY3Rpb24oKXt0Ll9saW5lTnVtYmVyPWU7dmFyIHM9ZS1uLHI9Xy52YWx1ZXModC5fcmFuZ2VzKTt0LnJlbW92ZVJhbmdlcygpLF8uZWFjaChyLGZ1bmN0aW9uKGUpe2UubGluZVNoaWZ0KHMpLGkuX3Jhbmdlc1tlLmtleSgpXT1lfSl9KCkpfX0sZGlzcG9zZTp7dmFsdWU6ZnVuY3Rpb24oKXt0aGlzLnJlbW92ZVJhbmdlcygpLGRlbGV0ZSB0aGlzLl9jb25zb2xlTG9nVGV4dCxkZWxldGUgdGhpcy5fZXJyb3JTb3VyY2VUZXh0LGRlbGV0ZSB0aGlzLl9saW5lU3RhdGUsdGhpcy5faXNEaXNwb3NlZD0hMH19LGlzRGlzcG9zZWQ6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzRGlzcG9zZWR9fSxrZXk6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lkfX0sX2lubGluZU1lc3NhZ2U6e3ZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIGk9ZS5sZW5ndGg+dD8iLi4uIjoiIjtyZXR1cm4gZS5zdWJzdHIoMCx0KS5yZXBsYWNlKC9cclxuXHMqL2csIiAiKS5yZXBsYWNlKC9cblxzKi9nLCIgIikraX19fSksZX0oKTt0LmV4cG9ydHM9dX0seyIuLi9zaGFyZWQvZW51bXMiOjE0fV0sNzpbZnVuY3Rpb24oZSx0LGkpeyJ1c2Ugc3RyaWN0Ijt2YXIgbj1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0KXtmb3IodmFyIGkgaW4gdCl7dmFyIG49dFtpXTtuLmNvbmZpZ3VyYWJsZT0hMCxuLnZhbHVlJiYobi53cml0YWJsZT0hMCl9T2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSx0KX1yZXR1cm4gZnVuY3Rpb24odCxpLG4pe3JldHVybiBpJiZlKHQucHJvdG90eXBlLGkpLG4mJmUodCxuKSx0fX0oKSxzPWZ1bmN0aW9uKGUsdCl7aWYoIShlIGluc3RhbmNlb2YgdCkpdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIil9LHI9ZSgiLi9zdGFja0VudHJ5IiksYT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCl7cyh0aGlzLGUpLHRoaXMuX2FjdHVhbD10LmFjdHVhbCx0aGlzLl9leHBlY3RlZD10LmV4cGVjdGVkLHRoaXMuX21lc3NhZ2U9dC5tZXNzYWdlLHRoaXMuX3N0YWNrPXQuc3RhY2t9cmV0dXJuIG4oZSx7aW5pdDp7dmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9dGhpcy5fc3RhY2s7dGhpcy5fc3RhY2s9W10sXy5lYWNoKHQsZnVuY3Rpb24odCl7cmV0dXJuIGUuX3N0YWNrLnB1c2gobmV3IHIodFswXSx0WzFdKSl9KX19LHN0YWNrOnt2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zdGFja319LG1lc3NhZ2U6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX21lc3NhZ2V9fSxhY3R1YWw6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2FjdHVhbH19LGV4cGVjdGVkOnt2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9leHBlY3RlZH19LGtleTp7dmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5fbWVzc2FnZXx8IiIpK18ucmVkdWNlKHRoaXMuX3N0YWNrLGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUrPXQua2V5KCl9LCIiKX19fSksZX0oKTt0LmV4cG9ydHM9YX0seyIuL3N0YWNrRW50cnkiOjEyfV0sODpbZnVuY3Rpb24oZSx0LGkpeyJ1c2Ugc3RyaWN0Ijt2YXIgbj1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0KXtmb3IodmFyIGkgaW4gdCl7dmFyIG49dFtpXTtuLmNvbmZpZ3VyYWJsZT0hMCxuLnZhbHVlJiYobi53cml0YWJsZT0hMCl9T2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSx0KX1yZXR1cm4gZnVuY3Rpb24odCxpLG4pe3JldHVybiBpJiZlKHQucHJvdG90eXBlLGkpLG4mJmUodCxuKSx0fX0oKSxzPWZ1bmN0aW9uKGUsdCl7aWYoIShlIGluc3RhbmNlb2YgdCkpdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIil9LHI9ZSgiLi9lcnJvckVudHJ5IiksYT0oZSgiLi9zdGFja0VudHJ5IiksZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe3ModGhpcyxlKSx0aGlzLl9pZD10LmlkLHRoaXMuX2ZpbGVJZD10LmZpbGVJZCx0aGlzLl9sb2c9dC5sb2csdGhpcy5fbmFtZT10Lm5hbWUsdGhpcy5fdGVzdHM9dC50ZXN0cyx0aGlzLl9zdGFydD10LnN0YXJ0LHRoaXMuX3RpbWU9dC50aW1lLHRoaXMuX3Nsb3c9dC5zbG93fXJldHVybiBuKGUse2luaXQ6e3ZhbHVlOmZ1bmN0aW9uKHQsaSxuLHMpe3ZhciBhPXRoaXM7aWYodGhpcy5fcGFyZW50PXQsdGhpcy5faWQmJih0aGlzLl9idWlsZEZ1bGxOYW1lQW5kUGF0aCgpLHRoaXMuX3NldEtleSgpLG4odGhpcyksdGhpcy5fY292ZXJlZFJhbmdlcz1PYmplY3QuY3JlYXRlKG51bGwpLHRoaXMuX2NvdmVyZWRGaWxlcz1PYmplY3QuY3JlYXRlKG51bGwpLHRoaXMuX3RzPWksdGhpcy5fbG9nJiZ0aGlzLl9sb2cubGVuZ3RoKSl7dGhpcy5faXNGYWlsaW5nPSEwO3ZhciBvPXRoaXMuX2xvZzt0aGlzLl9sb2c9W10sdGhpcy5fZXJyb3JTdGFja01hcD1PYmplY3QuY3JlYXRlKG51bGwpLF8uZWFjaChvLGZ1bmN0aW9uKGUpe3ZhciB0PW5ldyByKGUpOwp0LmluaXQoKSxfLmVhY2godC5zdGFjaygpLGZ1bmN0aW9uKGUpe3ZhciBpPWUua2V5KCksbj1hLl9lcnJvclN0YWNrTWFwW2ldO24/fl8uaW5kZXhPZihuLHQpfHxuLnB1c2godCk6KG49W10sbi5wdXNoKHQpLGEuX2Vycm9yU3RhY2tNYXBbaV09biksbi5zdGFja0VudHJ5PWUscyhlKX0pLGEuX2xvZy5wdXNoKHQpfSl9dGhpcy5fdGVzdHMmJihfLmVhY2godGhpcy5fdGVzdHMsZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpLmluaXQoYSxpLG4scyl9KSxkZWxldGUgdGhpcy5fdGVzdHMpfX0saWQ6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lkfX0sa2V5Ont2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9rZXl8fCh0aGlzLl9zZXRLZXkoKSx0aGlzLl9rZXkpfX0sX3NldEtleTp7dmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9rZXk9dGhpcy5fZmlsZUlkKyJfIit0aGlzLl9mdWxsTmFtZX19LGZpbGVJZDp7dmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZmlsZUlkfX0sZmlsZVBhdGg6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Rlc3RGaWxlJiZ0aGlzLl90ZXN0RmlsZS5wYXRoKCl9fSx0aW1lOnt2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl90aW1lfX0sZXJyb3JzOnt2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9sb2d9fSxhZGRDb25zb2xlTWVzc2FnZTp7dmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fY29uc29sZU1lc3NhZ2VzfHwodGhpcy5fY29uc29sZU1lc3NhZ2VzPVtdKSx0aGlzLl9jb25zb2xlTWVzc2FnZXMucHVzaChlKX19LGNvbnNvbGVNZXNzYWdlczp7dmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY29uc29sZU1lc3NhZ2VzfX0saXNGYWlsaW5nOnt2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0ZhaWxpbmd9fSxzbG93Ont2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zbG93fX0sc2V0VGVzdEZpbGU6e3ZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX3Rlc3RGaWxlPWV9fSxvYnNvbGV0ZTp7dmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9T2JqZWN0LmNyZWF0ZShudWxsKTtyZXR1cm4gZGVsZXRlIHRoaXMuX3N0YXJ0UmFuZ2UsZGVsZXRlIHRoaXMuX3Rlc3RGaWxlLHRoaXMuX2NvdmVyZWRSYW5nZXMmJihfLmVhY2godGhpcy5fY292ZXJlZFJhbmdlcyxmdW5jdGlvbihpKXtpZihpLm5vdENvdmVyZWRCeShlKSwhaS5pc0Rpc3Bvc2VkKCkpe3ZhciBuPWkuc291cmNlRmlsZSgpO3Rbbi5rZXkoKV09bn19KSxkZWxldGUgdGhpcy5fY292ZXJlZFJhbmdlcyksZGVsZXRlIHRoaXMuX2Vycm9yU3RhY2tNYXAsZGVsZXRlIHRoaXMuX2NvbnNvbGVNZXNzYWdlcyxkZWxldGUgdGhpcy5fY292ZXJlZEZpbGVzLHR9fSxjb3ZlcnM6e3ZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX2NvdmVyZWRSYW5nZXNbZS5rZXkoKV09ZTt2YXIgdD1lLnNvdXJjZUZpbGUoKTt0JiYhdC5pc1Rlc3RGaWxlKCkmJih0aGlzLl9jb3ZlcmVkRmlsZXNbdC5rZXkoKV09dCl9fSxjb3ZlcmVkRmlsZXM6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIF8ubWFwKHRoaXMuX2NvdmVyZWRGaWxlcyxmdW5jdGlvbihlKXtyZXR1cm4gZX0pfX0sc3RhcnRSYW5nZTp7dmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc3RhcnRSYW5nZX19LGNvbXBsZXRlSW5pdGlhbGl6YXRpb246e3ZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7dGhpcy5fZXJyb3JTdGFja01hcCYmXy5lYWNoKHRoaXMuX2Vycm9yU3RhY2tNYXAsZnVuY3Rpb24oaSl7dmFyIG49aS5zdGFja0VudHJ5O2lmKG4pe3ZhciBzPWVbbi5maWxlSWQoKV07aWYocyl7dmFyIHI9cy5jbG9zZXN0UmFuZ2Uobi5saW5lKCkpO3ImJihuLnNldFJhbmdlKHIpLHIuZmFpbHNUZXN0KHQsaSkpfX19KSx0aGlzLl9jb25zb2xlTWVzc2FnZXMmJl8uZWFjaCh0aGlzLl9jb25zb2xlTWVzc2FnZXMsZnVuY3Rpb24oZSl7dmFyIHQ9ZS5maWxlKCk7dCYmZS5zZXRSYW5nZSh0LmNsb3Nlc3RSYW5nZShlLmxpbmUoKSkpfSksdGhpcy5fY292ZXJlZFJhbmdlcyYmKF8uaXNVbmRlZmluZWQodGhpcy5fc3RhcnQpfHwodGhpcy5fc3RhcnRSYW5nZT10aGlzLl90ZXN0RmlsZS5jbG9zZXN0UmFuZ2UodGhpcy5fc3RhcnQpLGRlbGV0ZSB0aGlzLl9zdGFydCksdGhpcy5fc3RhcnRSYW5nZXx8Xy5lYWNoKHRoaXMuX2NvdmVyZWRSYW5nZXMsZnVuY3Rpb24oZSl7dmFyIGk9ZS5zb3VyY2VGaWxlKCk7aT09dC5fdGVzdEZpbGUmJih0Ll9zdGFydFJhbmdlP2UuZW5kTGluZSgpPHQuX3N0YXJ0UmFuZ2UuZW5kTGluZSgpJiYodC5fc3RhcnRSYW5nZT1lKTp0Ll9zdGFydFJhbmdlPWUpfSkpfX0scGF0aDp7dmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcGF0aH19LHRzOnt2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl90c319LF9idWlsZEZ1bGxOYW1lQW5kUGF0aDp7dmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT1bXTtlLnB1c2godGhpcy5fbmFtZSk7Zm9yKHZhciB0PXRoaXMuX3BhcmVudDtudWxsIT10Oyl7dmFyIGk9dC5fbmFtZTtlLnB1c2goaSksdD10Ll9wYXJlbnR9ZS5yZXZlcnNlKCksdGhpcy5fZnVsbE5hbWU9ZS5qb2luKCLimIYiKSx0aGlzLl9wYXRoPWV9fX0pLGV9KCkpO3QuZXhwb3J0cz1hfSx7Ii4vZXJyb3JFbnRyeSI6NywiLi9zdGFja0VudHJ5IjoxMn1dLDk6W2Z1bmN0aW9uKGUsdCxpKXsidXNlIHN0cmljdCI7dmFyIG49ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsdCl7Zm9yKHZhciBpIGluIHQpe3ZhciBuPXRbaV07bi5jb25maWd1cmFibGU9ITAsbi52YWx1ZSYmKG4ud3JpdGFibGU9ITApfU9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGUsdCl9cmV0dXJuIGZ1bmN0aW9uKHQsaSxuKXtyZXR1cm4gaSYmZSh0LnByb3RvdHlwZSxpKSxuJiZlKHQsbiksdH19KCkscz1mdW5jdGlvbiBtKGUsdCxpKXt2YXIgbj1PYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsdCk7aWYodm9pZCAwPT09bil7dmFyIHM9T2JqZWN0LmdldFByb3RvdHlwZU9mKGUpO3JldHVybiBudWxsPT09cz92b2lkIDA6bShzLHQsaSl9aWYoInZhbHVlImluIG4mJm4ud3JpdGFibGUpcmV0dXJuIG4udmFsdWU7dmFyIHI9bi5nZXQ7aWYodm9pZCAwIT09cilyZXR1cm4gci5jYWxsKGkpfSxyPWZ1bmN0aW9uKGUsdCl7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIHQmJm51bGwhPT10KXRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgIit0eXBlb2YgdCk7ZS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZSh0JiZ0LnByb3RvdHlwZSx7Y29uc3RydWN0b3I6e3ZhbHVlOmUsZW51bWVyYWJsZTohMSx3cml0YWJsZTohMCxjb25maWd1cmFibGU6ITB9fSksdCYmKGUuX19wcm90b19fPXQpfSxhPWZ1bmN0aW9uKGUsdCl7aWYoIShlIGluc3RhbmNlb2YgdCkpdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIil9LG89ZSgicGF0aCIpLGw9ZSgiY2hva2lkYXIiKS5GU1dhdGNoZXIsdT1lKCJtaW5pbWF0Y2giKSxjPWUoIi4uL3NoYXJlZC91dGlscyIpLGg9dm9pZCAwLGQ9MWUzLGY9NTAwLHY9NTAscD17YXBrOjEsYm1wOjEsY2dtOjEsZzM6MSxnaWY6MSxpZWY6MSxpcng6MSxqcGVnOjEsanBnOjEsanBlOjEsa3R4OjEscG5nOjEsYnRpZjoxLHNnaToxLHN2ZzoxLHN2Z3o6MSx0aWZmOjEsdGlmOjEscHNkOjEsdXZpOjEsdXZ2aToxLHV2ZzoxLHV2dmc6MSxkanZ1OjEsZGp2OjEsc3ViOjEsZHdnOjEsZHhmOjEsZmJzOjEsZnB4OjEsZnN0OjEsbW1yOjEscmxjOjEsbWRpOjEsd2RwOjEsbnB4OjEsd2JtcDoxLHhpZjoxLHdlYnA6MSwiM2RzIjoxLHJhczoxLGNteDoxLGZoOjEsZmhjOjEsZmg0OjEsZmg1OjEsZmg3OjEsaWNvOjEsc2lkOjEscGN4OjEscGljOjEscGN0OjEscG5tOjEscGJtOjEscGdtOjEscHBtOjEscmdiOjEsdGdhOjEseGJtOjEseHBtOjEseHdkOjEsYmluOjEseGxzOjEseGxzeDoxLHppcDoxLG1wNDoxLG1vOjEsbm9kZToxLGR1bXA6MSxkbGw6MSxtYXA6MSxsaWI6MSxleHA6MSxvYmo6MSxwZGI6MX0sZz1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKHQsbil7YSh0aGlzLGkpLHMoT2JqZWN0LmdldFByb3RvdHlwZU9mKGkucHJvdG90eXBlKSwiY29uc3RydWN0b3IiLHRoaXMpLmNhbGwodGhpcyksdGhpcy5fZGlmZk1hdGNoUGF0Y2g9bi5kaWZmTWF0Y2hQYXRjaCx0aGlzLl9iYXNlRGlyPXQsdGhpcy5faXNSZWFkeT0hMSx0aGlzLl9pc1N0b3BwZWQ9ITEsdGhpcy5fZmlsZXNCeVBhdGg9T2JqZWN0LmNyZWF0ZShudWxsKSx0aGlzLl9maWxlc0J5SWQ9T2JqZWN0LmNyZWF0ZShudWxsKSx0aGlzLl9maWxlSWQ9MCx0aGlzLl9scnVDYWNoZT1lKCJscnUtY2FjaGUiKSh7bWF4OjEwNDg1NzYqdixsZW5ndGg6ZnVuY3Rpb24oZSl7cmV0dXJuIGUubGVuZ3RofX0pLHRoaXMuX3JlYWRGaWxlUHJvbWlzZT1uLnJlYWRGaWxlUHJvbWlzZSx0aGlzLl9yZWFscGF0aFN5bmM9bi5yZWFscGF0aFN5bmN9cmV0dXJuIHIoaSx0KSxuKGkse3NldHVwOnt2YWx1ZTpmdW5jdGlvbih0KXt2YXIgaT10aGlzO2g9ZSgiZGVidWciKSgid2FsbGFieTpmcyIpO3ZhciBuPVtdLHM9W10scj17fSxhPTA7Xy5lYWNoKHQsZnVuY3Rpb24oZSl7ZS5pZ25vcmU/cy5wdXNoKGUpOihuLnB1c2goZSksZS5vcmRlcj0rK2EpfSk7dmFyIHU9dGhpcy5faXNJbmNsdWRlZChpLl9iYXNlRGlyLG4scyxyKSxjPXtpZ25vcmVJbml0aWFsOiExLGlnbm9yZVBlcm1pc3Npb25FcnJvcnM6ITAsdXNlUG9sbGluZzoiZGFyd2luIj09PXByb2Nlc3MucGxhdGZvcm18fCJsaW51eCI9PT1wcm9jZXNzLnBsYXRmb3JtLGlnbm9yZWQ6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdCYmIXQuaXNEaXJlY3RvcnkoKSYmIXUoZSx0KX0sY3dkOmkuX2Jhc2VEaXJ9O2lmKH5pLl9iYXNlRGlyLmluZGV4T2YoIigiKXx8fmkuX2Jhc2VEaXIuaW5kZXhPZigiKSIpfHx+aS5fYmFzZURpci5pbmRleE9mKCJ8Iil8fH5pLl9iYXNlRGlyLmluZGV4T2YoInsiKXx8fmkuX2Jhc2VEaXIuaW5kZXhPZigifSIpfHx+aS5fYmFzZURpci5pbmRleE9mKCIqIil8fH5pLl9iYXNlRGlyLmluZGV4T2YoIlsiKXx8fmkuX2Jhc2VEaXIuaW5kZXhPZigiXSIpKXRocm93IG5ldyBFcnJvcigiWW91ciBwcm9qZWN0IGZpbGUgcGF0aCBjb250YWlucyBnbG9iIGNoYXJhY3RlcnMsIGxpa2UgYHtgLCBgfWAsIGBbYCwgYF1gLCBgKGAsIGApYCwgYCpgLCBgfGAgYW5kIGl0IG1heSBjYXVzZSB0aGUgcHJvamVjdCBmaWxlIHNjYW5uaW5nIHRvIGZhaWwsIHBsZWFzZSByZW1vdmUgZ2xvYiBjaGFyYWN0ZXJzIGZyb20gdGhlIHByb2plY3QgcGF0aC4iKTt0aGlzLl93YXRjaGVyPW5ldyBsKGMpO3ZhciB2PV8ucmVkdWNlKG4sZnVuY3Rpb24oZSx0KXt2YXIgbj1pLl9nZXRCYXNlRGlyKHQucGF0dGVybik7cmV0dXJuIGVbbl09bixlfSx7fSk7Xy5lYWNoKHYsZnVuY3Rpb24oZSl7aWYoIV8uZmluZCh2LGZ1bmN0aW9uKHQpe3JldHVybiB0IT09ZSYmZS5zdWJzdHIoMCx0Lmxlbmd0aCsxKT09PXQrIi8ifSkpe3ZhciB0PXZvaWQgMCxuPW8ubm9ybWFsaXplKG8uam9pbihpLl9iYXNlRGlyLGUpKTt0cnl7dD1vLm5vcm1hbGl6ZShpLl9yZWFscGF0aFN5bmMobikpfWNhdGNoKHMpe310JiZ0IT09bj8oaCgiUG9zc2libGUgc3ltbGluazogJXMgLT4gJXMiLHQsbiksclt0XT17cmVhbFBhdGg6dCxsaW5rZWRQYXRoOm59LGkuX3dhdGNoZXIuYWRkKHQpKTppLl93YXRjaGVyLmFkZChlKX19KTt2YXIgcD12b2lkIDA7cmV0dXJuIFEucHJvbWlzZShmdW5jdGlvbihlLHQpe3ZhciBuPWZ1bmN0aW9uKHQpe2kuX2lzUmVhZHl8fChpLl9pc1JlYWR5PSEwLHQmJmgoIkZpbGUgc3lzdGVtIHNjYW4gaGFzIGZpbmlzaGVkIGJ5IHRpbWVvdXQiKSxlKGkuX2ZpbGVzQnlQYXRoKSl9O3RyeXtpLl93YXRjaGVyLm9uKCJhbGwiLGZ1bmN0aW9uKCl7Y2xlYXJUaW1lb3V0KHApLHA9c2V0VGltZW91dChfLmJpbmQobixudWxsLCEwKSxkKX0pLm9uKCJhZGQiLF8uYmluZChpLl93aXRoTm9ybWFsaXplZFBhdGgsaSxpLl9maWxlQWRkZWQpKS5vbigiY2hhbmdlIixfLmJpbmQoaS5fd2l0aE5vcm1hbGl6ZWRQYXRoLGksaS5fZmlsZUNoYW5nZWQpKS5vbigidW5saW5rIixfLmJpbmQoaS5fd2l0aE5vcm1hbGl6ZWRQYXRoLGksaS5fZmlsZURlbGV0ZWQpKS5vbigicmVhZHkiLF8uZGVib3VuY2UobixmKSkub24oImVycm9yIixfLmJpbmQoaS5lbWl0LGksImVycm9yIikpfWNhdGNoKHMpe3Qocyl9fSl9fSxsb2FkRmlsZXM6e3ZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7cmV0dXJuIFEuYWxsKF8ubWFwKGUsZnVuY3Rpb24oZSl7cmV0dXJuIHQuX2xvYWRGaWxlKGUpLnRoZW4oZnVuY3Rpb24oZSl7cmV0dXJuIHQuZW1pdCgibG9hZGVkIixlKX0pfSkpfX0sZmlsZUNoYW5nZWRJbkVkaXRvcjp7dmFsdWU6ZnVuY3Rpb24oZSx0LGkpe3ZhciBuPXRoaXMuX2ZpbGVzQnlQYXRoW2VdO2lmKG4pe2goIkZpbGUgY2hhbmdlZCBpbiBlZGl0b3I6ICVzIixuLnBhdGgpO3ZhciBzPXRoaXMuX2xydUNhY2hlLmdldChuLnBhdGgpO3RoaXMuX2xydUNhY2hlLnNldChuLnBhdGgsdCksbi5jaGFuZ2VUcysrLHRoaXMuX2VtaXRGaWxlQ2hhbmdlKF8uZXh0ZW5kKHt9LG4se2NvbnRlbnQ6dH0pLHMsaSl9fX0sc3RvcDp7dmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9pc1N0b3BwZWQ9ITAsdGhpcy5fd2F0Y2hlciYmKHRoaXMuX3dhdGNoZXIuY2xvc2UoKSxkZWxldGUgdGhpcy5fbHJ1Q2FjaGUpfX0saWRCeVBhdGg6e3ZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX2ZpbGVzQnlQYXRoW2VdO2lmKHQpcmV0dXJuIHQuaWR9fSxfbG9hZEZpbGU6e3ZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX2ZpbGVzQnlJZFtlXTtpZighdCl0aHJvdyBuZXcgRXJyb3IoIk5vIGZpbGUgd2l0aCBpZCAiK2UrIiBmb3VuZCIpO3JldHVybiB0aGlzLl9sb2FkRmlsZVdpdGhDYWNoZSh0KX19LF9sb2FkRmlsZVdpdGhDYWNoZTp7dmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxpPWUuY2hhbmdlVHMsbj10aGlzLl9scnVDYWNoZS5nZXQoZS5wYXRoKTtyZXR1cm4oXy5pc1VuZGVmaW5lZChuKT90aGlzLl9yZWFkRmlsZVByb21pc2Uoby5qb2luKHQuX2Jhc2VEaXIsZS5wYXRoKSk6US53aGVuKG4pKS50aGVuKGZ1bmN0aW9uKG4pe3JldHVybiBuPW4/ZS5iaW5hcnk/bi50b1N0cmluZygiYmFzZTY0Iik6bi50b1N0cmluZygpOiIiLHQuX2lzU3RvcHBlZHx8aSE9PWUuY2hhbmdlVHN8fHQuX2xydUNhY2hlLnNldChlLnBhdGgsbiksUS53aGVuKF8uZXh0ZW5kKHt9LGUse2NvbnRlbnQ6bn0pKX0pLmZhaWwoZnVuY3Rpb24oZSl7cmV0dXJuIHQuZW1pdChlKX0pfX0sX2ZpbGVBZGRlZDp7dmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgaT10aGlzLG49dGhpcztoKCJGaWxlIGFkZGVkOiAlcyIsZSksdCYmdC5tZXRhZGF0YT8hZnVuY3Rpb24oKXt2YXIgcz10Lm1ldGFkYXRhLHI9by5leHRuYW1lKGUpLnN1YnN0cigxKTtzLmNoYW5nZVRzPTEscy5pZD0rK2kuX2ZpbGVJZCxzLnRzPXQubXRpbWUuZ2V0VGltZSgpLHMudHlwZT1yJiZyLnRvTG93ZXJDYXNlKCkscy5iaW5hcnk9cFtzLnR5cGVdLHMucGF0aD1lLGkuX2ZpbGVzQnlQYXRoW2VdPXMsaS5fZmlsZXNCeUlkW3MuaWRdPXMsaS5faXNSZWFkeSYmKGkuX2xydUNhY2hlLmRlbChlKSxpLl9sb2FkRmlsZVdpdGhDYWNoZShzKS50aGVuKGZ1bmN0aW9uKGUpe3JldHVybiBuLmVtaXQoImFkZGVkIixlKX0pKX0oKTpoKCJObyBtZXRhZGF0YSBmb3IgYWRkZWQgZmlsZSBmb3VuZDogJXMiLGUpfX0sX2ZpbGVDaGFuZ2VkOnt2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLGk9dGhpcztoKCJGaWxlIGNoYW5nZWQ6ICVzIixlKTt2YXIgbj10aGlzLl9maWxlc0J5UGF0aFtlXTtpZihuKXtpZih0aGlzLl9pc1JlYWR5KXt2YXIgczshZnVuY3Rpb24oKXt2YXIgcj10Ll9scnVDYWNoZS5nZXQoZSk7dC5fbHJ1Q2FjaGUuZGVsKGUpLHM9KytuLmNoYW5nZVRzLHQuX2xvYWRGaWxlV2l0aENhY2hlKG4pLnRoZW4oZnVuY3Rpb24oZSl7cmV0dXJuIGUuY2hhbmdlVHM9PT1zJiZpLl9lbWl0RmlsZUNoYW5nZShlLHIpfSl9KCl9fWVsc2UgaCgiTm8gbWV0YWRhdGEgZm9yIGNoYW5nZWQgZmlsZSBmb3VuZDogJXMiLGUpfX0sX2VtaXRGaWxlQ2hhbmdlOnt2YWx1ZTpmdW5jdGlvbihlLHQsaSl7dmFyIG49ZS5jb250ZW50O2lmKF8uaXNTdHJpbmcodCkpe3ZhciBzPXRoaXMuX2RpZmZNYXRjaFBhdGNoLnBhdGNoX21ha2UodCxuKTtpZighcy5sZW5ndGgpcmV0dXJuIGgoIk5vIGNoYW5nZXMgZGV0ZWN0ZWQgZm9yICVzIixlLnBhdGgpLHZvaWQgdGhpcy5lbWl0KCJub3RDaGFuZ2VkIixlLG4saSk7ZS5jb250ZW50PXRoaXMuX2RpZmZNYXRjaFBhdGNoLnBhdGNoX3RvVGV4dChzKX10aGlzLmVtaXQoImNoYW5nZWQiLGUsbixpKX19LF9maWxlRGVsZXRlZDp7dmFsdWU6ZnVuY3Rpb24oZSl7aCgiRmlsZSBkZWxldGVkOiAlcyIsZSksdGhpcy5fbHJ1Q2FjaGUuZGVsKGUpO3ZhciB0PXRoaXMuX2ZpbGVzQnlQYXRoW2VdO3Q/KGRlbGV0ZSB0aGlzLl9maWxlc0J5UGF0aFtlXSxkZWxldGUgdGhpcy5fZmlsZXNCeUlkW3QuaWRdLHRoaXMuX2lzUmVhZHkmJnRoaXMuZW1pdCgiZGVsZXRlZCIsdCkpOmgoIk5vIG1ldGFkYXRhIGZvciBkZWxldGVkIGZpbGUgZm91bmQ6ICVzIixlKX19LF93aXRoTm9ybWFsaXplZFBhdGg6e3ZhbHVlOmZ1bmN0aW9uKGUsdCxpKXtyZXR1cm4gaSYmaS5saW5rZWRQYXRoJiYodD1pLmxpbmtlZFBhdGgpLGUuY2FsbCh0aGlzLGMubm9ybWFsaXplUGF0aCh0KSxpKX19LF9pc0luY2x1ZGVkOnt2YWx1ZTpmdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gZnVuY3Rpb24ocyxyKXt2YXIgYT12b2lkIDAsbD12b2lkIDA7aWYoMD09PXMuaW5kZXhPZihlKSlzPW8ucmVsYXRpdmUoZSxzKTtlbHNle2goIlN5bWxpbmsgcmVzb2x1dGlvbiBmb3I6ICVzIixzKTt2YXIgYz1uW3NdO2lmKGMpcz1vLnJlbGF0aXZlKGUsYy5saW5rZWRQYXRoKTtlbHNle3ZhciBkPV8uZmluZChuLGZ1bmN0aW9uKGUsdCl7cmV0dXJuIDA9PT1zLmluZGV4T2YodCl9KTtpZighZClyZXR1cm4hMTtzPW8ucmVsYXRpdmUoZSxzLnJlcGxhY2UoZC5yZWFsUGF0aCxkLmxpbmtlZFBhdGgpKX1yJiYoci5saW5rZWRQYXRoPXMpfWZvcih2YXIgZj0wLHY9aS5sZW5ndGg7dj5mO2YrKyl7dmFyIHA9aVtmXSxnPXAudGVzdDtpZigoIWF8fGcpJiZ1KHMscC5wYXR0ZXJuKSl7aWYoZyl7bD1wO2JyZWFrfWE9cH19aWYoYSYmbClyZXR1cm4hMTt2YXIgbT1fLmNsb25lKF8uZmluZCh0LGZ1bmN0aW9uKGUpe3JldHVybighYSYmIWUudGVzdHx8IWwmJmUudGVzdCkmJnUocyxlLnBhdHRlcm4pfSkpO3JldHVybiByJiYoci5tZXRhZGF0YT1tKSwhIW19fX0sX2dldEJhc2VEaXI6e3ZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWMubm9ybWFsaXplUGF0aChlLnJlcGxhY2UoL1tcL1xcXVteXC9cXF0qXCouKiQvLCIiKS5yZXBsYWNlKC9bXC9cXF1bXlwvXFxdKltcIVwrXVwoLiokLywiIikucmVwbGFjZSgvW1wvXFxdW15cL1xcXSpcKVw/LiokLywiIil8fG8uc2VwKTtyZXR1cm4iKiI9PT10WzBdJiYiKiI9PT10WzFdJiYodD0iLi8iKSx0fX19KSxpfShFdmVudEVtaXR0ZXIpO3QuZXhwb3J0cz1nfSx7Ii4uL3NoYXJlZC91dGlscyI6MTUsY2hva2lkYXI6dm9pZCAwLGRlYnVnOnZvaWQgMCwibHJ1LWNhY2hlIjp2b2lkIDAsbWluaW1hdGNoOnZvaWQgMCxwYXRoOnZvaWQgMH1dLDEwOltmdW5jdGlvbihlLHQsaSl7InVzZSBzdHJpY3QiO3ZhciBuPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQpe2Zvcih2YXIgaSBpbiB0KXt2YXIgbj10W2ldO24uY29uZmlndXJhYmxlPSEwLG4udmFsdWUmJihuLndyaXRhYmxlPSEwKX1PYmplY3QuZGVmaW5lUHJvcGVydGllcyhlLHQpfXJldHVybiBmdW5jdGlvbih0LGksbil7cmV0dXJuIGkmJmUodC5wcm90b3R5cGUsaSksbiYmZSh0LG4pLHR9fSgpLHM9ZnVuY3Rpb24gdihlLHQsaSl7dmFyIG49T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLHQpO2lmKHZvaWQgMD09PW4pe3ZhciBzPU9iamVjdC5nZXRQcm90b3R5cGVPZihlKTtyZXR1cm4gbnVsbD09PXM/dm9pZCAwOnYocyx0LGkpfWlmKCJ2YWx1ZSJpbiBuJiZuLndyaXRhYmxlKXJldHVybiBuLnZhbHVlO3ZhciByPW4uZ2V0O2lmKHZvaWQgMCE9PXIpcmV0dXJuIHIuY2FsbChpKX0scj1mdW5jdGlvbihlLHQpe2lmKCJmdW5jdGlvbiIhPXR5cGVvZiB0JiZudWxsIT09dCl0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICIrdHlwZW9mIHQpO2UucHJvdG90eXBlPU9iamVjdC5jcmVhdGUodCYmdC5wcm90b3R5cGUse2NvbnN0cnVjdG9yOnt2YWx1ZTplLGVudW1lcmFibGU6ITEsd3JpdGFibGU6ITAsY29uZmlndXJhYmxlOiEwfX0pLHQmJihlLl9fcHJvdG9fXz10KX0sYT1mdW5jdGlvbihlLHQpe2lmKCEoZSBpbnN0YW5jZW9mIHQpKXRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpfSxvPShlKCJwYXRoIiksZSgiLi4vc2hhcmVkL3V0aWxzIikpLGw9ZSgiLi90cmFja2VkU291cmNlRmlsZSIpLHU9ZSgiLi9jb3ZlcmFibGVSYW5nZSIpLGM9ZSgiLi9leGVjdXRlZFRlc3QiKSxoPWUoIi4vY29uc29sZU1lc3NhZ2UiKSxkPWUoIi4vZXJyb3JFbnRyeSIpLGY9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdChlKXthKHRoaXMsdCkscyhPYmplY3QuZ2V0UHJvdG90eXBlT2YodC5wcm90b3R5cGUpLCJjb25zdHJ1Y3RvciIsdGhpcykuY2FsbCh0aGlzKTt2YXIgaT10aGlzO3RoaXMuX2ZpbGVJZEJ5UGF0aD1lLmZpbGVJZEJ5UGF0aCx0aGlzLl9hbHdheXNTZW5kQWxsTGluZXM9ZS5hbHdheXNTZW5kQWxsTGluZXMsdGhpcy5fZmlsZXM9T2JqZWN0LmNyZWF0ZShudWxsKSx0aGlzLl9udW1iZXJPZkFsbFJhbmdlcz0wLHRoaXMuX251bWJlck9mQ292ZXJlZFJhbmdlcz0wLHRoaXMuX2NvdmVyYWdlPXt2YWx1ZTowLGxvdzohMH0sdGhpcy5fdGVzdHM9T2JqZWN0LmNyZWF0ZShudWxsKSx0aGlzLl9mYWlsaW5nVGVzdHM9T2JqZWN0LmNyZWF0ZShudWxsKSx0aGlzLl9nbG9iYWxFcnJvcnM9T2JqZWN0LmNyZWF0ZShudWxsKSx0aGlzLl9jaGFuZ2VkPSEwLHRoaXMuX3Byb2plY3Q9ZS5wcm9qZWN0O3ZhciBuPWZ1bmN0aW9uKGUpe3ZhciB0PWlbInByb2plY3Q6IitlLnR5cGVdO3QmJnQuY2FsbChpLGUpfTt0aGlzLl9wcm9qZWN0Ll9tb2RlbD90aGlzLl9wcm9qZWN0Lm9uKCJtZXNzYWdlIixuKTp0aGlzLl9wcm9qZWN0Lm9uKCJtZXNzYWdlIixmdW5jdGlvbihlKXtyZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpe3JldHVybiBuKGUpfSwzMCl9KX1yZXR1cm4gcih0LGUpLG4odCx7Y29uZmlnRmlsZVBhdGg6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIG8ubm9ybWFsaXplUGF0aCh0aGlzLl9wcm9qZWN0LmNvbmZpZ0ZpbGVQYXRoKCkpfX0scHJvamVjdE5hbWU6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Byb2plY3QucHJvamVjdE5hbWUoKX19LHByb2plY3RDb25maWc6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Byb2plY3Quc2V0dGluZ3MoKX19LGxvd0NvdmVyYWdlVGhyZXNob2xkOnt2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wcm9qZWN0LnNldHRpbmdzKCkubG93Q292ZXJhZ2VUaHJlc2hvbGR9fSxjb3JlVmVyc2lvbjp7dmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcHJvamVjdC5jb3JlVmVyc2lvbigpfX0sZmlsZUJ5UGF0aDp7dmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5fZmlsZUlkQnlQYXRoKGUpO2lmKHQpcmV0dXJuIHRoaXMuX2ZpbGVzW3RdfX0sZmlsZUJ5SWQ6e3ZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9maWxlc1tlXX19LGZpbGVDb250ZW50QnlQYXRoOnt2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLmZpbGVCeVBhdGgoZSk7cmV0dXJuIHQmJnRoaXMuX3Byb2plY3QucmVhZFNvdXJjZUZpbGUodC5rZXkoKSl9fSx0ZXN0c0J5UmVxdWVzdDp7dmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9W107aWYoZS5maWxlKXt2YXIgaT10aGlzLmZpbGVCeVBhdGgoZS5maWxlKTtpJiYoZS5saW5lfHwhaS5pc1Rlc3RGaWxlKCk/Xy5lYWNoKGUubGluZT9pLmxpbmVUZXN0cyhlLmxpbmUpOmkuY292ZXJpbmdUZXN0cygpLGZ1bmN0aW9uKGUpe3QucHVzaChbZS5maWxlSWQoKV0uY29uY2F0KGUucGF0aCgpKSl9KTp0LnB1c2goW2kua2V5KCldKSl9cmV0dXJuIHR9fSx1bmNvdmVyZWRSZWdpb25zQnlSZXF1ZXN0Ont2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLmZpbGVCeVBhdGgoZS5maWxlKTtpZih0KXJldHVybiBfLmNoYWluKGUubGluZT90LmxpbmVSYW5nZXMoZS5saW5lKTp0LnJhbmdlcygpKS5maWx0ZXIoZnVuY3Rpb24oZSl7cmV0dXJuIWUuaXNDb3ZlcmVkKCl9KS5tYXAoZnVuY3Rpb24oZSl7cmV0dXJuW2Uuc3RhcnRMaW5lKCksZS5zdGFydENvbHVtbigpLGUuZW5kTGluZSgpLGUuZW5kQ29sdW1uKCldfSkudmFsdWUoKX19LGxpbmVSZXBvcnRCeVJlcXVlc3Q6e3ZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuZmlsZUJ5UGF0aChlLmZpbGUpO2lmKHQpcmV0dXJuIHRoaXMuX2xpbmVSZXBvcnQodCxlLmxpbmUpfX0sbG9jYXRpb25CeVJlcXVlc3Q6e3ZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuZmlsZUJ5UGF0aChlLmZpbGUpLGk9dCYmZS5saW5lJiZ0LmxpbmVDb3ZlcmluZ1Rlc3RzT3JkZXJlZEJ5RmFpbGluZ1RoZW5EYXRlKGUubGluZSxmdW5jdGlvbihlKXtyZXR1cm4gZS5pc0Vycm9yU291cmNlKCl8fGUuaXNPbkVycm9yUGF0aCgpfSlbMF07aWYoaSYmaS5pc0ZhaWxpbmcoKXx8KGk9dGhpcy5sYXRlc3RGYWlsaW5nVGVzdCgpKSxpKXtpZigiZmFpbGluZ1Rlc3QiPT09ZS50eXBlKXt2YXIgbj1pLnN0YXJ0UmFuZ2UoKTtyZXR1cm4gbj97ZmlsZTppLmZpbGVQYXRoKCksbG9jOltuLnN0YXJ0TGluZSgpLG4uc3RhcnRDb2x1bW4oKV19Ont9fWlmKCJlcnJvclNvdXJjZSI9PT1lLnR5cGUpe3ZhciBzPV8uZmluZChpLmVycm9ycygpLGZ1bmN0aW9uKGUpe3JldHVybiBlLnN0YWNrKCkubGVuZ3RofSkscj1zLnN0YWNrKClbMF0sYT1yLnJhbmdlKCksbz17fTtyZXR1cm4gby5maWxlPXIuZmlsZVBhdGgoKSxhJiYoby5sb2M9W2Euc3RhcnRMaW5lKCksYS5zdGFydENvbHVtbigpXSksb319fX0sbGF0ZXN0RmFpbGluZ1Rlc3Q6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIF8ubGFzdChfLnZhbHVlcyh0aGlzLl9mYWlsaW5nVGVzdHMpKX19LGZ1bGxUZXN0UmVzdWx0c1JlcG9ydDp7dmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcnVuRXJyb3J8fHt0b3RhbE51bWJlcjpfLnNpemUodGhpcy5fdGVzdHMpLGZhaWxpbmdOdW1iZXI6Xy5zaXplKHRoaXMuX2ZhaWxpbmdUZXN0cyksZXJyb3JzOnRoaXMuX21hcEVycm9ycyh0aGlzLl9nbG9iYWxFcnJvcnMpLHRlc3RzOnRoaXMuX21hcFRlc3RzKHRoaXMuX2ZhaWxpbmdUZXN0cykucmV2ZXJzZSgpLnZhbHVlKCl9fX0sYWxsVGVzdEZpbGVzOnt2YWx1ZTpmdW5jdGlvbigpe3JldHVybiBfLmZpbHRlcih0aGlzLl9maWxlcyxmdW5jdGlvbihlKXtyZXR1cm4gZS5pc1Rlc3RGaWxlKCl9KX19LHN1bW1hcnk6e3ZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9Xy5zaXplKHRoaXMuX3Rlc3RzKSx0PV8uc2l6ZSh0aGlzLl9mYWlsaW5nVGVzdHMpO3JldHVybnt0b3RhbDplLHBhc3NlZDplLXQsZmFpbGVkOnQsY292ZXJhZ2U6dGhpcy5fY292ZXJhZ2V9fX0sYWxsRmlsZXM6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIF8ubWFwKHRoaXMuX2ZpbGVzLGZ1bmN0aW9uKGUpe3JldHVybntwYXRoOmUucGF0aCgpLGlkOmUua2V5KCl9fSl9fSwicHJvamVjdDpzdGFydGluZyI6e3ZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7Xy5lYWNoKGUuZmlsZXMsZnVuY3Rpb24oZSl7cmV0dXJuIHQuX2FkZEZpbGUobmV3IGwoZSkpfSksdGhpcy5fZW1pdCgiYWxsRmlsZXMiLHtmaWxlczplLmZpbGVzfSl9fSwicHJvamVjdDpmaWxlIjp7dmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxpPWUuZmlsZSxuPWVbImRlbGV0ZSJdLHM9dGhpcy5maWxlQnlJZChpLmlkKTtzJiYhbiYmdGhpcy5fZW1pdCgiZmlsZUNoYW5nZWQiLHtmaWxlOml9KSxzfHxufHwocz1uZXcgbChpKSx0aGlzLl9hZGRGaWxlKHMpLHRoaXMuX2VtaXQoImZpbGVBZGRlZCIse2ZpbGU6aX0pKSxzJiZuJiYhZnVuY3Rpb24oKXt0Ll9kZWxldGVGaWxlKGkuaWQpO3ZhciBlPU9iamVjdC5jcmVhdGUobnVsbCksbj1zLm93blRlc3RzKCk7dC5fdGVzdHNSZW1vdmVkKG4pLF8uZWFjaChuLGZ1bmN0aW9uKHQpe3JldHVybiBfLmV4dGVuZChlLHQub2Jzb2xldGUoKSl9KSxkZWxldGUgZVtpLmlkXSxzLmlzVGVzdEZpbGUoKSYmdC5fZW1pdCgidGVzdEZpbGVEZWxldGVkIix7ZmlsZTppfSksdC5fZW1pdCgiZmlsZURlbGV0ZWQiLHtmaWxlOml9KSx0Ll91cGRhdGVBZmZlY3RlZEZpbGVzKGUpLHQuX2FnZ3JlZ2F0ZUZpbGVDb3ZlcmFnZShzLCEwKSx0Ll91cGRhdGVUb3RhbENvdmVyYWdlKCkscy5kaXNwb3NlKCl9KCl9fSwicHJvamVjdDp0ZXN0UnVuRXJyb3IiOnt2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9yZXBvcnRGYWlsZWRSdW4oZS5tZXNzYWdlKX19LCJwcm9qZWN0OnRlc3RSZXN1bHRzIjp7dmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxpPU9iamVjdC5jcmVhdGUobnVsbCksbj1PYmplY3QuY3JlYXRlKG51bGwpO3RoaXMuX3JlcG9ydE5vcm1hbFJ1bigpLF8uZWFjaChlLnRlc3RzLGZ1bmN0aW9uKG4pe3ZhciBzPW5ldyBjKG4pO3MuaW5pdChudWxsLGUudHMsZnVuY3Rpb24oZSl7aVtlLmlkKCldPWV9LGZ1bmN0aW9uKGUpe3JldHVybiBlLnNldEZpbGUodC5maWxlQnlJZChlLmZpbGVJZCgpKSl9KX0pLF8uZWFjaChlLmxvZyxmdW5jdGlvbihlKXt2YXIgbj1uZXcgaChlKSxzPW4udGVzdElkKCk7aWYoMCE9PXMpe3ZhciByPWlbc107ciYmci5hZGRDb25zb2xlTWVzc2FnZShuKX12YXIgYT1uLmZpbGVJZCgpO2lmKGEpe3ZhciBvPXQuZmlsZUJ5SWQoYSksbD1uLnJhbmdlKCk7byYmbCYmKG8uc2V0UmFuZ2VDb25zb2xlTG9nKG4udGV4dCgpLGwpLG4uc2V0RmlsZShvKSl9fSk7dmFyIHM9T2JqZWN0LmNyZWF0ZShudWxsKSxyPU9iamVjdC5jcmVhdGUobnVsbCksYT1fLm1hcChlLmZpbGVzLGZ1bmN0aW9uKGUpe3JldHVybntjb3ZlcmFnZTplLGZpbGU6dC5maWxlQnlJZChlLmlkKX19KSxvPV8uZmlsdGVyKGEsZnVuY3Rpb24oZSl7dmFyIHQ9ZS5maWxlLmlzVGVzdEZpbGUoKSxpPWUuY292ZXJhZ2UuY2hhbmdlZCYmIWUuY292ZXJhZ2Uuc2luZ2xlVGVzdENoYW5nZWQsbj10JiZpO3JldHVybiBuP3NbZS5maWxlLmtleSgpXT1lLmZpbGU6dCYmKHJbZS5maWxlLmtleSgpXT1lLmZpbGUpLG59KTtfLmVhY2gobyxmdW5jdGlvbihlKXt2YXIgaT1lLmZpbGU7dC5fdGVzdHNSZW1vdmVkKGkub3duVGVzdHMoKSksXy5lYWNoKGkucmVtb3ZlQWxsVGVzdHMoKSxmdW5jdGlvbihlKXtuW2Uua2V5KCldPWV9KX0pLF8uZWFjaChpLGZ1bmN0aW9uKGUpe3ZhciBpPXQuZmlsZUJ5SWQoZS5maWxlSWQoKSk7Xy5lYWNoKGkuYWRkVGVzdChlKSxmdW5jdGlvbihlKXtuW2Uua2V5KCldPWV9KSx0Ll90ZXN0QWRkZWQoZSl9KSxfLmVhY2goYSxmdW5jdGlvbihlKXt0Ll91cGRhdGVGaWxlUmFuZ2VzKGUsaSksbltlLmZpbGUua2V5KCldPWUuZmlsZX0pLF8uZWFjaChpLGZ1bmN0aW9uKGUpe3JldHVybiBlLmNvbXBsZXRlSW5pdGlhbGl6YXRpb24odC5fZmlsZXNCeUlkKCkpfSk7dmFyIGw9W107Xy5lYWNoKGUuZ2xvYmFsRXJyb3JzLGZ1bmN0aW9uKGUpe3ZhciBpPW5ldyBkKGUpO2kuaW5pdCgpLF8uZWFjaChpLnN0YWNrKCksZnVuY3Rpb24oZSl7dmFyIG49dC5maWxlQnlJZChlLmZpbGVJZCgpKTtpZihuKXtlLnNldEZpbGUobik7dmFyIHM9bi5jbG9zZXN0UmFuZ2UoZS5saW5lKCkpO251bGwhPXMmJihlLnNldFJhbmdlKHMpLHMuZmFpbHMoaSkpfX0pLGwucHVzaChpKX0pLHRoaXMuX3JlcG9ydEdsb2JhbEVycm9ycyhsKSx0aGlzLl91cGRhdGVBZmZlY3RlZEZpbGVzKG4pLHRoaXMuX2VtaXQoInRlc3RzRXhlY3V0ZWQiLHthbGxBZmZlY3RlZEZpbGVzOm4sY2hhbmdlZDpzLGV4ZWN1dGVkOnIsZnVsbFJ1bjplLmZ1bGxSdW59KX19LF9hZGRGaWxlOnt2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9maWxlc1tlLmtleSgpXT1lfX0sX2RlbGV0ZUZpbGU6e3ZhbHVlOmZ1bmN0aW9uKGUpe2RlbGV0ZSB0aGlzLl9maWxlc1tlXX19LF9saW5lUmVwb3J0Ont2YWx1ZTpmdW5jdGlvbihlLHQpe3JldHVybnt0ZXN0czp0aGlzLl9tYXBUZXN0cyhlLmxpbmVDb3ZlcmluZ1Rlc3RzT3JkZXJlZEJ5RmFpbGluZ1RoZW5EYXRlKHQpKX19fSxfcmVwb3J0RmFpbGVkUnVuOnt2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9jaGFuZ2VkPSEwLHRoaXMuX3J1bkVycm9yPWV9fSxfcmVwb3J0Tm9ybWFsUnVuOnt2YWx1ZTpmdW5jdGlvbigpe2RlbGV0ZSB0aGlzLl9ydW5FcnJvcn19LF9yZXBvcnRHbG9iYWxFcnJvcnM6e3ZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsaT1PYmplY3QuY3JlYXRlKG51bGwpO3RoaXMuX2NoYW5nZWQ9dGhpcy5fY2hhbmdlZHx8Xy5zaXplKHRoaXMuX2dsb2JhbEVycm9ycykhPT1lLmxlbmd0aCxfLmVhY2goZSxmdW5jdGlvbihlKXt2YXIgbj1lLmtleSgpO2RlbGV0ZSB0Ll9nbG9iYWxFcnJvcnNbbl0saVtuXT1lfSksdGhpcy5fY2hhbmdlZD10aGlzLl9jaGFuZ2VkfHwhXy5pc0VtcHR5KHRoaXMuX2dsb2JhbEVycm9ycyksdGhpcy5fZ2xvYmFsRXJyb3JzPWl9fSxfdGVzdHNSZW1vdmVkOnt2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO18uZWFjaChlLGZ1bmN0aW9uKGUpe3ZhciBpPWUua2V5KCksbj0hIXQuX2ZhaWxpbmdUZXN0c1tpXTtkZWxldGUgdC5fdGVzdHNbaV0sZGVsZXRlIHQuX2ZhaWxpbmdUZXN0c1tpXSx0Ll9jaGFuZ2VkPW58fHQuX2NoYW5nZWR9KX19LF90ZXN0QWRkZWQ6e3ZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUua2V5KCksaT10aGlzLl90ZXN0c1t0XTt0aGlzLl90ZXN0c1t0XT1lLGRlbGV0ZSB0aGlzLl9mYWlsaW5nVGVzdHNbdF0sZS5pc0ZhaWxpbmcoKSYmKHRoaXMuX2ZhaWxpbmdUZXN0c1t0XT1lKSx0aGlzLl9jaGFuZ2VkPSFpfHxpJiZpLmlzRmFpbGluZygpfHxlLmlzRmFpbGluZygpfHx0aGlzLl9jaGFuZ2VkfX0sX2ZpbGVzQnlJZDp7dmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZmlsZXN9fSxfdXBkYXRlQWZmZWN0ZWRGaWxlczp7dmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxpPU9iamVjdC5jcmVhdGUobnVsbCksbj1bXTtfLmVhY2goZSxmdW5jdGlvbihlKXt0Ll9hZ2dyZWdhdGVGaWxlQ292ZXJhZ2UoZSkmJm4ucHVzaChlKTt2YXIgcz1lLnVwZGF0ZURvY3VtZW50KCk7cyYmKGlbZS5wYXRoKCldPXQuX2Fsd2F5c1NlbmRBbGxMaW5lcz9lLmFsbExpbmVzKCk6cyl9KSxfLmlzRW1wdHkoaSl8fHRoaXMuX2VtaXQoImRvY3VtZW50c1VwZGF0ZWQiLHtkb2N1bWVudHM6aX0pO3ZhciBzPXRoaXMuX2NoYW5nZWQ7cyYmZGVsZXRlIHRoaXMuX2NoYW5nZWQsbi5sZW5ndGgmJnRoaXMuX3VwZGF0ZVRvdGFsQ292ZXJhZ2UoKSx0aGlzLl9lbWl0KCJzdGF0c01heWJlQ2hhbmdlZCIse3Rlc3RSZXN1bHRzQ2hhbmdlZDpzLGZpbGVzV2l0aENoYW5nZWRDb3ZlcmFnZTpufSl9fSxfYWdncmVnYXRlRmlsZUNvdmVyYWdlOnt2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBpPXRoaXM7aWYoIWUuaXNUZXN0RmlsZSgpJiZlLmluc3RydW1lbnRlZCgpKXt2YXIgbj10PzA6ZS5udW1iZXJPZkFsbFJhbmdlcygpLHM9dD8wOmUubnVtYmVyT2ZDb3ZlcmVkUmFuZ2VzKCkscj0wLGE9MDtpZihlLl92YWx1ZXNJbmNsdWRlZEluQ292ZXJhZ2VBZ2dyZWdhdGU/KHI9bi1lLl92YWx1ZXNJbmNsdWRlZEluQ292ZXJhZ2VBZ2dyZWdhdGUubnVtYmVyT2ZBbGxSYW5nZXMsYT1zLWUuX3ZhbHVlc0luY2x1ZGVkSW5Db3ZlcmFnZUFnZ3JlZ2F0ZS5udW1iZXJPZkNvdmVyZWRSYW5nZXMpOihyPW4sYT1zKSxlLl92YWx1ZXNJbmNsdWRlZEluQ292ZXJhZ2VBZ2dyZWdhdGU9e251bWJlck9mQWxsUmFuZ2VzOm4sbnVtYmVyT2ZDb3ZlcmVkUmFuZ2VzOnN9LGkuX251bWJlck9mQWxsUmFuZ2VzKz1yLGkuX251bWJlck9mQ292ZXJlZFJhbmdlcys9YSwwIT09cnx8MCE9PWEpcmV0dXJuITB9fX0sX3VwZGF0ZVRvdGFsQ292ZXJhZ2U6e3ZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9TWF0aC5yb3VuZCgxZTQqdGhpcy5fbnVtYmVyT2ZDb3ZlcmVkUmFuZ2VzL3RoaXMuX251bWJlck9mQWxsUmFuZ2VzKS8xMDB8fDA7dGhpcy5fY292ZXJhZ2U9e3ZhbHVlOmUsbG93OmU8dGhpcy5sb3dDb3ZlcmFnZVRocmVzaG9sZCgpfX19LF91cGRhdGVGaWxlUmFuZ2VzOnt2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBpPVtdLG49ZS5maWxlLHM9ZS5jb3ZlcmFnZTtfLmVhY2gocy5yYW5nZXMsZnVuY3Rpb24oZSl7dmFyIHM9bmV3IHUoZSk7cy5pbml0KG4sdCkscy5zZXRDb25zb2xlTG9nKG4ucmFuZ2VDb25zb2xlTG9nKHMpKSxpLnB1c2gocyl9KSxuLnNldFJhbmdlcyhpLHMuY2hhbmdlZCxlLmNvdmVyYWdlLnNpbmdsZVRlc3RDaGFuZ2VkKSxuLmNsZWFyUmFuZ2VDb25zb2xlTG9nKCl9fSxfbWFwVGVzdHM6e3ZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7cmV0dXJuIF8oZSkubWFwKGZ1bmN0aW9uKGUpe3JldHVybntmYWlsaW5nOmUuaXNGYWlsaW5nKCksbG9jOnQuX3JhbmdlVG9Mb2MoZS5zdGFydFJhbmdlKCkpLGZpbGU6ZS5maWxlUGF0aCgpLHRpbWU6ZS50aW1lKCksZXJyb3JzOnQuX21hcEVycm9ycyhlLmVycm9ycygpKSxwYXRoOmUucGF0aCgpLG1lc3NhZ2VzOl8ubWFwKGUuY29uc29sZU1lc3NhZ2VzKCksZnVuY3Rpb24oZSl7cmV0dXJue3R5cGU6ZS50eXBlKCksdGV4dDplLnRleHQoKSxmaWxlOmUuZmlsZSgpJiZlLmZpbGUoKS5wYXRoKCksbG9jOnQuX3JhbmdlVG9Mb2MoZS5yYW5nZSgpKXx8ZS5saW5lKCl9fSl9fSl9fSxfbWFwRXJyb3JzOnt2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO3JldHVybiBfLm1hcChlLGZ1bmN0aW9uKGUpe3JldHVybnttZXNzYWdlOmUubWVzc2FnZSgpLHN0YWNrOl8ubWFwKGUuc3RhY2soKSxmdW5jdGlvbihlKXtyZXR1cm57ZmlsZTplLmZpbGVQYXRoKCksbG9jOnQuX3JhbmdlVG9Mb2MoZS5yYW5nZSgpKXx8ZS5saW5lKCl9fSksZXhwZWN0ZWQ6ZS5leHBlY3RlZCgpLGFjdHVhbDplLmFjdHVhbCgpfX0pfX0sX3JhbmdlVG9Mb2M6e3ZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBlJiZlLnN0YXJ0TGluZSgpKyI6IitlLnN0YXJ0Q29sdW1uKCl8fHZvaWQgMH19LF9lbWl0Ont2YWx1ZTpmdW5jdGlvbihlLHQpe3RoaXMuZW1pdCgibWVzc2FnZSIsXy5leHRlbmQoe3R5cGU6ZX0sdCkpfX19KSx0fShFdmVudEVtaXR0ZXIpO3QuZXhwb3J0cz1mfSx7Ii4uL3NoYXJlZC91dGlscyI6MTUsIi4vY29uc29sZU1lc3NhZ2UiOjMsIi4vY292ZXJhYmxlUmFuZ2UiOjQsIi4vZXJyb3JFbnRyeSI6NywiLi9leGVjdXRlZFRlc3QiOjgsIi4vdHJhY2tlZFNvdXJjZUZpbGUiOjEzLHBhdGg6dm9pZCAwfV0sMTE6W2Z1bmN0aW9uKGUsdCxpKXsidXNlIHN0cmljdCI7dmFyIG49ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsdCl7Zm9yKHZhciBpIGluIHQpe3ZhciBuPXRbaV07bi5jb25maWd1cmFibGU9ITAsbi52YWx1ZSYmKG4ud3JpdGFibGU9ITApfU9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGUsdCl9cmV0dXJuIGZ1bmN0aW9uKHQsaSxuKXtyZXR1cm4gaSYmZSh0LnByb3RvdHlwZSxpKSxuJiZlKHQsbiksdH19KCkscz1mdW5jdGlvbihlLHQpe2lmKCEoZSBpbnN0YW5jZW9mIHQpKXRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpfSxyPWUoImRncmFtIiksYT1lKCJvcyIpLG89ZSgiLi8uLi8uLi91dGlscyIpLGw9by5yYW5kb21JZCgpLHU9aS5vcHRpb25zPXt0dGw6MTI4LGFkZHJlc3M6IjIzMC4wLjAuMyIscG9ydDo1NjM5OH0sYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXtzKHRoaXMsZSk7dHJ5e3ZhciB0PXRoaXM7dGhpcy5fbGlzdGVuZXJzPXt9LHRoaXMuX3NlbmRlcj1yLmNyZWF0ZVNvY2tldCgidWRwNCIpLHRoaXMuX3NlbmRlci5iaW5kKGZ1bmN0aW9uKCl7dC5fc2VuZGVyLnNldEJyb2FkY2FzdCghMCksdC5fc2VuZGVyLnNldE11bHRpY2FzdFRUTCh1LnR0bCl9KSx0aGlzLl9zZW5kZXIub24oImVycm9yIixmdW5jdGlvbigpe3RyeXt0Ll9zZW5kZXIuY2xvc2UoKX1jYXRjaChlKXt9fSksdGhpcy5fcmVjZWl2ZXI9ci5jcmVhdGVTb2NrZXQoInVkcDQiKSx0aGlzLl9yZWNlaXZlci5vbigibGlzdGVuaW5nIixmdW5jdGlvbigpe3RyeXt0Ll9yZWNlaXZlci5zZXRCcm9hZGNhc3QoITApLHQuX3JlY2VpdmVyLnNldE11bHRpY2FzdFRUTCh1LnR0bCksdC5fcmVjZWl2ZXIuYWRkTWVtYmVyc2hpcCh1LmFkZHJlc3MpfWNhdGNoKGUpe319KSx0aGlzLl9yZWNlaXZlci5vbigibWVzc2FnZSIsZnVuY3Rpb24oZSl7dHJ5e2U9SlNPTi5wYXJzZShlLnRvU3RyaW5nKCJ1dGY4IikpLGUuZXZlbnQmJmUuc291cmNlJiZlLnNvdXJjZUlkJiZlLnNvdXJjZSE9PXQuX3NvdXJjZSgpJiZlLnNvdXJjZUlkIT09bCYmXy5lYWNoKHQuX2xpc3RlbmVyc1tlLmV2ZW50XSxmdW5jdGlvbih0KXt0LmFwcGx5KG51bGwsW2UuZGF0YSxlLnNvdXJjZV0pfSl9Y2F0Y2goaSl7fX0pLHRoaXMuX3JlY2VpdmVyLm9uKCJlcnJvciIsZnVuY3Rpb24oKXt0cnl7dC5fcmVjZWl2ZXIuY2xvc2UoKX1jYXRjaChlKXt9fSksdGhpcy5fcmVjZWl2ZXIuYmluZCh1LnBvcnQpfWNhdGNoKGkpe319cmV0dXJuIG4oZSx7b246e3ZhbHVlOmZ1bmN0aW9uKGUsdCl7dGhpcy5fbGlzdGVuZXJzJiYodGhpcy5fbGlzdGVuZXJzW2VdfHwodGhpcy5fbGlzdGVuZXJzW2VdPVtdKSx0aGlzLl9saXN0ZW5lcnNbZV0ucHVzaCh0KSl9fSxlbWl0Ont2YWx1ZTpmdW5jdGlvbihlLHQpe3RyeXt2YXIgaT1uZXcgQnVmZmVyKEpTT04uc3RyaW5naWZ5KHtldmVudDplLGRhdGE6dCxzb3VyY2U6dGhpcy5fc291cmNlKCksc291cmNlSWQ6bH0pKTt0aGlzLl9zZW5kZXIuc2VuZChpLDAsaS5sZW5ndGgsdS5wb3J0LHUuYWRkcmVzcyl9Y2F0Y2gobil7fX19LF9zb3VyY2U6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIGEuaG9zdG5hbWUoKSsiICgiK2UuX2dldElQdjRBZGRyZXNzKCkrIikifX0sc3RvcDp7dmFsdWU6ZnVuY3Rpb24oKXt0cnl7dGhpcy5fc2VuZGVyLmNsb3NlKCl9Y2F0Y2goZSl7fXRyeXt0aGlzLl9yZWNlaXZlci5jbG9zZSgpfWNhdGNoKGUpe319fX0se19nZXRJUHY0QWRkcmVzczp7dmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT0iIjtyZXR1cm4gXy5lYWNoKGEubmV0d29ya0ludGVyZmFjZXMoKSxmdW5jdGlvbih0KXtpZighZSlmb3IodmFyIGk9MDtpPHQubGVuZ3RoO2krKyl7dmFyIG49dFtpXTtpZigiSVB2NCI9PT1uLmZhbWlseSYmIjEyNy4wLjAuMSIhPT1uLmFkZHJlc3MmJiFuLmludGVybmFsKXJldHVybiB2b2lkKGU9bi5hZGRyZXNzKX19KSxlfHwiMC4wLjAuMCJ9fX0pLGV9KCk7dC5leHBvcnRzPW5ldyBjfSx7Ii4vLi4vLi4vdXRpbHMiOjE3LGRncmFtOnZvaWQgMCxvczp2b2lkIDB9XSwxMjpbZnVuY3Rpb24oZSx0LGkpeyJ1c2Ugc3RyaWN0Ijt2YXIgbj1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0KXtmb3IodmFyIGkgaW4gdCl7dmFyIG49dFtpXTtuLmNvbmZpZ3VyYWJsZT0hMCxuLnZhbHVlJiYobi53cml0YWJsZT0hMCl9T2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSx0KX1yZXR1cm4gZnVuY3Rpb24odCxpLG4pe3JldHVybiBpJiZlKHQucHJvdG90eXBlLGkpLG4mJmUodCxuKSx0fX0oKSxzPWZ1bmN0aW9uKGUsdCl7aWYoIShlIGluc3RhbmNlb2YgdCkpdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIil9LHI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7aWYocyh0aGlzLGUpLGFyZ3VtZW50cy5sZW5ndGg+MSl0aGlzLl9maWxlSWQ9YXJndW1lbnRzWzBdLHRoaXMuX2xpbmU9YXJndW1lbnRzWzFdO2Vsc2UgaWYoYXJndW1lbnRzLmxlbmd0aCl7dmFyIHQ9YXJndW1lbnRzWzBdLnNwbGl0KCJfIik7dGhpcy5fZmlsZUlkPXBhcnNlSW50KHRbMF0sMTApLHRoaXMuX2xpbmU9cGFyc2VJbnQodFsxXSwxMCl9fXJldHVybiBuKGUse2tleTp7dmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZmlsZUlkKyJfIit0aGlzLl9saW5lfX0sZmlsZUlkOnt2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9maWxlSWR9fSxsaW5lOnt2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9saW5lfX0sc2V0RmlsZTp7dmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fZmlsZT1lfX0sZmlsZVBhdGg6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2ZpbGUmJnRoaXMuX2ZpbGUucGF0aCgpfX0sc2V0UmFuZ2U6e3ZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX3JhbmdlPWV9fSxyYW5nZTp7dmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcmFuZ2V9fX0pLGV9KCk7dC5leHBvcnRzPXJ9LHt9XSwxMzpbZnVuY3Rpb24oZSx0LGkpeyJ1c2Ugc3RyaWN0Ijt2YXIgbj1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0KXtmb3IodmFyIGkgaW4gdCl7dmFyIG49dFtpXTtuLmNvbmZpZ3VyYWJsZT0hMCxuLnZhbHVlJiYobi53cml0YWJsZT0hMCl9T2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSx0KX1yZXR1cm4gZnVuY3Rpb24odCxpLG4pe3JldHVybiBpJiZlKHQucHJvdG90eXBlLGkpLG4mJmUodCxuKSx0fX0oKSxzPWZ1bmN0aW9uKGUsdCl7aWYoIShlIGluc3RhbmNlb2YgdCkpdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIil9LHI9ZSgiLi9jb3ZlcmFibGVSYW5nZSIpLGE9ZSgiLi9kb2N1bWVudEluRWRpdG9yIiksbz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCl7cyh0aGlzLGUpLHRoaXMuX2RhdGE9dCx0aGlzLl9yYW5nZUNvbnNvbGVMb2c9T2JqZWN0LmNyZWF0ZShudWxsKSx0aGlzLl9yYW5nZXM9T2JqZWN0LmNyZWF0ZShudWxsKSx0aGlzLl9uZXdSYW5nZXM9T2JqZWN0LmNyZWF0ZShudWxsKSx0aGlzLl9hZmZlY3RlZFJhbmdlcz1PYmplY3QuY3JlYXRlKG51bGwpLHRoaXMuX291dGRhdGVkUmFuZ2VzPU9iamVjdC5jcmVhdGUobnVsbCksdGhpcy5fbGluZVRvUmFuZ2VNYXA9T2JqZWN0LmNyZWF0ZShudWxsKSx0aGlzLl90ZXN0TWFwPU9iamVjdC5jcmVhdGUobnVsbCksdGhpcy5fbnVtYmVyT2ZDb3ZlcmVkUmFuZ2VzPTB9cmV0dXJuIG4oZSx7c2V0UmFuZ2VDb25zb2xlTG9nOnt2YWx1ZTpmdW5jdGlvbihlLHQpe3RoaXMuX3JhbmdlQ29uc29sZUxvZ1tyLnJhbmdlS2V5KHQpXT1lfX0scmFuZ2VzOnt2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9yYW5nZXN9fSxpbnN0cnVtZW50ZWQ6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2RhdGEuY292ZXJhYmxlfX0sdXBkYXRlRG9jdW1lbnQ6e3ZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9Xy5leHRlbmQoe30sdGhpcy5fbmV3UmFuZ2VzLHRoaXMuX2FmZmVjdGVkUmFuZ2VzLHRoaXMuX291dGRhdGVkUmFuZ2VzKSx0PXRoaXMuX2FsbFJhbmdlc1JlY2VpdmVkLGk9dGhpcy5faW52YWxpZGF0ZURvY3VtZW50O2lmKGRlbGV0ZSB0aGlzLl9hbGxSYW5nZXNSZWNlaXZlZCxkZWxldGUgdGhpcy5faW52YWxpZGF0ZURvY3VtZW50LF8uZWFjaCh0aGlzLl9vdXRkYXRlZFJhbmdlcyxmdW5jdGlvbihlKXtyZXR1cm4gZS5kaXNwb3NlKCl9KSx0aGlzLl9uZXdSYW5nZXM9T2JqZWN0LmNyZWF0ZShudWxsKSx0aGlzLl9hZmZlY3RlZFJhbmdlcz1PYmplY3QuY3JlYXRlKG51bGwpLHRoaXMuX291dGRhdGVkUmFuZ2VzPU9iamVjdC5jcmVhdGUobnVsbCksdGhpcy5fZG9jdW1lbnRJbkVkaXRvcil7dmFyIG49aT90aGlzLl9kb2N1bWVudEluRWRpdG9yLnVwZGF0ZShfLnZhbHVlcyh0aGlzLl9yYW5nZXMpLCEwLCEwKTp0aGlzLl9kb2N1bWVudEluRWRpdG9yLnVwZGF0ZShlLHQsITEpO3JldHVybiBuLmZ1bGxVcGRhdGU9aSxufX19LGFsbExpbmVzOnt2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9kb2N1bWVudEluRWRpdG9yP3RoaXMuX2RvY3VtZW50SW5FZGl0b3IuYWxsTGluZXMoKTp2b2lkIDB9fSxvcGVuZWRJbkVkaXRvcjp7dmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9kb2N1bWVudEluRWRpdG9yfHwodGhpcy5fZG9jdW1lbnRJbkVkaXRvcj1uZXcgYSx0aGlzLl9kb2N1bWVudEluRWRpdG9yLnVwZGF0ZShfLnZhbHVlcyh0aGlzLl9yYW5nZXMpLCExLCEwKSl9fSxjbG9zZWRJbkFsbEVkaXRvcnM6e3ZhbHVlOmZ1bmN0aW9uKCl7ZGVsZXRlIHRoaXMuX2RvY3VtZW50SW5FZGl0b3J9fSxpc09wZW5lZEluRWRpdG9yOnt2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9kb2N1bWVudEluRWRpdG9yfX0sc2hpZnREb2N1bWVudExpbmVzOnt2YWx1ZTpmdW5jdGlvbihlLHQsaSl7dGhpcy5fZG9jdW1lbnRJbkVkaXRvciYmdGhpcy5fZG9jdW1lbnRJbkVkaXRvci5zaGlmdExpbmVzKGUsdCxpKX19LGludmFsaWRhdGVEb2N1bWVudExpbmVzOnt2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9kb2N1bWVudEluRWRpdG9yJiZ0aGlzLl9kb2N1bWVudEluRWRpdG9yLmludmFsaWRhdGVMaW5lcyhlKX19LGludmFsaWRhdGVEb2N1bWVudDp7dmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9kb2N1bWVudEluRWRpdG9yJiYodGhpcy5faW52YWxpZGF0ZURvY3VtZW50PSEwKX19LGhhc1ZhbGlkRG9jdW1lbnQ6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIXRoaXMuX2ludmFsaWRhdGVEb2N1bWVudH19LGxpbmVUZXN0czp7dmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2NvdmVyaW5nVGVzdHMoZSl9fSxsaW5lUmFuZ2VzOnt2YWx1ZTpmdW5jdGlvbihlKXtpZih0aGlzLl9kb2N1bWVudEluRWRpdG9yKXt2YXIgdD10aGlzLl9kb2N1bWVudEluRWRpdG9yLmxpbmUoZSk7aWYodClyZXR1cm4gdC5yYW5nZXMoKX19fSxjb3ZlcmluZ1Rlc3RzOnt2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9jb3ZlcmluZ1Rlc3RzKCl9fSxsaW5lQ292ZXJpbmdUZXN0c09yZGVyZWRCeUZhaWxpbmdUaGVuRGF0ZTp7dmFsdWU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gXy5jaGFpbih0aGlzLl9jb3ZlcmluZ1Rlc3RzKGUsdCkpLnNvcnRCeShmdW5jdGlvbihlKXtyZXR1cm4hZS5pc0ZhaWxpbmcoKX0pLnNvcnRCeShmdW5jdGlvbihlKXtyZXR1cm4tZS50cygpfSkudmFsdWUoKX19LF9jb3ZlcmluZ1Rlc3RzOnt2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBpPXZvaWQgMDtpZihlKXtpZighdGhpcy5fZG9jdW1lbnRJbkVkaXRvcilyZXR1cm5bXTtpZihpPXRoaXMuX2RvY3VtZW50SW5FZGl0b3IubGluZShlKSwhaSlyZXR1cm5bXX12YXIgbj1pP2kucmFuZ2VzKCk6dGhpcy5fcmFuZ2VzO3JldHVybiB0JiYobj1fLmZpbHRlcihuLHQpKSxfLnJlZHVjZShuLGZ1bmN0aW9uKGUsdCl7cmV0dXJuIF8uZWFjaCh0LmNvdmVyaW5nVGVzdHMoKSxmdW5jdGlvbih0KXtlW3Qua2V5KCldPXR9KSxlfSx7fSl9fSxkaXNwb3NlOnt2YWx1ZTpmdW5jdGlvbigpe2RlbGV0ZSB0aGlzLl9kb2N1bWVudEluRWRpdG9yLF8uZWFjaCh0aGlzLl9yYW5nZXMsZnVuY3Rpb24oZSl7cmV0dXJuIGUuZGlzcG9zZSgpfSksZGVsZXRlIHRoaXMuX3JhbmdlcyxkZWxldGUgdGhpcy5fdGVzdE1hcH19LHJhbmdlQ29uc29sZUxvZzp7dmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX3JhbmdlQ29uc29sZUxvZ1tlLmtleSgpXX19LGNsZWFyUmFuZ2VDb25zb2xlTG9nOnt2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX3JhbmdlQ29uc29sZUxvZz1PYmplY3QuY3JlYXRlKG51bGwpfX0sa2V5Ont2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9kYXRhLmlkfX0scGF0aDp7dmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZGF0YS5wYXRofX0sYWRkVGVzdDp7dmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9T2JqZWN0LmNyZWF0ZShudWxsKSxpPXRoaXMuX3Rlc3RNYXBbZS5rZXkoKV07cmV0dXJuIGkmJl8uZWFjaChpLm9ic29sZXRlKCksZnVuY3Rpb24oZSl7dFtlLmtleSgpXT1lfSksdGhpcy5fdGVzdE1hcFtlLmtleSgpXT1lLGUuc2V0VGVzdEZpbGUodGhpcyksdH19LHJhbmdlQ292ZXJhZ2VDaGFuZ2VkOnt2YWx1ZTpmdW5jdGlvbihlLHQpe3RoaXMuX2FmZmVjdGVkUmFuZ2VzW2Uua2V5KCldPWU7dmFyIGk9ZS5pc0NvdmVyZWQoKTt0IT09aSYmKHRoaXMuX251bWJlck9mQ292ZXJlZFJhbmdlcys9aT8xOi0xKX19LGlzVGVzdEZpbGU6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2RhdGEudGVzdH19LGNvdmVyYWdlOnt2YWx1ZTpmdW5jdGlvbigpe3JldHVybiF0aGlzLmlzVGVzdEZpbGUoKSYmdGhpcy5pbnN0cnVtZW50ZWQoKT9NYXRoLnJvdW5kKDFlNCp0aGlzLl9udW1iZXJPZkNvdmVyZWRSYW5nZXMvXy5zaXplKHRoaXMuX3JhbmdlcykpLzEwMDp2b2lkIDB9fSxudW1iZXJPZkNvdmVyZWRSYW5nZXM6e3ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX251bWJlck9mQ292ZXJlZFJhbmdlc319LG51bWJlck9mQWxsUmFuZ2VzOnt2YWx1ZTpmdW5jdGlvbigpe3JldHVybiBfLnNpemUodGhpcy5fcmFuZ2VzKX19LHNldFJhbmdlczp7dmFsdWU6ZnVuY3Rpb24oZSx0LGkpe3ZhciBuPXRoaXM7dGhpcy5fYWxsUmFuZ2VzUmVjZWl2ZWQ9dCx0JiZ0aGlzLl9yZWJ1aWxkUmFuZ2VNYXAoKTt2YXIgcz1PYmplY3QuY3JlYXRlKG51bGwpO18uZWFjaChlLGZ1bmN0aW9uKGUpe3ZhciByPWUua2V5KCksYT1uLl9yYW5nZXNbcl07aWYoYSl7dmFyIG89YS5pc0NvdmVyZWQoKSxsPWUuaXNDb3ZlcmVkKCk7dHx8bz09PWx8fChuLl9udW1iZXJPZkNvdmVyZWRSYW5nZXMrPWw/MTotMSksYS51cGRhdGVGcm9tKGUsdCxpKSxzW3JdPWEsbi5fYWZmZWN0ZWRSYW5nZXNbcl09YX1lbHNlIG4uX3Jhbmdlc1tyXT1lLG4uX25ld1Jhbmdlc1tyXT1lLGUuYXR0YWNoZWRUb1NvdXJjZUZpbGUoKSxlLmlzQ292ZXJlZCgpJiYhdCYmbi5fbnVtYmVyT2ZDb3ZlcmVkUmFuZ2VzKyt9KSx0JiYobi5fbnVtYmVyT2ZDb3ZlcmVkUmFuZ2VzPTAsdGhpcy5fbGluZVRvUmFuZ2VNYXA9T2JqZWN0LmNyZWF0ZShudWxsKSxfLmVhY2goXy52YWx1ZXModGhpcy5fcmFuZ2VzKSxmdW5jdGlvbihlKXt2YXIgdD1lLmtleSgpO2lmKG4uX25ld1Jhbmdlc1t0XXx8c1t0XSl7ZS5pc0NvdmVyZWQoKSYmbi5fbnVtYmVyT2ZDb3ZlcmVkUmFuZ2VzKys7Zm9yKHZhciBpPWUuc3RhcnRMaW5lKCk7aTw9ZS5lbmRMaW5lKCk7aSsrKXt2YXIgcj1uLl9saW5lVG9SYW5nZU1hcFtpXTsoIXJ8fGUuaXNJbnNpZGVPZihyKSkmJihuLl9saW5lVG9SYW5nZU1hcFtpXT1lKX19ZWxzZSBuLl9vdXRkYXRlZFJhbmdlc1t0XT1lLGRlbGV0ZSBuLl9yYW5nZXNbdF19KSl9fSxvd25UZXN0czp7dmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gXy52YWx1ZXModGhpcy5fdGVzdE1hcCl9fSxyZW1vdmVBbGxUZXN0czp7dmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT1PYmplY3QuY3JlYXRlKG51bGwpO3JldHVybiBfLmVhY2godGhpcy5vd25UZXN0cygpLGZ1bmN0aW9uKHQpe18uZWFjaCh0Lm9ic29sZXRlKCksZnVuY3Rpb24odCl7ZVt0LmtleSgpXT10fSl9KSx0aGlzLl90ZXN0TWFwPU9iamVjdC5jcmVhdGUobnVsbCksZX19LGNsb3Nlc3RSYW5nZTp7dmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2xpbmVUb1JhbmdlTWFwW2VdfX0sX3JlYnVpbGRSYW5nZU1hcDp7dmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9dGhpcy5fcmFuZ2VzO3RoaXMuX3Jhbmdlcz1PYmplY3QuY3JlYXRlKG51bGwpLF8uZWFjaCh0LGZ1bmN0aW9uKHQpe3ZhciBpPXQua2V5KCksbj1lLl9yYW5nZXNbaV07ZS5fcmFuZ2VzW2ldPXQsbiYmbi5kaXNwb3NlKCl9KX19fSksZX0oKTt0LmV4cG9ydHM9b30seyIuL2NvdmVyYWJsZVJhbmdlIjo0LCIuL2RvY3VtZW50SW5FZGl0b3IiOjV9XSwxNDpbZnVuY3Rpb24oZSx0LGkpe3QuZXhwb3J0cz17bGluZVN0YXRlOntub3RDb3ZlcmVkOjEsZnVsbHlDb3ZlcmVkOjIscGFydGlhbGx5Q292ZXJlZDozLGVycm9yU291cmNlOjQsZXJyb3JQYXRoOjV9fX0se31dLDE1OltmdW5jdGlvbihlLHQsaSl7dC5leHBvcnRzPXtub3JtYWxpemVQYXRoOmZ1bmN0aW9uKGUpe3JldHVybiJ3aW4zMiI9PT1wcm9jZXNzLnBsYXRmb3JtJiZlP2UucmVwbGFjZSgvXFwvZywiLyIpOmV9LHBhcnNlS2V5OmZ1bmN0aW9uKGUpe3ZhciB0PXt9LGk9bmV3IEJ1ZmZlcihlLCJiYXNlNjQiKS50b1N0cmluZygpLnNwbGl0KCJcbiIpO3QubGljZW5zZWVOYW1lPWlbMF0sdC5saWNlbnNlVGFncz1pWzFdO3ZhciBuPXQubGljZW5zZVRhZ3Muc3BsaXQoIiwiKTtyZXR1cm4gbi5sZW5ndGg+PTEmJih0LmxpY2Vuc2VlRW1haWw9blswXSksbi5sZW5ndGg+PTImJih0LmxpY2Vuc2VkUHJvZHVjdD1uWzFdKSx0LmV4cGlyYXRpb25EYXRlU3RyaW5nPWlbMl0sdC5saWNlbnNlU2lnbmF0dXJlPWlbM10sdH19fSx7fV0sMTY6W2Z1bmN0aW9uKGUsdCxpKXsidXNlIHN0cmljdCI7dmFyIG49ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsdCl7Zm9yKHZhciBpIGluIHQpe3ZhciBuPXRbaV07bi5jb25maWd1cmFibGU9ITAsbi52YWx1ZSYmKG4ud3JpdGFibGU9ITApfU9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGUsdCl9cmV0dXJuIGZ1bmN0aW9uKHQsaSxuKXtyZXR1cm4gaSYmZSh0LnByb3RvdHlwZSxpKSxuJiZlKHQsbiksdH19KCkscz1mdW5jdGlvbiB2KGUsdCxpKXt2YXIgbj1PYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsdCk7aWYodm9pZCAwPT09bil7dmFyIHM9T2JqZWN0LmdldFByb3RvdHlwZU9mKGUpO3JldHVybiBudWxsPT09cz92b2lkIDA6dihzLHQsaSl9aWYoInZhbHVlImluIG4mJm4ud3JpdGFibGUpcmV0dXJuIG4udmFsdWU7dmFyIHI9bi5nZXQ7aWYodm9pZCAwIT09cilyZXR1cm4gci5jYWxsKGkpfSxyPWZ1bmN0aW9uKGUsdCl7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIHQmJm51bGwhPT10KXRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgIit0eXBlb2YgdCk7ZS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZSh0JiZ0LnByb3RvdHlwZSx7Y29uc3RydWN0b3I6e3ZhbHVlOmUsZW51bWVyYWJsZTohMSx3cml0YWJsZTohMCxjb25maWd1cmFibGU6ITB9fSksdCYmKGUuX19wcm90b19fPXQpfSxhPWZ1bmN0aW9uKGUsdCl7aWYoIShlIGluc3RhbmNlb2YgdCkpdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIil9LG89ZSgibmV0IiksbD1lKCJ1cmwiKSx1PWUoIndzIikuU2VydmVyLGM9ZSgiLi4vc2VydmVyL2RvY3VtZW50SW5FZGl0b3IiKSxoPXZvaWQgMCxkPVs1MTIzNSw1MTIzNiw1MTIzNyw1MTIzOCw1MTIzOSw1MTI0MCw1MTI0MSw1MTI0Miw1MTI0Myw1MTI0NCw1Mjc0Miw1Mjc0Myw1Mjc0NCw1Mjc0NSw1Mjc0Niw1Mjc0Nyw1Mjc0OCw1Mjc0OSw1Mjc1MCw1Mjc1MSw1MzU3OCw1MzU3OSw1MzU4MCw1MzU4MSw1MzU4Miw1MzU4Myw1MzU4NCw1MzU4NSw1MzU4Niw1MzU4N10sZj1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKHQpe2EodGhpcyxpKSxzKE9iamVjdC5nZXRQcm90b3R5cGVPZihpLnByb3RvdHlwZSksImNvbnN0cnVjdG9yIix0aGlzKS5jYWxsKHRoaXMpO3ZhciBuPXRoaXM7dGhpcy5fZmluZEZyZWVQb3J0KCkudGhlbihmdW5jdGlvbihlKXtyZXR1cm4gbi5fc3RhcnQoZSx0KX0pLmZhaWwoZnVuY3Rpb24oZSl7cmV0dXJuIGNvbnNvbGUuZXJyb3IoIkZhaWxlZCB0byBzdGFydCB3YWxsYWJ5IFVJIHNlcnZpY2U6ICIrKGUmJmUubWVzc2FnZSkpfSksaD1lKCJkZWJ1ZyIpKCJ3YWxsYWJ5OnVpU2VydmljZSIpLG4uX2Nvbm5lY3Rpb25zPVtdfXJldHVybiByKGksdCksbihpLHsidWk6c3RhcnQiOnt2YWx1ZTpmdW5jdGlvbihlLHQpe3RoaXMuX3NlbmQoXy5leHRlbmQoe3R5cGU6InVpOnN1bW1hcnkifSx0aGlzLl9tb2RlbC5zdW1tYXJ5KCkpLHQpO3ZhciBpPXRoaXMuX21vZGVsLmFsbEZpbGVzKCk7Xy5pc0VtcHR5KGkpfHx0aGlzLl9zZW5kQWxsRmlsZXMoaSx0KX19LCJ1aTpuYXZpZ2F0ZSI6e3ZhbHVlOmZ1bmN0aW9uKGUpe2UubGluZT1wYXJzZUludChlLmxpbmUsMTApLGUuY29sdW1uPXBhcnNlSW50KGUuY29sdW1uLDEwKSxfLmlzTmFOKGUubGluZSkmJihlLmxpbmU9MSksXy5pc05hTihlLmNvbHVtbikmJmRlbGV0ZSBlLmNvbHVtbix0aGlzLmVtaXQoIm1lc3NhZ2UiLF8uZXh0ZW5kKGUse3R5cGU6Im5hdmlnYXRpb25SZXF1ZXN0ZWQifSkpfX0sInVpOmNvZGVSZXF1ZXN0ZWQiOnt2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBpPXRoaXMsbj10aGlzLl9tb2RlbC5maWxlQ29udGVudEJ5UGF0aChlLnBhdGgpO24mJm4udGhlbihmdW5jdGlvbihuKXt2YXIgcz1uZXcgYyxyPWkuX21vZGVsLmZpbGVCeVBhdGgoZS5wYXRoKSxhPXZvaWQgMCxvPVtdLGw9W107ciYmci5pbnN0cnVtZW50ZWQoKSYmKHMudXBkYXRlKF8udmFsdWVzKHIucmFuZ2VzKCkpLCExLCEwKSxsPXMuYWxsTGluZXMoKS5saW5lc3x8W10sbz1pLl9tb2RlbC51bmNvdmVyZWRSZWdpb25zQnlSZXF1ZXN0KHtmaWxlOmUucGF0aH0pfHxbXSxhPWkuX3JlcG9ydEZpbGVDb3ZlcmFnZShyKSksaS5fc2VuZCh7dHlwZToidWk6Y29kZSIsY29ycmVsYXRpb25JZDplLmNvcnJlbGF0aW9uSWQsY29kZTpuLnRvU3RyaW5nKCksbGluZXM6bCx1bmNvdmVyZWRSZWdpb25zOm8sY292ZXJhZ2U6YX0sdCl9KX19LCJ1aTp0ZXN0czpyZXN1bHRzUmVxdWVzdGVkIjp7dmFsdWU6ZnVuY3Rpb24oZSx0KXt0Ll9hbGxvd2VkVG9TZW5kVGVzdFJlc3VsdHM9ITAsdGhpcy5fc2VuZFRlc3RSZXN1bHRzKHZvaWQgMCx0KX19LCJ1aTp0ZXN0czpyZXN1bHRzQWJhbmRvbmVkIjp7dmFsdWU6ZnVuY3Rpb24oZSx0KXt0Ll9hbGxvd2VkVG9TZW5kVGVzdFJlc3VsdHM9ITF9fSwibW9kZWw6dGVzdEZpbGVEZWxldGVkIjp7dmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztfLmVhY2godGhpcy5fY29ubmVjdGlvbnMsZnVuY3Rpb24oaSl7aS5fYWxsb3dlZFRvU2VuZFRlc3RSZXN1bHRzJiZ0Ll9zZW5kKHt0eXBlOiJ1aTp0ZXN0czpzb21lUmVzdWx0c1VwZGF0ZWQiLGZpbGVzOlt7cGF0aDplLmZpbGUucGF0aCxhY3Rpb246ImRlbGV0ZWQifV19LGkpfSl9fSwibW9kZWw6YWxsRmlsZXMiOnt2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO18uZWFjaCh0aGlzLl9jb25uZWN0aW9ucyxmdW5jdGlvbihpKXtpLl9hbGxvd2VkVG9TZW5kQWxsRmlsZXMmJnQuX3NlbmRBbGxGaWxlcyhfLm1hcChlLmZpbGVzLGZ1bmN0aW9uKGUpe3JldHVybntwYXRoOmUucGF0aCxpZDplLmlkfX0pLGkpfSl9fSwibW9kZWw6ZmlsZUFkZGVkIjp7dmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fc2VuZCh7dHlwZToidWk6ZmlsZXMiLGZpbGVzOlt7YWN0aW9uOiJhZGRlZCIscGF0aDplLmZpbGUucGF0aCxpZDplLmZpbGUuaWR9XX0pfX0sIm1vZGVsOmZpbGVDaGFuZ2VkIjp7dmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fc2VuZCh7dHlwZToidWk6ZmlsZXMiLGZpbGVzOlt7YWN0aW9uOiJjaGFuZ2VkIixwYXRoOmUuZmlsZS5wYXRoLGlkOmUuZmlsZS5pZH1dfSl9fSwibW9kZWw6ZmlsZURlbGV0ZWQiOnt2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9zZW5kKHt0eXBlOiJ1aTpmaWxlcyIsZmlsZXM6W3thY3Rpb246ImRlbGV0ZWQiLHBhdGg6ZS5maWxlLnBhdGgsaWQ6ZS5maWxlLmlkfV19KX19LCJtb2RlbDp0ZXN0c0V4ZWN1dGVkIjp7dmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztpZih0aGlzLl9zZW5kKF8uZXh0ZW5kKHt0eXBlOiJ1aTpzdW1tYXJ5In0sdGhpcy5fbW9kZWwuc3VtbWFyeSgpKSksXy5lYWNoKHRoaXMuX2Nvbm5lY3Rpb25zLGZ1bmN0aW9uKGkpe2kuX2FsbG93ZWRUb1NlbmRUZXN0UmVzdWx0cyYmdC5fc2VuZFRlc3RSZXN1bHRzKGUsaSl9KSwhXy5pc0VtcHR5KGUuYWxsQWZmZWN0ZWRGaWxlcykpe3ZhciBpPV8ucmVkdWNlKGUuYWxsQWZmZWN0ZWRGaWxlcyxmdW5jdGlvbihlLGkpe3ZhciBuPXQuX3JlcG9ydEZpbGVDb3ZlcmFnZShpKTsKcmV0dXJuIG4mJm4udmFsdWVDaGFuZ2VkJiYoZGVsZXRlIG4udmFsdWVDaGFuZ2VkLGVbaS5rZXkoKV09biksZX0se30pO18uaXNFbXB0eShpKXx8dGhpcy5fc2VuZCh7dHlwZToidWk6Y292ZXJhZ2VDaGFuZ2VkIixjaGFuZ2VzOml9KX19fSxfcmVwb3J0RmlsZUNvdmVyYWdlOnt2YWx1ZTpmdW5jdGlvbihlKXtpZihlKXt2YXIgdD12b2lkIDAsaT1lLmNvdmVyYWdlKCk7cmV0dXJuIGk+PTAmJih0PXt2YWx1ZTppLGxvdzppPHRoaXMuX21vZGVsLmxvd0NvdmVyYWdlVGhyZXNob2xkKCkscmFuZ2VzOntjb3ZlcmVkOmUubnVtYmVyT2ZDb3ZlcmVkUmFuZ2VzKCksYWxsOmUubnVtYmVyT2ZBbGxSYW5nZXMoKX0sdmFsdWVDaGFuZ2VkOmUuX2xhdGVzdFJlcG9ydGVkQ292ZXJhZ2VWYWx1ZSE9PWl8fHZvaWQgMH0sZS5fbGF0ZXN0UmVwb3J0ZWRDb3ZlcmFnZVZhbHVlPWkpLHR9fX0sX3NlbmRBbGxGaWxlczp7dmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgaT10aGlzO3QuX2FsbG93ZWRUb1NlbmRBbGxGaWxlcz0hMSx0aGlzLl9zZW5kKHt0eXBlOiJ1aTpmaWxlcyIsZmlsZXM6ZS5tYXAoZnVuY3Rpb24oZSl7dmFyIHQ9aS5fbW9kZWwuZmlsZUJ5SWQoZS5pZCk7cmV0dXJue2FjdGlvbjoiYWRkZWQiLHBhdGg6ZS5wYXRoLGlkOmUuaWQsY292ZXJhZ2U6aS5fcmVwb3J0RmlsZUNvdmVyYWdlKHQpfX0pfSx0KX19LF9zZW5kVGVzdFJlc3VsdHM6e3ZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIGk9dm9pZCAwLG49dm9pZCAwLHM9InNvbWVSZXN1bHRzVXBkYXRlZCI7ZT8oZS5mdWxsUnVuJiYocz0iYWxsUmVzdWx0c1VwZGF0ZWQiKSxpPWUuY2hhbmdlZCxuPWUuZXhlY3V0ZWQpOihzPSJhbGxSZXN1bHRzVXBkYXRlZCIsaT10aGlzLl9tb2RlbC5hbGxUZXN0RmlsZXMoKSksdGhpcy5fc2VuZCh7dHlwZToidWk6dGVzdHM6IitzLGZpbGVzOnRoaXMuX2NyZWF0ZVRlc3RSZXN1bHRzKGksImNoYW5nZWQiKS5jb25jYXQodGhpcy5fY3JlYXRlVGVzdFJlc3VsdHMobiwiZXhlY3V0ZWQiKSl9LHQpfX0sX2NyZWF0ZVRlc3RSZXN1bHRzOnt2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBpPXRoaXM7cmV0dXJuIF8ubWFwKGUsZnVuY3Rpb24oZSl7dmFyIG49e307cmV0dXJuIF8uZWFjaChlLm93blRlc3RzKCksZnVuY3Rpb24oZSl7dmFyIHQ9ZS5wYXRoKCkscz1fLmxhc3QodCkscj1uO3QubGVuZ3RoPjEmJl8uZWFjaChfLnRha2UodCx0Lmxlbmd0aC0xKSxmdW5jdGlvbihlKXt2YXIgdD1yW2VdO3R8fCh0PXt9LHJbZV09dCkscj10fSk7dmFyIGE9Xy5tYXAoZS5jb3ZlcmVkRmlsZXMoKSxmdW5jdGlvbihlKXtyZXR1cm4gZS5rZXkoKX0pO18uaXNFbXB0eShhKSYmKGE9dm9pZCAwKSxyW3NdPXtpc1Rlc3Q6ITAsbmFtZTpzLHRpbWU6ZS50aW1lKCksc2xvdzplLnNsb3coKSxsaW5lOmUuc3RhcnRSYW5nZSgpP2Uuc3RhcnRSYW5nZSgpLnN0YXJ0TGluZSgpOjEsbG9nczpfLm1hcChlLmNvbnNvbGVNZXNzYWdlcygpLGZ1bmN0aW9uKGUpe3ZhciB0PXttZXNzYWdlOmUudGV4dCgpfTtyZXR1cm4gZS5maWxlKCkmJih0LmxvY2F0aW9uPWkuX2J1aWxkTG9jYXRpb24oZSxlLmZpbGUoKS5wYXRoKCkpKSx0fSksZXJyb3JzOl8ubWFwKGUuZXJyb3JzKCksZnVuY3Rpb24oZSl7cmV0dXJue21lc3NhZ2U6ZS5tZXNzYWdlKCksc3RhY2s6Xy5tYXAoZS5zdGFjaygpLGZ1bmN0aW9uKGUpe3JldHVybiBpLl9idWlsZExvY2F0aW9uKGUsZS5maWxlUGF0aCgpKX0pLGFjdHVhbDplLmFjdHVhbCgpLGV4cGVjdGVkOmUuZXhwZWN0ZWQoKX19KSxjb3ZlcmVkRmlsZXM6YX19KSx7cGF0aDplLnBhdGgoKSxhY3Rpb246dCx0ZXN0czppLl9idWlsZEFycmF5VGVzdFN0cnVjdHVyZShuKX19KX19LF9idWlsZExvY2F0aW9uOnt2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBpPXtwYXRoOnR9O3JldHVybiBlLnJhbmdlKCk/KGkubGluZT1lLnJhbmdlKCkuc3RhcnRMaW5lKCksaS5jb2x1bW49ZS5yYW5nZSgpLnN0YXJ0Q29sdW1uKCkpOmUubGluZSgpJiYoaS5saW5lPWUubGluZSgpKSxpfX0sX2J1aWxkQXJyYXlUZXN0U3RydWN0dXJlOnt2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO3JldHVybiBfLm1hcChlLGZ1bmN0aW9uKGUsaSl7cmV0dXJuIGUuaXNUZXN0PT09ITA/KGRlbGV0ZSBlLmlzVGVzdCxlKTp7bmFtZTppLHRlc3RzOnQuX2J1aWxkQXJyYXlUZXN0U3RydWN0dXJlKGUpfX0pfX0sX3N0YXJ0Ont2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBpPXRoaXMsbj1mdW5jdGlvbihlKXtyZXR1cm4gcHJvY2Vzcy5uZXh0VGljayhmdW5jdGlvbigpe3ZhciB0PWlbIm1vZGVsOiIrZS50eXBlXTt0JiZ0LmNhbGwoaSxlKX0pfTtpLl93c3M9bmV3IHUoe3BvcnQ6ZSx2ZXJpZnlDbGllbnQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ITE7dHJ5e3ZhciBpPWwucGFyc2UoZS5vcmlnaW4pO3Q9IndhbGxhYnlqcy5jb20iPT09aS5ob3N0bmFtZX1jYXRjaChuKXt9cmV0dXJuIHR9fSksaS5fd3NzLm9uKCJjb25uZWN0aW9uIixmdW5jdGlvbihlKXtoKCJVSSBjbGllbnQgY29ubmVjdGVkIiksaS5fbW9kZWw9dCxlLl9hbGxvd2VkVG9TZW5kVGVzdFJlc3VsdHM9ITEsZS5fYWxsb3dlZFRvU2VuZEFsbEZpbGVzPSEwLCFpLl9jb25uZWN0aW9ucy5sZW5ndGgmJmkuX21vZGVsLm9uKCJtZXNzYWdlIixuKSxpLl9jb25uZWN0aW9ucy5wdXNoKGUpLGUub24oIm1lc3NhZ2UiLGZ1bmN0aW9uKHQpe3ZhciBuPXZvaWQgMDt0cnl7bj1KU09OLnBhcnNlKHQpfWNhdGNoKHMpe3JldHVybiB2b2lkIGNvbnNvbGUuZXJyb3IoIkZhaWxlZCB0byBkZXNlcmlhbGl6ZSBtZXNzYWdlIGZyb20gd2FsbGFieSBVSTogIit0KyIsICIrKHMmJnMubWVzc2FnZSkpfWgoIkluY29taW5nIG1lc3NhZ2UgJXMiLG4udHlwZSk7dmFyIHI9aVtuLnR5cGVdO3ImJnIuY2FsbChpLG4sZSl9KSxlLm9uKCJjbG9zZSIsZnVuY3Rpb24oKXtoKCJVSSBjbGllbnQgZGlzY29ubmVjdGVkIiksaS5fY29ubmVjdGlvbnM9aS5fY29ubmVjdGlvbnMuZmlsdGVyKGZ1bmN0aW9uKHQpe3JldHVybiB0IT1lfSksIWkuX2Nvbm5lY3Rpb25zLmxlbmd0aCYmaS5fbW9kZWwucmVtb3ZlTGlzdGVuZXIoIm1lc3NhZ2UiLG4pfSksaS5fc2VuZCh7dHlwZToidWk6aGFuZHNoYWtlIixwcm9qZWN0OntuYW1lOmkuX21vZGVsLnByb2plY3ROYW1lKCkscGF0aDppLl9tb2RlbC5jb25maWdGaWxlUGF0aCgpLGNvbmZpZzppLl9tb2RlbC5wcm9qZWN0Q29uZmlnKCl9LHZlcnNpb246aS5fbW9kZWwuY29yZVZlcnNpb24oKX0sZSl9KSxoKCJMaXN0ZW5pbmcgcG9ydCAlcyIsZSl9fSxfc2VuZDp7dmFsdWU6ZnVuY3Rpb24oZSx0KXt0JiYoInVpOnRlc3RzOmFsbFJlc3VsdHNVcGRhdGVkIj09PWUudHlwZT8odC5fc29tZVJlc3VsdHNSZXNwb25zZVNlcU51bT0wLGUuc2VxPXQuX3NvbWVSZXN1bHRzUmVzcG9uc2VTZXFOdW0rKyk6InVpOnRlc3RzOnNvbWVSZXN1bHRzVXBkYXRlZCI9PT1lLnR5cGUmJihlLnNlcT10Ll9zb21lUmVzdWx0c1Jlc3BvbnNlU2VxTnVtKyspKSxoKCJPdXRnb2luZyBtZXNzYWdlICVzIixlLnR5cGUpO3ZhciBpPUpTT04uc3RyaW5naWZ5KGUpO3Q/dC5zZW5kKGkpOl8uZWFjaCh0aGlzLl9jb25uZWN0aW9ucyxmdW5jdGlvbihlKXtyZXR1cm4gZS5zZW5kKGkpfSl9fSxfZmluZEZyZWVQb3J0Ont2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXM7cmV0dXJuIFEuYWxsKF8ubWFwKGQsZnVuY3Rpb24odCl7cmV0dXJuIGUuX2NoZWNrUG9ydCh0KX0pKS50aGVuKGZ1bmN0aW9uKGUpe3JldHVybiBfLmZpbmQoZSxmdW5jdGlvbihlKXtyZXR1cm4hIWV9KX0pLnRoZW4oZnVuY3Rpb24oZSl7cmV0dXJuIGV8fFEucmVqZWN0KCl9KX19LF9jaGVja1BvcnQ6e3ZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbihpKXt2YXIgbj1vLmNyZWF0ZVNlcnZlcigpLm9uY2UoImVycm9yIixmdW5jdGlvbigpe3JldHVybiBpKDApfSkub25jZSgibGlzdGVuaW5nIixmdW5jdGlvbigpe3JldHVybiBuLm9uY2UoImNsb3NlIixmdW5jdGlvbigpe3JldHVybiBpKGUpfSkuY2xvc2UoKX0pLmxpc3RlbihlLHQpfX07cmV0dXJuIFEucHJvbWlzZSh0KCIwLjAuMC4wIikpLnRoZW4oUS5wcm9taXNlKHQoIjEyNy4wLjAuMSIpKSkudGhlbihRLnByb21pc2UodCgiOjoxIikpKX19LHN0b3A6e3ZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcztlLl93c3MmJmUuX3dzcy5jbG9zZSgpfX19KSxpfShFdmVudEVtaXR0ZXIpO3QuZXhwb3J0cz1mfSx7Ii4uL3NlcnZlci9kb2N1bWVudEluRWRpdG9yIjo1LGRlYnVnOnZvaWQgMCxuZXQ6dm9pZCAwLHVybDp2b2lkIDAsd3M6dm9pZCAwfV0sMTc6W2Z1bmN0aW9uKGUsdCxpKXt0LmV4cG9ydHM9e3JhbmRvbUlkOmZ1bmN0aW9uKCl7cmV0dXJuIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLDUpfSxub29wVHJ1ZTpmdW5jdGlvbigpe3JldHVybiEwfSxub29wVHJ1ZVByb21pc2U6ZnVuY3Rpb24oKXtyZXR1cm4gUS5mY2FsbCh0aGlzLm5vb3BUcnVlKX0saXNQYXRjaDpmdW5jdGlvbihlKXtyZXR1cm4gZSYmZS5sZW5ndGg+MiYmIkAiPT09ZVswXSYmIkAiPT09ZVsxXX0sdGV4dEluZGV4UG9zaXRpb246ZnVuY3Rpb24oZSx0KXt2YXIgaT10aGlzLnRleHRMaW5lcyhlLHQpO3JldHVybntsaW5lOmkubGVuZ3RoLGNvbHVtbjppW2kubGVuZ3RoLTFdLmxlbmd0aH19LHRleHRMaW5lczpmdW5jdGlvbihlLHQpe3JldHVybiBlPV8uaXNVbmRlZmluZWQodCk/ZTplLnN1YnN0cigwLHQpLGUuc3BsaXQoL1xyXG58XHJ8XG4vKX0sdmVyaWZ5TG9jYWxPcmlnaW46ZnVuY3Rpb24odCxpKXtpZighdClyZXR1cm4hMDt2YXIgbj0hMTt0cnl7dmFyIHM9ZSgidXJsIikucGFyc2UodCkuaG9zdG5hbWU7bj0ibG9jYWxob3N0Ij09PXN8fCIwLjAuMC4wIj09PXN8fCIxMjcuMC4wLjEiPT09c3x8Ijo6MSI9PT1zfWNhdGNoKHIpe31yZXR1cm4gbnx8aXx8Y29uc29sZS5lcnJvcigid2FsbGFieS5qcyByZWZ1c2VkIHRvIGFjY2VwdCBjb25uZWN0aW9uIGZyb20gIit0KSxufX19LHt1cmw6dm9pZCAwfV19LHt9LFsxXSk7